\documentclass{article}\usepackage[]{graphicx}\usepackage[]{color}
%% maxwidth is the original width if it is less than linewidth
%% otherwise use linewidth (to make sure the graphics do not exceed the margin)
\makeatletter
\def\maxwidth{ %
  \ifdim\Gin@nat@width>\linewidth
    \linewidth
  \else
    \Gin@nat@width
  \fi
}
\makeatother

\definecolor{fgcolor}{rgb}{0.345, 0.345, 0.345}
\newcommand{\hlnum}[1]{\textcolor[rgb]{0.686,0.059,0.569}{#1}}%
\newcommand{\hlstr}[1]{\textcolor[rgb]{0.192,0.494,0.8}{#1}}%
\newcommand{\hlcom}[1]{\textcolor[rgb]{0.678,0.584,0.686}{\textit{#1}}}%
\newcommand{\hlopt}[1]{\textcolor[rgb]{0,0,0}{#1}}%
\newcommand{\hlstd}[1]{\textcolor[rgb]{0.345,0.345,0.345}{#1}}%
\newcommand{\hlkwa}[1]{\textcolor[rgb]{0.161,0.373,0.58}{\textbf{#1}}}%
\newcommand{\hlkwb}[1]{\textcolor[rgb]{0.69,0.353,0.396}{#1}}%
\newcommand{\hlkwc}[1]{\textcolor[rgb]{0.333,0.667,0.333}{#1}}%
\newcommand{\hlkwd}[1]{\textcolor[rgb]{0.737,0.353,0.396}{\textbf{#1}}}%

\usepackage{framed}
\makeatletter
\newenvironment{kframe}{%
 \def\at@end@of@kframe{}%
 \ifinner\ifhmode%
  \def\at@end@of@kframe{\end{minipage}}%
  \begin{minipage}{\columnwidth}%
 \fi\fi%
 \def\FrameCommand##1{\hskip\@totalleftmargin \hskip-\fboxsep
 \colorbox{shadecolor}{##1}\hskip-\fboxsep
     % There is no \\@totalrightmargin, so:
     \hskip-\linewidth \hskip-\@totalleftmargin \hskip\columnwidth}%
 \MakeFramed {\advance\hsize-\width
   \@totalleftmargin\z@ \linewidth\hsize
   \@setminipage}}%
 {\par\unskip\endMakeFramed%
 \at@end@of@kframe}
\makeatother

\definecolor{shadecolor}{rgb}{.97, .97, .97}
\definecolor{messagecolor}{rgb}{0, 0, 0}
\definecolor{warningcolor}{rgb}{1, 0, 1}
\definecolor{errorcolor}{rgb}{1, 0, 0}
\newenvironment{knitrout}{}{} % an empty environment to be redefined in TeX

\usepackage{alltt}
\usepackage{geometry}
\usepackage{amsmath}
\usepackage{lscape}
\geometry{verbose,tmargin=2.5cm,bmargin=2.5cm,lmargin=2.5cm,rmargin=2.5cm}
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}




\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{library}\hlstd{(flexsurv)}
\hlkwd{library}\hlstd{(boot)}
\hlkwd{library}\hlstd{(randomForestSRC)}
\hlkwd{library}\hlstd{(timeROC)}
\hlkwd{library}\hlstd{(risksetROC)}
\hlkwd{source}\hlstd{(}\hlstr{"stdca.R"}\hlstd{)}
\end{alltt}
\end{kframe}
\end{knitrout}


\section{Preparation}
Construct a *preoperative* function based on the Brennan nomogram.  The preoperative nature will mean that most prognostic components will need to be marginalized out.

\begin{table}[h]
\begin{tabular}{llll}
Variable            & Preoperative? & Available? & Marginals                                                                                     \\
Age                 & Yes           & Yes        & Linear.  90 =\textgreater 0, 30 =\textgreater 8.  Therefore $f(x) = -2/15(x-90) = -2/15x + 12$ \\
Sex                 & Yes           & Yes        & Male risk delta 3                                                                             \\
Portal Vein         & NO            &            & 14.4\% YES, risk delta 10, marginal 1.4                                                       \\
Splenectomy         & NO            &            & 9.9\% YES, risk delta 62, marginal 6.1                                                        \\
Margin of resection & NO            &            & 20.7\% POS, risk delta 4, marginal 0.8                                                        \\
Head.vs.Other       & Yes           & Yes        & Head risk delta 51                                                                            \\
Differentiation     & NO            &            & 14.2\% Well, risk delta 0, marginal 0                                                         \\
                    &               &            & 56.4\% Mod, risk delta 14, marginal 7.9                                                       \\
                    &               &            & 29.5\% Poor, risk delta 35, marginal 10.3.  Overall marginal 18.2                             \\
Posterior.margin    & NO            &            & 86.0\% POS, risk delta 22, marginal 18.9                                                      \\
Numb.pos.nodes      & NO            &            & Mean 2.1, approx marginal 15                                                                  \\
Numb.neg.nodes      & NO            &            & Mean 16.9, approx marginal 9                                                                  \\
Back.pain           & Yes           & NO         & 13.7\% YES, risk delta 15, marginal 2.0                                                       \\
T.stage             & Yes           & Yes        &                                                                                               \\
Weight Loss         & Yes           & NO         & 53.7\% YES, risk delta 3,  marginal 1.6                                                       \\
Max.path.axis       & Yes           & Yes        &                                                                                              
\end{tabular}
\end{table}

So the preoperative MSKCC score would be:
\begin{align}
S &= 1.4 + 6.1 + 0.8 + 18.2 + 18.9 + 15 + 9 + 15*Back.pain + 3*Weight.Loss + -2/15*Age + 12 + 3\left[Sex = M\right] + 51\left[Head.vs.Other = Head\right] + T.stage + Max.path.axis
  &= 81.4 + 15*Back.pain + 3*Weight.Loss + -2/15*Age + 3*\left[Sex = M\right] + 51\left[Head.vs.Other = Head\right] + fT(T.stage) + fS(Max.path.axis)
fT(T.stage) = 36\left[T.stage = T1\right] + 10\left[T.stage = T3\right] + 63\left[T.stage = T4\right]
\end{align}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{fit.mskcc} \hlkwb{=} \hlkwd{list}\hlstd{(}
        \hlkwc{inputs} \hlstd{=} \hlkwd{list}\hlstd{(}
        \hlkwc{History.Diagnosis.AgeAt} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlnum{65}\hlstd{,} \hlkwc{fraction} \hlstd{=} \hlnum{1}\hlstd{),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{ x} \hlkwb{=} \hlstd{x;} \hlopt{-}\hlnum{2}\hlopt{/}\hlnum{15}\hlopt{*}\hlkwd{pmin}\hlstd{(}\hlkwd{pmax}\hlstd{(x,} \hlnum{0}\hlstd{),} \hlnum{90}\hlstd{)} \hlopt{+} \hlnum{12} \hlstd{\}),}
        \hlkwc{Patient.Sex} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlkwd{c}\hlstd{(}\hlstr{"M"}\hlstd{,} \hlstr{"F"}\hlstd{),} \hlkwc{fraction} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.501}\hlstd{,} \hlnum{1}\hlopt{-}\hlnum{0.501}\hlstd{)),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{} \hlnum{3}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlstr{"M"}\hlstd{) \}),}
        \hlkwc{Portal.Vein} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{TRUE}\hlstd{,} \hlnum{FALSE}\hlstd{),} \hlkwc{fraction} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.144}\hlstd{,} \hlnum{1}\hlopt{-}\hlnum{0.144}\hlstd{)),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{} \hlnum{10}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlnum{TRUE}\hlstd{) \}),}
        \hlkwc{Splenectomy} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{TRUE}\hlstd{,} \hlnum{FALSE}\hlstd{),} \hlkwc{fraction} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.099}\hlstd{,} \hlnum{1}\hlopt{-}\hlnum{0.099}\hlstd{)),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{} \hlnum{62}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlnum{TRUE}\hlstd{) \}),}
        \hlkwc{Treat.MarginPositive} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{TRUE}\hlstd{,} \hlnum{FALSE}\hlstd{),} \hlkwc{fraction} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.207}\hlstd{,} \hlnum{1}\hlopt{-}\hlnum{0.207}\hlstd{)),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{} \hlnum{4}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlnum{TRUE}\hlstd{) \}),}
        \hlkwc{Path.LocationBody} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{FALSE}\hlstd{,} \hlnum{TRUE}\hlstd{),} \hlkwc{fraction} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.894}\hlstd{,} \hlnum{1}\hlopt{-}\hlnum{0.894}\hlstd{)),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{} \hlnum{51}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlnum{TRUE}\hlstd{) \}),}
        \hlkwc{Path.Differentiation} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlkwd{c}\hlstd{(}\hlstr{"1"}\hlstd{,} \hlstr{"2"}\hlstd{,} \hlstr{"3"}\hlstd{,} \hlstr{"4"}\hlstd{),} \hlkwc{fraction} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.142}\hlstd{,} \hlnum{0.564}\hlstd{,} \hlnum{1}\hlopt{-}\hlnum{0.142}\hlopt{-}\hlnum{0.564}\hlstd{,} \hlnum{0}\hlstd{)),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{} \hlnum{14}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlstr{"2"}\hlstd{)} \hlopt{+} \hlnum{35}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlstr{"3"}\hlstd{)} \hlopt{+} \hlnum{35}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlstr{"4"}\hlstd{) \}),}          \hlcom{# Undifferentiated (4) not covered by the MSKCC nomogram; here assign the same score as poorly differentiated (3)}
        \hlkwc{Posterior.Margin} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{TRUE}\hlstd{,} \hlnum{FALSE}\hlstd{),} \hlkwc{fraction} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.86}\hlstd{,} \hlnum{1}\hlopt{-}\hlnum{0.86}\hlstd{)),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{} \hlnum{22}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlnum{TRUE}\hlstd{) \}),}
        \hlkwc{Path.LN.Involved} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlnum{2.1}\hlstd{,} \hlkwc{fraction} \hlstd{=} \hlnum{1}\hlstd{),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{}
                        \hlstd{x} \hlkwb{=} \hlkwd{pmin}\hlstd{(}\hlnum{40}\hlstd{,} \hlkwd{pmax}\hlstd{(x,} \hlnum{0}\hlstd{))}
                        \hlstd{fitfun} \hlkwb{=} \hlkwd{splinefun}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{1}\hlstd{,} \hlnum{2}\hlstd{,} \hlnum{3}\hlstd{,} \hlnum{4}\hlstd{,} \hlnum{10}\hlstd{,} \hlnum{15}\hlstd{,} \hlnum{20}\hlstd{,} \hlnum{25}\hlstd{,} \hlnum{30}\hlstd{,} \hlnum{35}\hlstd{,} \hlnum{40}\hlstd{),} \hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{14.56}\hlstd{,} \hlnum{24.64}\hlstd{,} \hlnum{30.28}\hlstd{,} \hlnum{33.00}\hlstd{,} \hlnum{39.05}\hlstd{,} \hlnum{43.89}\hlstd{,} \hlnum{48.83}\hlstd{,} \hlnum{53.77}\hlstd{,} \hlnum{58.61}\hlstd{,} \hlnum{63.55}\hlstd{,} \hlnum{68.49}\hlstd{),} \hlkwc{method} \hlstd{=} \hlstr{"natural"}\hlstd{)}
                        \hlkwd{fitfun}\hlstd{(x)}
                \hlstd{\}),}
        \hlkwc{Path.LN.Negative} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlnum{16.9}\hlstd{,} \hlkwc{fraction} \hlstd{=} \hlnum{1}\hlstd{),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{ (}\hlkwd{pmin}\hlstd{(}\hlkwd{pmax}\hlstd{(x,} \hlnum{0}\hlstd{),} \hlnum{90}\hlstd{)}\hlopt{-}\hlnum{90}\hlstd{)}\hlopt{*-}\hlnum{11}\hlopt{/}\hlnum{90} \hlstd{\}),}
        \hlkwc{Back.pain} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{TRUE}\hlstd{,} \hlnum{FALSE}\hlstd{),} \hlkwc{fraction} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.137}\hlstd{,} \hlnum{1}\hlopt{-}\hlnum{0.137}\hlstd{)),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{} \hlnum{15}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlnum{TRUE}\hlstd{) \}),}
        \hlkwc{Stage.pT.Simplified} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlkwd{c}\hlstd{(}\hlstr{"T1"}\hlstd{,} \hlstr{"T2"}\hlstd{,} \hlstr{"T34"}\hlstd{),} \hlkwc{fraction} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.037}\hlstd{,} \hlnum{0.119}\hlstd{,} \hlnum{1}\hlopt{-}\hlnum{0.037}\hlopt{-}\hlnum{0.119}\hlstd{)),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{} \hlnum{36}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlstr{"T1"}\hlstd{)} \hlopt{+} \hlnum{11}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlstr{"T34"}\hlstd{) \}),}
                \hlcom{# The following matches the original Brennan nomogram, but was not used as there are too few T4}
                \hlcom{# tumours in either the NSWPCN *or* the MSKCC cohorts -- how the T4 coefficient was ever estimated,}
                \hlcom{# I'll never know.  The T34 coefficient of 11 was arrived at as (0.828*10+(1-0.037-0.119-0.828)*63)/(1-0.037-0.119),}
                \hlcom{# being a frequency-weighted average of the T3 and T4 coefficients.}
                \hlcom{# margins = data.frame(value = c("T1", "T2", "T3", "T4"), fraction = c(0.037, 0.119, 0.828, 1-0.037-0.119-0.828)),}
                \hlcom{# scorefunc = function(x) \{ 36*I(x == "T1") + 10*I(x == "T3") + 63*I(x == "T4") \}),}
        \hlkwc{Weight.loss} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{value} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{TRUE}\hlstd{,} \hlnum{FALSE}\hlstd{),} \hlkwc{fraction} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.537}\hlstd{,} \hlnum{1}\hlopt{-}\hlnum{0.537}\hlstd{)),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{} \hlnum{3}\hlopt{*}\hlkwd{I}\hlstd{(x} \hlopt{==} \hlnum{TRUE}\hlstd{) \}),}
        \hlkwc{Path.Size} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{margins} \hlstd{=} \hlkwd{data.frame}\hlstd{(),}
                \hlkwc{scorefunc} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) \{}
                        \hlstd{x} \hlkwb{=} \hlkwd{pmin}\hlstd{(}\hlnum{16}\hlstd{,} \hlkwd{pmax}\hlstd{(x,} \hlnum{0}\hlstd{))}
                        \hlstd{fitfun} \hlkwb{=} \hlkwd{splinefun}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{1}\hlstd{,} \hlnum{2}\hlstd{,} \hlnum{3}\hlstd{,} \hlnum{4}\hlstd{,} \hlnum{6}\hlstd{,} \hlnum{8}\hlstd{,} \hlnum{10}\hlstd{,} \hlnum{12}\hlstd{,} \hlnum{14}\hlstd{,} \hlnum{16}\hlstd{),} \hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{29.74}\hlstd{,} \hlnum{59.48}\hlstd{,} \hlnum{86.70}\hlstd{,} \hlnum{100}\hlstd{,} \hlnum{97.29}\hlstd{,} \hlnum{90.03}\hlstd{,} \hlnum{82.77}\hlstd{,} \hlnum{75.51}\hlstd{,} \hlnum{68.25}\hlstd{,} \hlnum{61.10}\hlstd{),} \hlkwc{method} \hlstd{=} \hlstr{"natural"}\hlstd{)}
                        \hlkwd{fitfun}\hlstd{(x)}
                \hlstd{\}) ),}
        \hlkwc{outputs} \hlstd{=} \hlkwd{list}\hlstd{(}
                \hlkwc{DSS12mo} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{s}\hlstd{) \{}
                        \hlstd{x} \hlkwb{=} \hlkwd{pmax}\hlstd{(}\hlnum{50}\hlstd{,} \hlkwd{pmin}\hlstd{(}\hlnum{350}\hlstd{, s))}
                        \hlstd{fitfun} \hlkwb{=} \hlkwd{splinefun}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{79.0323}\hlstd{,} \hlnum{115.02}\hlstd{,} \hlnum{165.524}\hlstd{,} \hlnum{197.278}\hlstd{,} \hlnum{221.774}\hlstd{,} \hlnum{242.339}\hlstd{,} \hlnum{261.089}\hlstd{,} \hlnum{279.839}\hlstd{,} \hlnum{299.194}\hlstd{,} \hlnum{323.992}\hlstd{,} \hlnum{337.298}\hlstd{),} \hlkwd{c}\hlstd{(}\hlnum{0.94}\hlstd{,} \hlnum{0.9}\hlstd{,} \hlnum{0.8}\hlstd{,} \hlnum{0.7}\hlstd{,} \hlnum{0.6}\hlstd{,} \hlnum{0.5}\hlstd{,} \hlnum{0.4}\hlstd{,} \hlnum{0.3}\hlstd{,} \hlnum{0.2}\hlstd{,} \hlnum{0.1}\hlstd{,} \hlnum{0.06}\hlstd{))}
                        \hlstd{y} \hlkwb{=} \hlkwd{fitfun}\hlstd{(x)}
                        \hlkwd{pmax}\hlstd{(}\hlnum{0}\hlstd{,} \hlkwd{pmin}\hlstd{(}\hlnum{1}\hlstd{, y))}
                \hlstd{\},}
                \hlkwc{DSS24mo} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{s}\hlstd{) \{}
                        \hlstd{x} \hlkwb{=} \hlkwd{pmax}\hlstd{(}\hlnum{50}\hlstd{,} \hlkwd{pmin}\hlstd{(}\hlnum{350}\hlstd{, s))}
                        \hlstd{fitfun} \hlkwb{=} \hlkwd{splinefun}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{71.1694}\hlstd{,} \hlnum{97.7823}\hlstd{,} \hlnum{129.536}\hlstd{,} \hlnum{153.73}\hlstd{,} \hlnum{174.294}\hlstd{,} \hlnum{193.347}\hlstd{,} \hlnum{211.794}\hlstd{,} \hlnum{231.452}\hlstd{,} \hlnum{255.645}\hlstd{,} \hlnum{303.125}\hlstd{),} \hlkwd{c}\hlstd{(}\hlnum{0.86}\hlstd{,} \hlnum{0.8}\hlstd{,} \hlnum{0.7}\hlstd{,} \hlnum{0.6}\hlstd{,} \hlnum{0.5}\hlstd{,} \hlnum{0.4}\hlstd{,} \hlnum{0.3}\hlstd{,} \hlnum{0.2}\hlstd{,} \hlnum{0.1}\hlstd{,} \hlnum{0.01}\hlstd{))}
                        \hlstd{y} \hlkwb{=} \hlkwd{fitfun}\hlstd{(x)}
                        \hlkwd{pmax}\hlstd{(}\hlnum{0}\hlstd{,} \hlkwd{pmin}\hlstd{(}\hlnum{1}\hlstd{, y))}
                \hlstd{\},}
                \hlkwc{DSS36mo} \hlstd{=} \hlkwa{function}\hlstd{(}\hlkwc{s}\hlstd{) \{}
                        \hlstd{x} \hlkwb{=} \hlkwd{pmax}\hlstd{(}\hlnum{50}\hlstd{,} \hlkwd{pmin}\hlstd{(}\hlnum{350}\hlstd{, s))}
                        \hlstd{fitfun} \hlkwb{=} \hlkwd{splinefun}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{69.3548}\hlstd{,} \hlnum{101.109}\hlstd{,} \hlnum{125.302}\hlstd{,} \hlnum{145.867}\hlstd{,} \hlnum{164.919}\hlstd{,} \hlnum{183.367}\hlstd{,} \hlnum{202.722}\hlstd{,} \hlnum{226.915}\hlstd{,} \hlnum{274.093}\hlstd{),} \hlkwd{c}\hlstd{(}\hlnum{0.8}\hlstd{,} \hlnum{0.7}\hlstd{,} \hlnum{0.6}\hlstd{,} \hlnum{0.5}\hlstd{,} \hlnum{0.4}\hlstd{,} \hlnum{0.3}\hlstd{,} \hlnum{0.2}\hlstd{,} \hlnum{0.1}\hlstd{,} \hlnum{0.01}\hlstd{))}
                        \hlstd{y} \hlkwb{=} \hlkwd{fitfun}\hlstd{(x)}
                        \hlkwd{pmax}\hlstd{(}\hlnum{0}\hlstd{,} \hlkwd{pmin}\hlstd{(}\hlnum{1}\hlstd{, y))}
                \hlstd{\})}
        \hlstd{)}

\hlstd{applyNomogram} \hlkwb{=} \hlkwa{function}\hlstd{(}\hlkwc{nomogram}\hlstd{,} \hlkwc{data}\hlstd{)}
\hlstd{\{}
        \hlstd{scores} \hlkwb{=} \hlkwd{rowSums}\hlstd{(}\hlkwd{sapply}\hlstd{(}\hlkwd{names}\hlstd{(nomogram}\hlopt{$}\hlstd{inputs),} \hlkwa{function}\hlstd{(}\hlkwc{input}\hlstd{) \{}
                \hlkwa{if} \hlstd{(input} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data)) \{}
                        \hlkwd{return}\hlstd{(nomogram}\hlopt{$}\hlstd{inputs[[input]]}\hlopt{$}\hlkwd{scorefunc}\hlstd{(data[,input]))}
                \hlstd{\}}
                \hlkwd{warning}\hlstd{(}\hlkwd{sprintf}\hlstd{(}\hlstr{"Marginalizing missing variable: %s"}\hlstd{, input))}
                \hlstd{margin_score} \hlkwb{=} \hlkwd{sum}\hlstd{(nomogram}\hlopt{$}\hlstd{inputs[[input]]}\hlopt{$}\hlkwd{scorefunc}\hlstd{(nomogram}\hlopt{$}\hlstd{inputs[[input]]}\hlopt{$}\hlstd{margins}\hlopt{$}\hlstd{value)} \hlopt{*} \hlstd{nomogram}\hlopt{$}\hlstd{inputs[[input]]}\hlopt{$}\hlstd{margins}\hlopt{$}\hlstd{fraction)}
                \hlkwd{return}\hlstd{(}\hlkwd{rep}\hlstd{(margin_score,} \hlkwd{nrow}\hlstd{(data)))}
        \hlstd{\}))}

        \hlstd{outputs} \hlkwb{=} \hlkwd{sapply}\hlstd{(nomogram}\hlopt{$}\hlstd{outputs,} \hlkwa{function}\hlstd{(}\hlkwc{f}\hlstd{)} \hlkwd{f}\hlstd{(scores))}
        \hlkwd{cbind}\hlstd{(}\hlkwc{Score} \hlstd{= scores, outputs)}
\hlstd{\}}
\end{alltt}
\end{kframe}
\end{knitrout}


\section{Model and data loading}
Trained models:
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{temp} \hlkwb{=} \hlkwd{readRDS}\hlstd{(}\hlstr{"05_final_model.rds"}\hlstd{)}
\hlstd{fit.gg} \hlkwb{=} \hlstd{temp}\hlopt{$}\hlstd{gg}
\hlstd{fit.gg2} \hlkwb{=} \hlstd{temp}\hlopt{$}\hlstd{gg2}
\hlstd{fit.cph} \hlkwb{=} \hlstd{temp}\hlopt{$}\hlstd{cph}
\hlstd{fit.km0} \hlkwb{=} \hlstd{temp}\hlopt{$}\hlstd{km0}
\hlstd{fit.rsf} \hlkwb{=} \hlstd{temp}\hlopt{$}\hlstd{rsf}
\hlstd{data.nswpcn} \hlkwb{=} \hlstd{temp}\hlopt{$}\hlstd{data.train}
\end{alltt}
\end{kframe}
\end{knitrout}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{data.glasgow} \hlkwb{=} \hlkwd{readRDS}\hlstd{(}\hlstr{"06_Glasgow.rds"}\hlstd{)}
\hlstd{data.glasgow}\hlopt{$}\hlstd{Path.LN.Negative} \hlkwb{=} \hlstd{data.glasgow}\hlopt{$}\hlstd{Path.LN.Inspected} \hlopt{-} \hlstd{data.glasgow}\hlopt{$}\hlstd{Path.LN.Involved}
\hlstd{data.glasgow}\hlopt{$}\hlstd{History.Diagnosis.AgeAt} \hlkwb{=} \hlstd{data.glasgow}\hlopt{$}\hlstd{History.Diagnosis.AgeAt.Cent} \hlopt{+} \hlnum{68}
\hlstd{data.glasgow}\hlopt{$}\hlstd{Path.Size} \hlkwb{=} \hlstd{data.glasgow}\hlopt{$}\hlstd{Path.Size.Cent} \hlopt{+} \hlnum{30}
\hlstd{data.glasgow}\hlopt{$}\hlstd{SexM} \hlkwb{=} \hlstd{data.glasgow}\hlopt{$}\hlstd{Patient.Sex} \hlopt{==} \hlstr{"M"}
\hlstd{data.glasgow}\hlopt{$}\hlstd{AgeCent} \hlkwb{=} \hlstd{data.glasgow}\hlopt{$}\hlstd{History.Diagnosis.AgeAt.Cent}
\hlstd{data.glasgow}\hlopt{$}\hlstd{SizeCent} \hlkwb{=} \hlstd{data.glasgow}\hlopt{$}\hlstd{Path.Size.Cent}
\hlstd{data.glasgow}\hlopt{$}\hlstd{A2} \hlkwb{=} \hlstd{data.glasgow}\hlopt{$}\hlstd{Molec.S100A2.DCThresh}
\hlstd{data.glasgow}\hlopt{$}\hlstd{A4} \hlkwb{=} \hlstd{data.glasgow}\hlopt{$}\hlstd{Molec.S100A4.DCThresh}
\hlstd{data.glasgow}\hlopt{$}\hlstd{LocBody} \hlkwb{=} \hlstd{data.glasgow}\hlopt{$}\hlstd{Path.Location} \hlopt{!=} \hlstr{"HOP"}
\hlstd{data.glasgow}\hlopt{$}\hlstd{Time} \hlkwb{=} \hlstd{data.glasgow}\hlopt{$}\hlstd{History.Death.EventTimeDays}
\hlstd{data.glasgow}\hlopt{$}\hlstd{DSD} \hlkwb{=} \hlstd{data.glasgow}\hlopt{$}\hlstd{History.DSDeath.Event}
\end{alltt}
\end{kframe}
\end{knitrout}


\section{Score calculation}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{temp} \hlkwb{=} \hlkwd{applyNomogram}\hlstd{(fit.mskcc, data.glasgow)}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Portal.Vein}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Splenectomy}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Posterior.Margin}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Back.pain}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Weight.loss}}\begin{alltt}
\hlstd{mskcc_post.linpred.glasgow} \hlkwb{=} \hlstd{temp[,}\hlnum{1}\hlstd{]}
\hlstd{mskcc_post.12mo.glasgow} \hlkwb{=} \hlstd{temp[,}\hlnum{2}\hlstd{]}
\hlstd{mskcc_post.24mo.glasgow} \hlkwb{=} \hlstd{temp[,}\hlnum{3}\hlstd{]}
\hlstd{mskcc_post.36mo.glasgow} \hlkwb{=} \hlstd{temp[,}\hlnum{4}\hlstd{]}
\hlstd{temp} \hlkwb{=} \hlkwd{applyNomogram}\hlstd{(fit.mskcc, data.glasgow[,}\hlkwd{c}\hlstd{(}\hlstr{"History.Diagnosis.AgeAt"}\hlstd{,} \hlstr{"Patient.Sex"}\hlstd{,} \hlstr{"Path.LocationBody"}\hlstd{,} \hlstr{"Stage.pT.Simplified"}\hlstd{,} \hlstr{"Path.Size"}\hlstd{)])}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Portal.Vein}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Splenectomy}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Treat.MarginPositive}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Path.Differentiation}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Posterior.Margin}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Path.LN.Involved}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Path.LN.Negative}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Back.pain}}

{\ttfamily\noindent\color{warningcolor}{\#\# Warning in FUN(c("{}History.Diagnosis.AgeAt"{}, "{}Patient.Sex"{}, "{}Portal.Vein"{}, : Marginalizing missing variable: Weight.loss}}\begin{alltt}
\hlstd{mskcc_pre.linpred.glasgow} \hlkwb{=} \hlstd{temp[,}\hlnum{1}\hlstd{]}
\hlstd{mskcc_pre.12mo.glasgow} \hlkwb{=} \hlstd{temp[,}\hlnum{2}\hlstd{]}
\hlstd{mskcc_pre.24mo.glasgow} \hlkwb{=} \hlstd{temp[,}\hlnum{3}\hlstd{]}
\hlstd{mskcc_pre.36mo.glasgow} \hlkwb{=} \hlstd{temp[,}\hlnum{4}\hlstd{]}
\end{alltt}
\end{kframe}
\end{knitrout}

Get approximate linear predictors from the GG model, by just calculating the location term effect.
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{val.prob.times} \hlkwb{=} \hlkwd{seq}\hlstd{(}\hlnum{0}\hlstd{,} \hlkwd{max}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time),} \hlnum{1}\hlstd{)}

\hlstd{gg.path.glasgow} \hlkwb{=} \hlkwd{summary}\hlstd{(fit.gg,} \hlkwc{newdata} \hlstd{= data.glasgow,} \hlkwc{ci} \hlstd{=} \hlnum{FALSE}\hlstd{)}
\hlstd{temp.coefs} \hlkwb{=} \hlkwd{coef}\hlstd{(fit.gg)}
\hlstd{gg.linpred.glasgow} \hlkwb{=} \hlkwd{sapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{length}\hlstd{(temp.coefs),} \hlkwa{function}\hlstd{(}\hlkwc{coef_i}\hlstd{) \{}
        \hlkwa{if} \hlstd{(}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.glasgow)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.glasgow[,}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]]}
        \hlstd{\}} \hlkwa{else if} \hlstd{(}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.glasgow)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.glasgow[,}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])]}
        \hlstd{\}} \hlkwa{else} \hlstd{\{}
                \hlkwd{rep}\hlstd{(}\hlnum{0}\hlstd{,} \hlkwd{nrow}\hlstd{(data.glasgow))}
        \hlstd{\} \})}
\hlstd{gg.linpred.glasgow} \hlkwb{=} \hlopt{-}\hlkwd{rowSums}\hlstd{(gg.linpred.glasgow)}       \hlcom{# Negate to bring into concordance with the direction of Cox coefficients (ie higher is now worse)}
\hlstd{temp} \hlkwb{=} \hlkwd{summary}\hlstd{(fit.gg,} \hlkwc{newdata} \hlstd{= data.glasgow,} \hlkwc{ci} \hlstd{=} \hlnum{FALSE}\hlstd{)}
\hlstd{gg.prob.glasgow} \hlkwb{=} \hlkwd{sapply}\hlstd{(temp,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{approx}\hlstd{(x[,}\hlnum{1}\hlstd{], x[,}\hlnum{2}\hlstd{],} \hlkwc{xout} \hlstd{= val.prob.times,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}\hlopt{$}\hlstd{y)}
\hlkwd{colnames}\hlstd{(gg.prob.glasgow)} \hlkwb{=} \hlkwd{rownames}\hlstd{(data.glasgow)}

\hlstd{gg.linpred.nswpcn} \hlkwb{=} \hlkwd{sapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{length}\hlstd{(temp.coefs),} \hlkwa{function}\hlstd{(}\hlkwc{coef_i}\hlstd{) \{}
        \hlkwa{if} \hlstd{(}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.nswpcn)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.nswpcn[,}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]]}
        \hlstd{\}} \hlkwa{else if} \hlstd{(}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.nswpcn)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.nswpcn[,}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])]}
        \hlstd{\}} \hlkwa{else} \hlstd{\{}
                \hlkwd{rep}\hlstd{(}\hlnum{0}\hlstd{,} \hlkwd{nrow}\hlstd{(data.nswpcn))}
        \hlstd{\} \})}
\hlstd{gg.linpred.nswpcn} \hlkwb{=} \hlopt{-}\hlkwd{rowSums}\hlstd{(gg.linpred.nswpcn)}         \hlcom{# Negate to bring into concordance with the direction of Cox coefficients (ie higher is now worse)}
\hlstd{temp} \hlkwb{=} \hlkwd{summary}\hlstd{(fit.gg,} \hlkwc{newdata} \hlstd{= data.nswpcn,} \hlkwc{ci} \hlstd{=} \hlnum{FALSE}\hlstd{)}
\hlstd{gg.prob.nswpcn} \hlkwb{=} \hlkwd{sapply}\hlstd{(temp,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{approx}\hlstd{(x[,}\hlnum{1}\hlstd{], x[,}\hlnum{2}\hlstd{],} \hlkwc{xout} \hlstd{= val.prob.times,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}\hlopt{$}\hlstd{y)}
\hlkwd{colnames}\hlstd{(gg.prob.nswpcn)} \hlkwb{=} \hlkwd{rownames}\hlstd{(data.nswpcn)}
\end{alltt}
\end{kframe}
\end{knitrout}

And the GG2
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{gg2.path.glasgow} \hlkwb{=} \hlkwd{summary}\hlstd{(fit.gg2,} \hlkwc{newdata} \hlstd{= data.glasgow,} \hlkwc{ci} \hlstd{=} \hlnum{FALSE}\hlstd{)}
\hlstd{temp.coefs} \hlkwb{=} \hlkwd{coef}\hlstd{(fit.gg2)}
\hlstd{gg2.linpred.glasgow} \hlkwb{=} \hlkwd{sapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{length}\hlstd{(temp.coefs),} \hlkwa{function}\hlstd{(}\hlkwc{coef_i}\hlstd{) \{}
        \hlkwa{if} \hlstd{(}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.glasgow)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.glasgow[,}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]]}
        \hlstd{\}} \hlkwa{else if} \hlstd{(}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.glasgow)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.glasgow[,}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])]}
        \hlstd{\}} \hlkwa{else} \hlstd{\{}
                \hlkwd{rep}\hlstd{(}\hlnum{0}\hlstd{,} \hlkwd{nrow}\hlstd{(data.glasgow))}
        \hlstd{\} \})}
\hlstd{gg2.linpred.glasgow} \hlkwb{=} \hlopt{-}\hlkwd{rowSums}\hlstd{(gg2.linpred.glasgow)}     \hlcom{# Negate to bring into concordance with the direction of Cox coefficients (ie higher is now worse)}
\hlstd{temp} \hlkwb{=} \hlkwd{summary}\hlstd{(fit.gg2,} \hlkwc{newdata} \hlstd{= data.glasgow,} \hlkwc{ci} \hlstd{=} \hlnum{FALSE}\hlstd{)}
\hlstd{gg2.prob.glasgow} \hlkwb{=} \hlkwd{sapply}\hlstd{(temp,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{approx}\hlstd{(x[,}\hlnum{1}\hlstd{], x[,}\hlnum{2}\hlstd{],} \hlkwc{xout} \hlstd{= val.prob.times,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}\hlopt{$}\hlstd{y)}
\hlkwd{colnames}\hlstd{(gg2.prob.glasgow)} \hlkwb{=} \hlkwd{rownames}\hlstd{(data.glasgow)}

\hlstd{gg2.linpred.nswpcn} \hlkwb{=} \hlkwd{sapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{length}\hlstd{(temp.coefs),} \hlkwa{function}\hlstd{(}\hlkwc{coef_i}\hlstd{) \{}
        \hlkwa{if} \hlstd{(}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.nswpcn)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.nswpcn[,}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]]}
        \hlstd{\}} \hlkwa{else if} \hlstd{(}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.nswpcn)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.nswpcn[,}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])]}
        \hlstd{\}} \hlkwa{else} \hlstd{\{}
                \hlkwd{rep}\hlstd{(}\hlnum{0}\hlstd{,} \hlkwd{nrow}\hlstd{(data.nswpcn))}
        \hlstd{\} \})}
\hlstd{gg2.linpred.nswpcn} \hlkwb{=} \hlopt{-}\hlkwd{rowSums}\hlstd{(gg2.linpred.nswpcn)}               \hlcom{# Negate to bring into concordance with the direction of Cox coefficients (ie higher is now worse)}
\hlstd{temp} \hlkwb{=} \hlkwd{summary}\hlstd{(fit.gg2,} \hlkwc{newdata} \hlstd{= data.nswpcn,} \hlkwc{ci} \hlstd{=} \hlnum{FALSE}\hlstd{)}
\hlstd{gg2.prob.nswpcn} \hlkwb{=} \hlkwd{sapply}\hlstd{(temp,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{approx}\hlstd{(x[,}\hlnum{1}\hlstd{], x[,}\hlnum{2}\hlstd{],} \hlkwc{xout} \hlstd{= val.prob.times,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}\hlopt{$}\hlstd{y)}
\hlkwd{colnames}\hlstd{(gg2.prob.nswpcn)} \hlkwb{=} \hlkwd{rownames}\hlstd{(data.nswpcn)}
\end{alltt}
\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{temp.coefs} \hlkwb{=} \hlkwd{coef}\hlstd{(fit.cph)}
\hlstd{cph.linpred.glasgow} \hlkwb{=} \hlkwd{sapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{length}\hlstd{(temp.coefs),} \hlkwa{function}\hlstd{(}\hlkwc{coef_i}\hlstd{) \{}
        \hlkwa{if} \hlstd{(}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.glasgow)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.glasgow[,}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]]}
        \hlstd{\}} \hlkwa{else if} \hlstd{(}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.glasgow)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.glasgow[,}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])]}
        \hlstd{\}} \hlkwa{else} \hlstd{\{}
                \hlkwd{rep}\hlstd{(}\hlnum{0}\hlstd{,} \hlkwd{nrow}\hlstd{(data.glasgow))}
        \hlstd{\} \})}
\hlstd{cph.linpred.glasgow} \hlkwb{=} \hlkwd{rowSums}\hlstd{(cph.linpred.glasgow)}
\hlstd{temp} \hlkwb{=} \hlkwd{survfit}\hlstd{(fit.cph,} \hlkwc{newdata} \hlstd{= data.glasgow)}
\hlstd{cph.prob.glasgow} \hlkwb{=} \hlkwd{simplify2array}\hlstd{(}\hlkwd{tapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{length}\hlstd{(temp}\hlopt{$}\hlstd{surv),} \hlkwd{rep}\hlstd{(}\hlkwd{names}\hlstd{(temp}\hlopt{$}\hlstd{strata), temp}\hlopt{$}\hlstd{strata),} \hlkwa{function}\hlstd{(}\hlkwc{is}\hlstd{)} \hlkwd{approx}\hlstd{(temp}\hlopt{$}\hlstd{time[is], temp}\hlopt{$}\hlstd{surv[is], val.prob.times,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}\hlopt{$}\hlstd{y))[,}\hlkwd{rownames}\hlstd{(data.glasgow)]}

\hlstd{cph.linpred.nswpcn} \hlkwb{=} \hlkwd{sapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{length}\hlstd{(temp.coefs),} \hlkwa{function}\hlstd{(}\hlkwc{coef_i}\hlstd{) \{}
        \hlkwa{if} \hlstd{(}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.nswpcn)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.nswpcn[,}\hlkwd{names}\hlstd{(temp.coefs)[coef_i]]}
        \hlstd{\}} \hlkwa{else if} \hlstd{(}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])} \hlopt{%in%} \hlkwd{colnames}\hlstd{(data.nswpcn)) \{}
                \hlstd{temp.coefs[coef_i]} \hlopt{*} \hlstd{data.nswpcn[,}\hlkwd{gsub}\hlstd{(}\hlstr{"TRUE$"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{names}\hlstd{(temp.coefs)[coef_i])]}
        \hlstd{\}} \hlkwa{else} \hlstd{\{}
                \hlkwd{rep}\hlstd{(}\hlnum{0}\hlstd{,} \hlkwd{nrow}\hlstd{(data.nswpcn))}
        \hlstd{\} \})}
\hlstd{cph.linpred.nswpcn} \hlkwb{=} \hlkwd{rowSums}\hlstd{(cph.linpred.nswpcn)}
\hlstd{temp} \hlkwb{=} \hlkwd{survfit}\hlstd{(fit.cph,} \hlkwc{newdata} \hlstd{= data.nswpcn)}
\hlstd{cph.prob.nswpcn} \hlkwb{=} \hlkwd{simplify2array}\hlstd{(}\hlkwd{tapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{length}\hlstd{(temp}\hlopt{$}\hlstd{surv),} \hlkwd{rep}\hlstd{(}\hlkwd{names}\hlstd{(temp}\hlopt{$}\hlstd{strata), temp}\hlopt{$}\hlstd{strata),} \hlkwa{function}\hlstd{(}\hlkwc{is}\hlstd{)} \hlkwd{approx}\hlstd{(temp}\hlopt{$}\hlstd{time[is], temp}\hlopt{$}\hlstd{surv[is], val.prob.times,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}\hlopt{$}\hlstd{y))[,}\hlkwd{rownames}\hlstd{(data.nswpcn)]}

\hlcom{# Doesn't work for some obscure reason, I suspect to do with strata and environments:}
\hlcom{# cph.linpred.glasgow = predict(fit.cph, newdata = data.glasgow)}
\hlcom{# cph.linpred.nswpcn = predict(fit.cph, newdata = data.nswpcn)}
\end{alltt}
\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{temp} \hlkwb{=} \hlkwd{predict}\hlstd{(fit.rsf,} \hlkwc{newdata} \hlstd{= data.glasgow)}
\hlstd{rsf.linpred.glasgow} \hlkwb{=} \hlkwd{apply}\hlstd{(temp}\hlopt{$}\hlstd{survival,} \hlnum{1}\hlstd{,} \hlkwa{function}\hlstd{(}\hlkwc{s1}\hlstd{) \{}
    \hlstd{sfunc} \hlkwb{=} \hlkwd{approxfun}\hlstd{(temp}\hlopt{$}\hlstd{time.interest, s1,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}
    \hlstd{med} \hlkwb{=} \hlkwd{uniroot}\hlstd{(}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{sfunc}\hlstd{(x)} \hlopt{-} \hlnum{0.5}\hlstd{,} \hlkwc{lower} \hlstd{=} \hlkwd{min}\hlstd{(temp}\hlopt{$}\hlstd{time.interest),} \hlkwc{upper} \hlstd{=} \hlkwd{max}\hlstd{(temp}\hlopt{$}\hlstd{time.interest))}\hlopt{$}\hlstd{root}
    \hlstd{med}
\hlstd{\})}
\hlstd{rsf.linpred.glasgow} \hlkwb{=} \hlopt{-}\hlstd{rsf.linpred.glasgow}
\hlstd{rsf.prob.glasgow} \hlkwb{=} \hlkwd{apply}\hlstd{(temp}\hlopt{$}\hlstd{survival,} \hlnum{1}\hlstd{,} \hlkwa{function}\hlstd{(}\hlkwc{s1}\hlstd{)} \hlkwd{approx}\hlstd{(temp}\hlopt{$}\hlstd{time.interest, s1,} \hlkwc{xout} \hlstd{= val.prob.times,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}\hlopt{$}\hlstd{y)}
\hlkwd{colnames}\hlstd{(rsf.prob.glasgow)} \hlkwb{=} \hlkwd{rownames}\hlstd{(data.glasgow)}

\hlstd{temp} \hlkwb{=} \hlkwd{predict}\hlstd{(fit.rsf,} \hlkwc{newdata} \hlstd{= data.nswpcn)}
\hlstd{rsf.linpred.nswpcn} \hlkwb{=} \hlkwd{apply}\hlstd{(temp}\hlopt{$}\hlstd{survival,} \hlnum{1}\hlstd{,} \hlkwa{function}\hlstd{(}\hlkwc{s1}\hlstd{) \{}
    \hlstd{sfunc} \hlkwb{=} \hlkwd{approxfun}\hlstd{(temp}\hlopt{$}\hlstd{time.interest, s1,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}
    \hlstd{med} \hlkwb{=} \hlkwd{uniroot}\hlstd{(}\hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{)} \hlkwd{sfunc}\hlstd{(x)} \hlopt{-} \hlnum{0.5}\hlstd{,} \hlkwc{lower} \hlstd{=} \hlkwd{min}\hlstd{(temp}\hlopt{$}\hlstd{time.interest),} \hlkwc{upper} \hlstd{=} \hlkwd{max}\hlstd{(temp}\hlopt{$}\hlstd{time.interest))}\hlopt{$}\hlstd{root}
    \hlstd{med}
\hlstd{\})}
\hlstd{rsf.linpred.nswpcn} \hlkwb{=} \hlopt{-}\hlstd{rsf.linpred.nswpcn}
\hlstd{rsf.prob.nswpcn} \hlkwb{=} \hlkwd{apply}\hlstd{(temp}\hlopt{$}\hlstd{survival,} \hlnum{1}\hlstd{,} \hlkwa{function}\hlstd{(}\hlkwc{s1}\hlstd{)} \hlkwd{approx}\hlstd{(temp}\hlopt{$}\hlstd{time.interest, s1,} \hlkwc{xout} \hlstd{= val.prob.times,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}\hlopt{$}\hlstd{y)}
\hlkwd{colnames}\hlstd{(rsf.prob.nswpcn)} \hlkwb{=} \hlkwd{rownames}\hlstd{(data.nswpcn)}
\end{alltt}
\end{kframe}
\end{knitrout}


\section{Validation}
\subsection{Altman diagnostic 1: score histograms}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{mfrow} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{2}\hlstd{,} \hlnum{1}\hlstd{))}
\hlkwd{hist}\hlstd{(gg.linpred.nswpcn,} \hlkwc{main} \hlstd{=} \hlstr{"NSWPCN GG scores"}\hlstd{,} \hlkwc{xlim} \hlstd{=} \hlkwd{range}\hlstd{(}\hlkwd{c}\hlstd{(gg.linpred.nswpcn, gg.linpred.glasgow)),} \hlkwc{breaks} \hlstd{=} \hlnum{20}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"grey"}\hlstd{)}
\hlkwd{abline}\hlstd{(}\hlkwc{v} \hlstd{=} \hlkwd{quantile}\hlstd{(gg.linpred.nswpcn,} \hlkwc{probs} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.25}\hlstd{,} \hlnum{0.5}\hlstd{,} \hlnum{0.75}\hlstd{)),} \hlkwc{col} \hlstd{=} \hlstr{"red"}\hlstd{)}
\hlkwd{hist}\hlstd{(gg.linpred.glasgow,} \hlkwc{main} \hlstd{=} \hlstr{"Glasgow GG scores"}\hlstd{,} \hlkwc{xlim} \hlstd{=} \hlkwd{range}\hlstd{(}\hlkwd{c}\hlstd{(gg.linpred.nswpcn, gg.linpred.glasgow)),} \hlkwc{breaks} \hlstd{=} \hlnum{20}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"grey"}\hlstd{)}
\hlkwd{abline}\hlstd{(}\hlkwc{v} \hlstd{=} \hlkwd{quantile}\hlstd{(gg.linpred.glasgow,} \hlkwc{probs} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.25}\hlstd{,} \hlnum{0.5}\hlstd{,} \hlnum{0.75}\hlstd{)),} \hlkwc{col} \hlstd{=} \hlstr{"red"}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-score-hists-1} 

}


\begin{kframe}\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{mfrow} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{1}\hlstd{))}

\hlkwd{par}\hlstd{(}\hlkwc{mfrow} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{2}\hlstd{,} \hlnum{1}\hlstd{))}
\hlkwd{hist}\hlstd{(cph.linpred.nswpcn,} \hlkwc{main} \hlstd{=} \hlstr{"NSWPCN CPH scores"}\hlstd{,} \hlkwc{xlim} \hlstd{=} \hlkwd{range}\hlstd{(}\hlkwd{c}\hlstd{(cph.linpred.nswpcn, cph.linpred.glasgow)),} \hlkwc{breaks} \hlstd{=} \hlnum{20}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"grey"}\hlstd{)}
\hlkwd{abline}\hlstd{(}\hlkwc{v} \hlstd{=} \hlkwd{quantile}\hlstd{(gg.linpred.nswpcn,} \hlkwc{probs} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.25}\hlstd{,} \hlnum{0.5}\hlstd{,} \hlnum{0.75}\hlstd{)),} \hlkwc{col} \hlstd{=} \hlstr{"red"}\hlstd{)}
\hlkwd{hist}\hlstd{(cph.linpred.glasgow,} \hlkwc{main} \hlstd{=} \hlstr{"Glasgow CPH scores"}\hlstd{,} \hlkwc{xlim} \hlstd{=} \hlkwd{range}\hlstd{(}\hlkwd{c}\hlstd{(cph.linpred.nswpcn, cph.linpred.glasgow)),} \hlkwc{breaks} \hlstd{=} \hlnum{20}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"grey"}\hlstd{)}
\hlkwd{abline}\hlstd{(}\hlkwc{v} \hlstd{=} \hlkwd{quantile}\hlstd{(gg.linpred.glasgow,} \hlkwc{probs} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.25}\hlstd{,} \hlnum{0.5}\hlstd{,} \hlnum{0.75}\hlstd{)),} \hlkwc{col} \hlstd{=} \hlstr{"red"}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-score-hists-2} 

}


\begin{kframe}\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{mfrow} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{1}\hlstd{))}

\hlkwd{par}\hlstd{(}\hlkwc{mfrow} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{2}\hlstd{,} \hlnum{1}\hlstd{))}
\hlkwd{hist}\hlstd{(rsf.linpred.nswpcn,} \hlkwc{main} \hlstd{=} \hlstr{"NSWPCN RSF scores"}\hlstd{,} \hlkwc{xlim} \hlstd{=} \hlkwd{range}\hlstd{(}\hlkwd{c}\hlstd{(rsf.linpred.nswpcn, rsf.linpred.glasgow)),} \hlkwc{breaks} \hlstd{=} \hlnum{20}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"grey"}\hlstd{)}
\hlkwd{abline}\hlstd{(}\hlkwc{v} \hlstd{=} \hlkwd{quantile}\hlstd{(rsf.linpred.nswpcn,} \hlkwc{probs} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.25}\hlstd{,} \hlnum{0.5}\hlstd{,} \hlnum{0.75}\hlstd{)),} \hlkwc{col} \hlstd{=} \hlstr{"red"}\hlstd{)}
\hlkwd{hist}\hlstd{(rsf.linpred.glasgow,} \hlkwc{main} \hlstd{=} \hlstr{"Glasgow RSF scores"}\hlstd{,} \hlkwc{xlim} \hlstd{=} \hlkwd{range}\hlstd{(}\hlkwd{c}\hlstd{(rsf.linpred.nswpcn, rsf.linpred.glasgow)),} \hlkwc{breaks} \hlstd{=} \hlnum{20}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"grey"}\hlstd{)}
\hlkwd{abline}\hlstd{(}\hlkwc{v} \hlstd{=} \hlkwd{quantile}\hlstd{(rsf.linpred.glasgow,} \hlkwc{probs} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0.25}\hlstd{,} \hlnum{0.5}\hlstd{,} \hlnum{0.75}\hlstd{)),} \hlkwc{col} \hlstd{=} \hlstr{"red"}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-score-hists-3} 

}


\begin{kframe}\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{mfrow} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{1}\hlstd{))}
\end{alltt}
\end{kframe}
\end{knitrout}

\subsection{Altman method 1 (D,F)}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{summary}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlstd{mskcc_post.linpred.glasgow, data.glasgow))}
\end{alltt}
\begin{verbatim}
## Call:
## coxph(formula = Surv(Time, DSD) ~ mskcc_post.linpred.glasgow, 
##     data = data.glasgow)
## 
##   n= 198, number of events= 170 
## 
##                               coef exp(coef) se(coef)    z Pr(>|z|)
## mskcc_post.linpred.glasgow 0.01484   1.01495  0.00405 3.67  0.00025
## 
##                            exp(coef) exp(-coef) lower .95 upper .95
## mskcc_post.linpred.glasgow      1.01      0.985      1.01      1.02
## 
## Concordance= 0.576  (se = 0.025 )
## Rsquare= 0.067   (max possible= 0.999 )
## Likelihood ratio test= 13.6  on 1 df,   p=0.000221
## Wald test            = 13.4  on 1 df,   p=0.000245
## Score (logrank) test = 13.6  on 1 df,   p=0.000229
\end{verbatim}
\begin{alltt}
\hlkwd{summary}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlstd{mskcc_pre.linpred.glasgow, data.glasgow))}
\end{alltt}
\begin{verbatim}
## Call:
## coxph(formula = Surv(Time, DSD) ~ mskcc_pre.linpred.glasgow, 
##     data = data.glasgow)
## 
##   n= 198, number of events= 170 
## 
##                                coef exp(coef)  se(coef)     z Pr(>|z|)
## mskcc_pre.linpred.glasgow -0.000423  0.999577  0.007318 -0.06     0.95
## 
##                           exp(coef) exp(-coef) lower .95 upper .95
## mskcc_pre.linpred.glasgow         1          1     0.985      1.01
## 
## Concordance= 0.421  (se = 0.025 )
## Rsquare= 0   (max possible= 0.999 )
## Likelihood ratio test= 0  on 1 df,   p=0.954
## Wald test            = 0  on 1 df,   p=0.954
## Score (logrank) test = 0  on 1 df,   p=0.954
\end{verbatim}
\begin{alltt}
\hlkwd{summary}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlstd{gg.linpred.glasgow, data.glasgow))}
\end{alltt}
\begin{verbatim}
## Call:
## coxph(formula = Surv(Time, DSD) ~ gg.linpred.glasgow, data = data.glasgow)
## 
##   n= 198, number of events= 170 
## 
##                     coef exp(coef) se(coef)    z Pr(>|z|)
## gg.linpred.glasgow 0.718     2.051    0.214 3.36  0.00078
## 
##                    exp(coef) exp(-coef) lower .95 upper .95
## gg.linpred.glasgow      2.05      0.488      1.35      3.12
## 
## Concordance= 0.602  (se = 0.025 )
## Rsquare= 0.056   (max possible= 0.999 )
## Likelihood ratio test= 11.3  on 1 df,   p=0.00077
## Wald test            = 11.3  on 1 df,   p=0.000779
## Score (logrank) test = 11.4  on 1 df,   p=0.000738
\end{verbatim}
\begin{alltt}
\hlkwd{summary}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlstd{cph.linpred.glasgow, data.glasgow))}
\end{alltt}
\begin{verbatim}
## Call:
## coxph(formula = Surv(Time, DSD) ~ cph.linpred.glasgow, data = data.glasgow)
## 
##   n= 198, number of events= 170 
## 
##                      coef exp(coef) se(coef)    z Pr(>|z|)
## cph.linpred.glasgow 1.012     2.752    0.179 5.66  1.5e-08
## 
##                     exp(coef) exp(-coef) lower .95 upper .95
## cph.linpred.glasgow      2.75      0.363      1.94      3.91
## 
## Concordance= 0.658  (se = 0.025 )
## Rsquare= 0.148   (max possible= 0.999 )
## Likelihood ratio test= 31.6  on 1 df,   p=1.85e-08
## Wald test            = 32.1  on 1 df,   p=1.48e-08
## Score (logrank) test = 33.1  on 1 df,   p=8.54e-09
\end{verbatim}
\begin{alltt}
\hlkwd{summary}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlstd{rsf.linpred.glasgow, data.glasgow))}
\end{alltt}
\begin{verbatim}
## Call:
## coxph(formula = Surv(Time, DSD) ~ rsf.linpred.glasgow, data = data.glasgow)
## 
##   n= 198, number of events= 170 
## 
##                         coef exp(coef) se(coef)    z Pr(>|z|)
## rsf.linpred.glasgow 0.003312  1.003317 0.000864 3.83  0.00013
## 
##                     exp(coef) exp(-coef) lower .95 upper .95
## rsf.linpred.glasgow         1      0.997         1      1.01
## 
## Concordance= 0.609  (se = 0.025 )
## Rsquare= 0.072   (max possible= 0.999 )
## Likelihood ratio test= 14.7  on 1 df,   p=0.000124
## Wald test            = 14.7  on 1 df,   p=0.000126
## Score (logrank) test = 14.9  on 1 df,   p=0.000115
\end{verbatim}
\begin{alltt}
\hlkwd{anova}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlkwd{offset}\hlstd{(gg.linpred.glasgow)} \hlopt{+} \hlstd{gg.linpred.glasgow, data.glasgow))}
\end{alltt}
\begin{verbatim}
## Analysis of Deviance Table
##  Cox model: response is Surv(Time, DSD)
## Terms added sequentially (first to last)
## 
##                    loglik Chisq Df Pr(>|Chi|)
## NULL                 -724                    
## gg.linpred.glasgow   -723  1.73  1       0.19
\end{verbatim}
\begin{alltt}
\hlkwd{anova}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlkwd{offset}\hlstd{(cph.linpred.glasgow)} \hlopt{+} \hlstd{cph.linpred.glasgow, data.glasgow))}
\end{alltt}
\begin{verbatim}
## Analysis of Deviance Table
##  Cox model: response is Surv(Time, DSD)
## Terms added sequentially (first to last)
## 
##                     loglik Chisq Df Pr(>|Chi|)
## NULL                  -713                    
## cph.linpred.glasgow   -713     0  1       0.95
\end{verbatim}
\begin{alltt}
\hlkwd{anova}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlkwd{offset}\hlstd{(rsf.linpred.glasgow)} \hlopt{+} \hlstd{rsf.linpred.glasgow, data.glasgow))}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning in fitter(X, Y, strats, offset, init, control, weights = weights, : Ran out of iterations and did not converge}}

{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in fitter(X, Y, strats, offset, init, control, weights = weights, : NA/NaN/Inf in foreign function call (arg 6)}}\end{kframe}
\end{knitrout}
Booyah.


\subsection{Altman method 2 (F)}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{summary}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlkwd{offset}\hlstd{(mskcc_pre.linpred.glasgow)} \hlopt{+} \hlstd{AgeCent} \hlopt{+} \hlstd{SexM} \hlopt{+} \hlstd{SizeCent} \hlopt{+} \hlstd{A2} \hlopt{+} \hlstd{A4, data.glasgow))}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning in fitter(X, Y, strats, offset, init, control, weights = weights, : Ran out of iterations and did not converge}}

{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in fitter(X, Y, strats, offset, init, control, weights = weights, : NA/NaN/Inf in foreign function call (arg 6)}}\begin{alltt}
\hlkwd{summary}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlkwd{offset}\hlstd{(mskcc_post.linpred.glasgow)} \hlopt{+} \hlstd{AgeCent} \hlopt{+} \hlstd{SexM} \hlopt{+} \hlstd{SizeCent} \hlopt{+} \hlstd{A2} \hlopt{+} \hlstd{A4, data.glasgow))}
\end{alltt}
\begin{verbatim}
## Call:
## coxph(formula = Surv(Time, DSD) ~ offset(mskcc_post.linpred.glasgow) + 
##     AgeCent + SexM + SizeCent + A2 + A4, data = data.glasgow)
## 
##   n= 198, number of events= 170 
## 
##               coef exp(coef)  se(coef)      z Pr(>|z|)
## AgeCent    0.22831   1.25648   0.01006  22.69  < 2e-16
## SexMTRUE  -5.22725   0.00537   0.30189 -17.32  < 2e-16
## SizeCent   0.14973   1.16152   0.01910   7.84  4.6e-15
## A2TRUE    -2.29883   0.10038   0.37880  -6.07  1.3e-09
## A4TRUE     4.93307 138.80556   0.29941  16.48  < 2e-16
## 
##          exp(coef) exp(-coef) lower .95 upper .95
## AgeCent   1.26e+00     0.7959   1.23194    1.2815
## SexMTRUE  5.37e-03   186.2805   0.00297    0.0097
## SizeCent  1.16e+00     0.8609   1.11884    1.2058
## A2TRUE    1.00e-01     9.9625   0.04777    0.2109
## A4TRUE    1.39e+02     0.0072  77.18720  249.6137
## 
## Concordance= 0.587  (se = 0.025 )
## Rsquare= 1   (max possible= 1 )
## Likelihood ratio test= 1719  on 5 df,   p=0
## Wald test            = 2210  on 5 df,   p=0
## Score (logrank) test = 12193  on 5 df,   p=0
\end{verbatim}
\begin{alltt}
\hlkwd{summary}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlkwd{offset}\hlstd{(gg.linpred.glasgow)} \hlopt{+} \hlstd{AgeCent} \hlopt{+} \hlstd{SexM} \hlopt{+} \hlstd{SizeCent} \hlopt{+} \hlstd{A2} \hlopt{+} \hlstd{A4, data.glasgow))}
\end{alltt}
\begin{verbatim}
## Call:
## coxph(formula = Surv(Time, DSD) ~ offset(gg.linpred.glasgow) + 
##     AgeCent + SexM + SizeCent + A2 + A4, data = data.glasgow)
## 
##   n= 198, number of events= 170 
## 
##              coef exp(coef) se(coef)     z Pr(>|z|)
## AgeCent  -0.03255   0.96797  0.00860 -3.78  0.00015
## SexMTRUE  0.69598   2.00568  0.16160  4.31  1.7e-05
## SizeCent  0.02457   1.02487  0.00737  3.33  0.00086
## A2TRUE    0.31058   1.36422  0.17387  1.79  0.07406
## A4TRUE   -0.04240   0.95849  0.17723 -0.24  0.81093
## 
##          exp(coef) exp(-coef) lower .95 upper .95
## AgeCent      0.968      1.033     0.952     0.984
## SexMTRUE     2.006      0.499     1.461     2.753
## SizeCent     1.025      0.976     1.010     1.040
## A2TRUE       1.364      0.733     0.970     1.918
## A4TRUE       0.958      1.043     0.677     1.357
## 
## Concordance= 0.681  (se = 0.025 )
## Rsquare= 0.208   (max possible= 0.999 )
## Likelihood ratio test= 46.1  on 5 df,   p=8.58e-09
## Wald test            = 46.9  on 5 df,   p=5.86e-09
## Score (logrank) test = 49.1  on 5 df,   p=2.14e-09
\end{verbatim}
\begin{alltt}
\hlkwd{summary}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlkwd{offset}\hlstd{(cph.linpred.glasgow)} \hlopt{+} \hlstd{AgeCent} \hlopt{+} \hlstd{SexM} \hlopt{+} \hlstd{SizeCent} \hlopt{+} \hlstd{A2} \hlopt{+} \hlstd{A4, data.glasgow))}
\end{alltt}
\begin{verbatim}
## Call:
## coxph(formula = Surv(Time, DSD) ~ offset(cph.linpred.glasgow) + 
##     AgeCent + SexM + SizeCent + A2 + A4, data = data.glasgow)
## 
##   n= 198, number of events= 170 
## 
##              coef exp(coef) se(coef)     z Pr(>|z|)
## AgeCent  -0.03255   0.96797  0.00860 -3.78  0.00015
## SexMTRUE  0.26736   1.30651  0.16160  1.65  0.09803
## SizeCent  0.01982   1.02002  0.00737  2.69  0.00719
## A2TRUE    0.10517   1.11090  0.17387  0.60  0.54526
## A4TRUE   -0.15400   0.85728  0.17723 -0.87  0.38489
## 
##          exp(coef) exp(-coef) lower .95 upper .95
## AgeCent      0.968      1.033     0.952     0.984
## SexMTRUE     1.307      0.765     0.952     1.793
## SizeCent     1.020      0.980     1.005     1.035
## A2TRUE       1.111      0.900     0.790     1.562
## A4TRUE       0.857      1.166     0.606     1.213
## 
## Concordance= 0.681  (se = 0.025 )
## Rsquare= 0.114   (max possible= 0.999 )
## Likelihood ratio test= 24.1  on 5 df,   p=0.000211
## Wald test            = 24.9  on 5 df,   p=0.000142
## Score (logrank) test = 25.5  on 5 df,   p=0.000112
\end{verbatim}
\begin{alltt}
\hlkwd{summary}\hlstd{(}\hlkwd{coxph}\hlstd{(}\hlkwd{Surv}\hlstd{(Time, DSD)} \hlopt{~} \hlkwd{offset}\hlstd{(rsf.linpred.glasgow)} \hlopt{+} \hlstd{AgeCent} \hlopt{+} \hlstd{SexM} \hlopt{+} \hlstd{SizeCent} \hlopt{+} \hlstd{A2} \hlopt{+} \hlstd{A4, data.glasgow))}
\end{alltt}


{\ttfamily\noindent\color{warningcolor}{\#\# Warning in fitter(X, Y, strats, offset, init, control, weights = weights, : Ran out of iterations and did not converge}}

{\ttfamily\noindent\bfseries\color{errorcolor}{\#\# Error in fitter(X, Y, strats, offset, init, control, weights = weights, : NA/NaN/Inf in foreign function call (arg 6)}}\end{kframe}
\end{knitrout}
Still strong evidence of misspecification or poor fit.  However, the above calibration slope was not significantly different from 1.  Hmm.  This doesn't necessarily sink the method, but will need checking as we go along.

\subsection{Altman method 3 (D)}
Look at the CIs above.

\subsection{Altman method 4 (D,C)}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{group_quantiles} \hlkwb{=} \hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{0.25}\hlstd{,} \hlnum{0.5}\hlstd{,} \hlnum{0.75}\hlstd{,} \hlnum{1}\hlstd{)}
\hlstd{mskcc_pre.groups.glasgow} \hlkwb{=} \hlkwd{cut}\hlstd{(mskcc_pre.linpred.glasgow,} \hlkwd{quantile}\hlstd{(mskcc_pre.linpred.glasgow, group_quantiles))}
\hlstd{mskcc_post.groups.glasgow} \hlkwb{=} \hlkwd{cut}\hlstd{(mskcc_post.linpred.glasgow,} \hlkwd{quantile}\hlstd{(mskcc_post.linpred.glasgow, group_quantiles))}
\hlstd{gg.groups.glasgow} \hlkwb{=} \hlkwd{cut}\hlstd{(gg.linpred.glasgow,} \hlkwd{quantile}\hlstd{(gg.linpred.glasgow, group_quantiles))}
\hlstd{gg.groups.nswpcn} \hlkwb{=} \hlkwd{cut}\hlstd{(gg.linpred.nswpcn,} \hlkwd{quantile}\hlstd{(gg.linpred.nswpcn, group_quantiles))}
\hlstd{cph.groups.glasgow} \hlkwb{=} \hlkwd{cut}\hlstd{(cph.linpred.glasgow,} \hlkwd{quantile}\hlstd{(cph.linpred.glasgow, group_quantiles))}
\hlstd{cph.groups.nswpcn} \hlkwb{=} \hlkwd{cut}\hlstd{(cph.linpred.nswpcn,} \hlkwd{quantile}\hlstd{(cph.linpred.nswpcn, group_quantiles))}
\hlstd{rsf.groups.glasgow} \hlkwb{=} \hlkwd{cut}\hlstd{(rsf.linpred.glasgow,} \hlkwd{quantile}\hlstd{(rsf.linpred.glasgow, group_quantiles))}
\hlstd{rsf.groups.nswpcn} \hlkwb{=} \hlkwd{cut}\hlstd{(rsf.linpred.nswpcn,} \hlkwd{quantile}\hlstd{(rsf.linpred.nswpcn, group_quantiles))}

\hlkwd{par}\hlstd{(}\hlkwc{mfrow} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{2}\hlstd{,} \hlnum{2}\hlstd{))}
\hlkwd{plot}\hlstd{(}\hlkwd{survfit}\hlstd{(}\hlkwd{Surv}\hlstd{(data.nswpcn}\hlopt{$}\hlstd{Time, data.nswpcn}\hlopt{$}\hlstd{DSD)} \hlopt{~} \hlstd{gg.groups.nswpcn),} \hlkwc{col} \hlstd{=} \hlnum{1}\hlopt{:}\hlstd{(}\hlkwd{length}\hlstd{(group_quantiles)}\hlopt{-}\hlnum{1}\hlstd{),} \hlkwc{xlab} \hlstd{=} \hlstr{"Time (days)"}\hlstd{,} \hlkwc{ylab} \hlstd{=} \hlstr{"Fraction Alive"}\hlstd{,} \hlkwc{main} \hlstd{=} \hlstr{"GG: NSWPCN (Resubstitution)"}\hlstd{)}
\hlkwd{plot}\hlstd{(}\hlkwd{survfit}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD)} \hlopt{~} \hlstd{gg.groups.glasgow),} \hlkwc{col} \hlstd{=} \hlnum{1}\hlopt{:}\hlstd{(}\hlkwd{length}\hlstd{(group_quantiles)}\hlopt{-}\hlnum{1}\hlstd{),} \hlkwc{xlab} \hlstd{=} \hlstr{"Time (days)"}\hlstd{,} \hlkwc{ylab} \hlstd{=} \hlstr{"Fraction Alive"}\hlstd{,} \hlkwc{main} \hlstd{=} \hlstr{"GG: Glasgow"}\hlstd{)}
\hlkwd{plot}\hlstd{(}\hlkwd{survfit}\hlstd{(}\hlkwd{Surv}\hlstd{(data.nswpcn}\hlopt{$}\hlstd{Time, data.nswpcn}\hlopt{$}\hlstd{DSD)} \hlopt{~} \hlstd{cph.groups.nswpcn),} \hlkwc{col} \hlstd{=} \hlnum{1}\hlopt{:}\hlstd{(}\hlkwd{length}\hlstd{(group_quantiles)}\hlopt{-}\hlnum{1}\hlstd{),} \hlkwc{xlab} \hlstd{=} \hlstr{"Time (days)"}\hlstd{,} \hlkwc{ylab} \hlstd{=} \hlstr{"Fraction Alive"}\hlstd{,} \hlkwc{main} \hlstd{=} \hlstr{"CPH: NSWPCN (Resubstitution)"}\hlstd{)}
\hlkwd{plot}\hlstd{(}\hlkwd{survfit}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD)} \hlopt{~} \hlstd{cph.groups.glasgow),} \hlkwc{col} \hlstd{=} \hlnum{1}\hlopt{:}\hlstd{(}\hlkwd{length}\hlstd{(group_quantiles)}\hlopt{-}\hlnum{1}\hlstd{),} \hlkwc{xlab} \hlstd{=} \hlstr{"Time (days)"}\hlstd{,} \hlkwc{ylab} \hlstd{=} \hlstr{"Fraction Alive"}\hlstd{,} \hlkwc{main} \hlstd{=} \hlstr{"CPH: Glasgow"}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-altman-4-1} 

}


\begin{kframe}\begin{alltt}
\hlkwd{plot}\hlstd{(}\hlkwd{survfit}\hlstd{(}\hlkwd{Surv}\hlstd{(data.nswpcn}\hlopt{$}\hlstd{Time, data.nswpcn}\hlopt{$}\hlstd{DSD)} \hlopt{~} \hlstd{rsf.groups.nswpcn),} \hlkwc{col} \hlstd{=} \hlnum{1}\hlopt{:}\hlstd{(}\hlkwd{length}\hlstd{(group_quantiles)}\hlopt{-}\hlnum{1}\hlstd{),} \hlkwc{xlab} \hlstd{=} \hlstr{"Time (days)"}\hlstd{,} \hlkwc{ylab} \hlstd{=} \hlstr{"Fraction Alive"}\hlstd{,} \hlkwc{main} \hlstd{=} \hlstr{"RSF: NSWPCN (Resubstitution)"}\hlstd{)}
\hlkwd{plot}\hlstd{(}\hlkwd{survfit}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD)} \hlopt{~} \hlstd{rsf.groups.glasgow),} \hlkwc{col} \hlstd{=} \hlnum{1}\hlopt{:}\hlstd{(}\hlkwd{length}\hlstd{(group_quantiles)}\hlopt{-}\hlnum{1}\hlstd{),} \hlkwc{xlab} \hlstd{=} \hlstr{"Time (days)"}\hlstd{,} \hlkwc{ylab} \hlstd{=} \hlstr{"Fraction Alive"}\hlstd{,} \hlkwc{main} \hlstd{=} \hlstr{"RSF: Glasgow"}\hlstd{)}
\hlkwd{plot}\hlstd{(}\hlkwd{survfit}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD)} \hlopt{~} \hlstd{mskcc_pre.groups.glasgow),} \hlkwc{col} \hlstd{=} \hlnum{1}\hlopt{:}\hlstd{(}\hlkwd{length}\hlstd{(group_quantiles)}\hlopt{-}\hlnum{1}\hlstd{),} \hlkwc{xlab} \hlstd{=} \hlstr{"Time (days)"}\hlstd{,} \hlkwc{ylab} \hlstd{=} \hlstr{"Fraction Alive"}\hlstd{,} \hlkwc{main} \hlstd{=} \hlstr{"MSKCC Preop: Glasgow"}\hlstd{)}
\hlkwd{plot}\hlstd{(}\hlkwd{survfit}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD)} \hlopt{~} \hlstd{mskcc_post.groups.glasgow),} \hlkwc{col} \hlstd{=} \hlnum{1}\hlopt{:}\hlstd{(}\hlkwd{length}\hlstd{(group_quantiles)}\hlopt{-}\hlnum{1}\hlstd{),} \hlkwc{xlab} \hlstd{=} \hlstr{"Time (days)"}\hlstd{,} \hlkwc{ylab} \hlstd{=} \hlstr{"Fraction Alive"}\hlstd{,} \hlkwc{main} \hlstd{=} \hlstr{"MSKCC Postop: Glasgow"}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-altman-4-2} 

}


\begin{kframe}\begin{alltt}
\hlkwd{par}\hlstd{(}\hlkwc{mfrow} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{1}\hlstd{))}

\hlcom{# temp = survfit(Surv(data.nswpcn$Time, data.nswpcn$DSD) ~ gg.groups.nswpcn)}
\hlcom{# plot(0 ~ 0, type = "n", xlim = c(0, max(data.nswpcn$Time)), ylim = c(0, 1))}
\hlcom{# for (i in )}
\end{alltt}
\end{kframe}
\end{knitrout}
Weird.  MSKCC somehow is still finding a subgroup, and it's somehow even clearer in preop!  This is based on an approximation to GG only, but should be pretty close.  It certainly does OK on resubstituted data, but not so well on the Glasgow patients.


Decision curve analysis.
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{temp.data} \hlkwb{=} \hlkwd{data.frame}\hlstd{(}\hlkwc{Time} \hlstd{= data.glasgow}\hlopt{$}\hlstd{Time,} \hlkwc{DSD} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD}\hlopt{*}\hlnum{1}\hlstd{,}
    \hlkwc{gg.1} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{gg.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlstd{,],} \hlkwc{gg.2} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{gg.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlopt{*}\hlnum{2}\hlstd{,],} \hlkwc{gg.3} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{gg.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlopt{*}\hlnum{3}\hlstd{,],}
    \hlkwc{gg2.1} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{gg2.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlstd{,],} \hlkwc{gg2.2} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{gg2.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlopt{*}\hlnum{2}\hlstd{,],} \hlkwc{gg2.3} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{gg2.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlopt{*}\hlnum{3}\hlstd{,],}
    \hlkwc{cph.1} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{cph.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlstd{,],} \hlkwc{cph.2} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{cph.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlopt{*}\hlnum{2}\hlstd{,],} \hlkwc{cph.3} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{cph.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlopt{*}\hlnum{3}\hlstd{,],}
    \hlkwc{rsf.1} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{rsf.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlstd{,],} \hlkwc{rsf.2} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{rsf.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlopt{*}\hlnum{2}\hlstd{,],} \hlkwc{rsf.3} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{rsf.prob.glasgow[val.prob.times} \hlopt{==} \hlnum{365}\hlopt{*}\hlnum{3}\hlstd{,],}
    \hlkwc{mskcc.pre.1} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{mskcc_pre.12mo.glasgow,} \hlkwc{mskcc.pre.2} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{mskcc_pre.24mo.glasgow,} \hlkwc{mskcc.pre.3} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{mskcc_pre.36mo.glasgow,}
    \hlkwc{mskcc.post.1} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{mskcc_post.12mo.glasgow,} \hlkwc{mskcc.post.2} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{mskcc_post.24mo.glasgow,} \hlkwc{mskcc.post.3} \hlstd{=} \hlnum{1}\hlopt{-}\hlstd{mskcc_post.36mo.glasgow)}
\hlkwd{stdca}\hlstd{(}\hlkwc{data} \hlstd{= temp.data,} \hlkwc{outcome} \hlstd{=} \hlstr{"DSD"}\hlstd{,} \hlkwc{ttoutcome} \hlstd{=} \hlstr{"Time"}\hlstd{,} \hlkwc{predictors} \hlstd{=} \hlkwd{c}\hlstd{(}\hlstr{"gg.1"}\hlstd{,} \hlstr{"cph.1"}\hlstd{,} \hlstr{"rsf.1"}\hlstd{,} \hlstr{"mskcc.pre.1"}\hlstd{,} \hlstr{"mskcc.post.1"}\hlstd{),} \hlkwc{timepoint} \hlstd{=} \hlnum{365}\hlstd{,} \hlkwc{probability} \hlstd{=} \hlkwd{rep}\hlstd{(}\hlnum{TRUE}\hlstd{,} \hlnum{5}\hlstd{))}
\end{alltt}
\begin{verbatim}
## [1] "gg.1: No observations with risk greater than 66% that have followup through the timepoint selected, and therefore net benefit not calculable in this range."        
## [2] "cph.1: No observations with risk greater than 71% that have followup through the timepoint selected, and therefore net benefit not calculable in this range."       
## [3] "rsf.1: No observations with risk greater than 58%, and therefore net benefit not calculable in this range."                                                         
## [4] "mskcc.pre.1: No observations with risk greater than 44%, and therefore net benefit not calculable in this range."                                                   
## [5] "mskcc.post.1: No observations with risk greater than 31% that have followup through the timepoint selected, and therefore net benefit not calculable in this range."
\end{verbatim}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-model-selection-dca-1} 

}


\begin{kframe}\begin{verbatim}
## $N
## [1] 198
## 
## $predictors
##      predictor harm.applied probability
## 1         gg.1            0        TRUE
## 2        cph.1            0        TRUE
## 3        rsf.1            0        TRUE
## 4  mskcc.pre.1            0        TRUE
## 5 mskcc.post.1            0        TRUE
## 
## $interventions.avoided.per
## [1] 100
## 
## $net.benefit
##    threshold        all none      gg.1      cph.1      rsf.1 mskcc.pre.1
## 1       0.01   0.306589    0  0.306589  0.3065893  0.3065893    0.306589
## 2       0.02   0.299514    0  0.299514  0.2995137  0.2995137    0.299514
## 3       0.03   0.292292    0  0.292292  0.2922922  0.2922922    0.292292
## 4       0.04   0.284920    0  0.284920  0.2849202  0.2849202    0.284920
## 5       0.05   0.277393    0  0.277393  0.2773931  0.2773931    0.277393
## 6       0.06   0.269706    0  0.269706  0.2697058  0.2697058    0.269706
## 7       0.07   0.261853    0  0.261853  0.2618532  0.2618532    0.261853
## 8       0.08   0.253830    0  0.253830  0.2538298  0.2538298    0.253830
## 9       0.09   0.245630    0  0.245630  0.2456301  0.2456301    0.245630
## 10      0.10   0.237248    0  0.237248  0.2372483  0.2372483    0.237248
## 11      0.11   0.228678    0  0.228678  0.2286780  0.2286780    0.228678
## 12      0.12   0.219913    0  0.219913  0.2199130  0.2199130    0.219913
## 13      0.13   0.210946    0  0.211866  0.2109465  0.2109465    0.210946
## 14      0.14   0.201771    0  0.202760  0.2017714  0.2017714    0.201771
## 15      0.15   0.192381    0  0.193441  0.1934405  0.1923805    0.192381
## 16      0.16   0.182766    0  0.185033  0.1838987  0.1827660    0.189592
## 17      0.17   0.172920    0  0.170501  0.1741270  0.1729198    0.186558
## 18      0.18   0.162833    0  0.170055  0.1654025  0.1628335    0.181338
## 19      0.19   0.152498    0  0.163590  0.1511420  0.1524981    0.082587
## 20      0.20   0.141904    0  0.150228  0.1410995  0.1419043    0.005051
## 21      0.21   0.131042    0  0.140731  0.1416072  0.1325664    0.002365
## 22      0.22   0.119902    0  0.132507  0.1310293  0.1215102    0.002202
## 23      0.23   0.108472    0  0.128497  0.1235510  0.1080597    0.002033
## 24      0.24   0.096741    0  0.108298  0.1156326  0.1018303    0.001861
## 25      0.25   0.084698    0  0.105979  0.1057266  0.1000819    0.001684
## 26      0.26   0.072329    0  0.097476  0.0830713  0.1010388    0.001502
## 27      0.27   0.059621    0  0.093622  0.0697112  0.0783064   -0.003736
## 28      0.28   0.046560    0  0.083209  0.0584838  0.0644370   -0.003928
## 29      0.29   0.033132    0  0.081623  0.0585315  0.0509696   -0.004126
## 30      0.30   0.019319    0  0.075954  0.0545631  0.0569300   -0.004329
## 31      0.31   0.005106    0  0.073950  0.0616455  0.0641851   -0.004538
## 32      0.32  -0.009524    0  0.065962  0.0632836  0.0626225    0.005051
## 33      0.33  -0.024592    0  0.060465  0.0553332  0.0559859    0.005051
## 34      0.34  -0.040116    0  0.052811  0.0523853  0.0496023    0.005051
## 35      0.35  -0.056118    0  0.047131  0.0445666  0.0420020    0.005051
## 36      0.36  -0.072620    0  0.039266  0.0370852  0.0256506    0.005051
## 37      0.37  -0.089645    0  0.031151  0.0290960  0.0134576    0.005051
## 38      0.38  -0.107220    0  0.030659  0.0110916  0.0089107    0.005051
## 39      0.39  -0.125371    0  0.030922  0.0029111  0.0009429    0.005051
## 40      0.40  -0.144128    0  0.014347 -0.0019262 -0.0126816    0.005051
## 41      0.41  -0.163520    0  0.025589  0.0008032 -0.0174713    0.005051
## 42      0.42  -0.183580    0  0.013039 -0.0011808 -0.0222470    0.005051
## 43      0.43  -0.204345    0  0.004320 -0.0066219 -0.0364749    0.005051
## 44      0.44  -0.225851    0  0.031262 -0.0139147 -0.0181292          NA
## 45      0.45  -0.248139    0  0.028439 -0.0182290  0.0008910          NA
## 46      0.46  -0.271253    0  0.020609  0.0109984  0.0296467          NA
## 47      0.47  -0.295239    0  0.008770  0.0140049  0.0388449          NA
## 48      0.48  -0.320147    0  0.017612  0.0073653  0.0282403          NA
## 49      0.49  -0.346032    0  0.016906  0.0112484  0.0138421          NA
## 50      0.50  -0.372953    0  0.005312  0.0107293 -0.0052247          NA
## 51      0.51  -0.400973    0  0.010232  0.0217428 -0.0136643          NA
## 52      0.52  -0.430160    0  0.004804  0.0338886 -0.0170004          NA
## 53      0.53  -0.460588    0  0.005588  0.0233128 -0.0145983          NA
## 54      0.54  -0.492340    0  0.000000  0.0088441 -0.0057093          NA
## 55      0.55  -0.525503    0 -0.004676  0.0040195 -0.0072952          NA
## 56      0.56  -0.560174    0  0.010806  0.0004703  0.0146924          NA
## 57      0.57  -0.596457    0  0.012747 -0.0131485  0.0084567          NA
## 58      0.58  -0.634468    0  0.022186 -0.0284477         NA          NA
## 59      0.59  -0.674333    0  0.009622 -0.0440398         NA          NA
## 60      0.60  -0.716191    0  0.002602 -0.0416667         NA          NA
## 61      0.61  -0.760196    0 -0.001735 -0.0226402         NA          NA
## 62      0.62  -0.806517    0  0.008373 -0.0377656         NA          NA
## 63      0.63  -0.855342    0  0.009510 -0.0443625         NA          NA
## 64      0.64  -0.906879    0  0.015633 -0.0544576         NA          NA
## 65      0.65  -0.961362    0  0.013915 -0.0497835         NA          NA
## 66      0.66  -1.019049    0        NA -0.0356506         NA          NA
## 67      0.67  -1.080232    0        NA -0.0281839         NA          NA
## 68      0.68  -1.145239    0        NA -0.0082645         NA          NA
## 69      0.69  -1.214441    0        NA -0.0104861         NA          NA
## 70      0.70  -1.288255    0        NA -0.0185185         NA          NA
## 71      0.71  -1.367161    0        NA         NA         NA          NA
## 72      0.72  -1.451702    0        NA         NA         NA          NA
## 73      0.73  -1.542506    0        NA         NA         NA          NA
## 74      0.74  -1.640294    0        NA         NA         NA          NA
## 75      0.75  -1.745906    0        NA         NA         NA          NA
## 76      0.76  -1.860319    0        NA         NA         NA          NA
## 77      0.77  -1.984681    0        NA         NA         NA          NA
## 78      0.78  -2.120348    0        NA         NA         NA          NA
## 79      0.79  -2.268936    0        NA         NA         NA          NA
## 80      0.80  -2.432383    0        NA         NA         NA          NA
## 81      0.81  -2.613035    0        NA         NA         NA          NA
## 82      0.82  -2.813759    0        NA         NA         NA          NA
## 83      0.83  -3.038097    0        NA         NA         NA          NA
## 84      0.84  -3.290479    0        NA         NA         NA          NA
## 85      0.85  -3.576510    0        NA         NA         NA          NA
## 86      0.86  -3.903404    0        NA         NA         NA          NA
## 87      0.87  -4.280589    0        NA         NA         NA          NA
## 88      0.88  -4.720638    0        NA         NA         NA          NA
## 89      0.89  -5.240696    0        NA         NA         NA          NA
## 90      0.90  -5.864766    0        NA         NA         NA          NA
## 91      0.91  -6.627517    0        NA         NA         NA          NA
## 92      0.92  -7.580957    0        NA         NA         NA          NA
## 93      0.93  -8.806808    0        NA         NA         NA          NA
## 94      0.94 -10.441276    0        NA         NA         NA          NA
## 95      0.95 -12.729531    0        NA         NA         NA          NA
## 96      0.96 -16.161914    0        NA         NA         NA          NA
## 97      0.97 -21.882552    0        NA         NA         NA          NA
## 98      0.98 -33.323828    0        NA         NA         NA          NA
## 99      0.99 -67.647657    0        NA         NA         NA          NA
##    mskcc.post.1
## 1      0.306589
## 2      0.299514
## 3      0.292292
## 4      0.284920
## 5      0.277393
## 6      0.269706
## 7      0.261853
## 8      0.253830
## 9      0.245630
## 10     0.237248
## 11     0.229463
## 12     0.225051
## 13     0.206737
## 14     0.200009
## 15     0.195373
## 16     0.179161
## 17     0.150617
## 18     0.110140
## 19     0.108100
## 20     0.080708
## 21     0.074611
## 22     0.048221
## 23     0.033413
## 24     0.014784
## 25     0.003573
## 26     0.016870
## 27     0.015221
## 28     0.015917
## 29     0.013231
## 30     0.010582
## 31           NA
## 32           NA
## 33           NA
## 34           NA
## 35           NA
## 36           NA
## 37           NA
## 38           NA
## 39           NA
## 40           NA
## 41           NA
## 42           NA
## 43           NA
## 44           NA
## 45           NA
## 46           NA
## 47           NA
## 48           NA
## 49           NA
## 50           NA
## 51           NA
## 52           NA
## 53           NA
## 54           NA
## 55           NA
## 56           NA
## 57           NA
## 58           NA
## 59           NA
## 60           NA
## 61           NA
## 62           NA
## 63           NA
## 64           NA
## 65           NA
## 66           NA
## 67           NA
## 68           NA
## 69           NA
## 70           NA
## 71           NA
## 72           NA
## 73           NA
## 74           NA
## 75           NA
## 76           NA
## 77           NA
## 78           NA
## 79           NA
## 80           NA
## 81           NA
## 82           NA
## 83           NA
## 84           NA
## 85           NA
## 86           NA
## 87           NA
## 88           NA
## 89           NA
## 90           NA
## 91           NA
## 92           NA
## 93           NA
## 94           NA
## 95           NA
## 96           NA
## 97           NA
## 98           NA
## 99           NA
## 
## $interventions.avoided
##    threshold    gg.1   cph.1   rsf.1 mskcc.pre.1 mskcc.post.1
## 1       0.01  0.0000  0.0000  0.0000       0.000       0.0000
## 2       0.02  0.0000  0.0000  0.0000       0.000       0.0000
## 3       0.03  0.0000  0.0000  0.0000       0.000       0.0000
## 4       0.04  0.0000  0.0000  0.0000       0.000       0.0000
## 5       0.05  0.0000  0.0000  0.0000       0.000       0.0000
## 6       0.06  0.0000  0.0000  0.0000       0.000       0.0000
## 7       0.07  0.0000  0.0000  0.0000       0.000       0.0000
## 8       0.08  0.0000  0.0000  0.0000       0.000       0.0000
## 9       0.09  0.0000  0.0000  0.0000       0.000       0.0000
## 10      0.10  0.0000  0.0000  0.0000       0.000       0.0000
## 11      0.11  0.0000  0.0000  0.0000       0.000       0.6354
## 12      0.12  0.0000  0.0000  0.0000       0.000       3.7681
## 13      0.13  0.6154  0.0000  0.0000       0.000      -2.8173
## 14      0.14  0.6075  0.0000  0.0000       0.000      -1.0828
## 15      0.15  0.6007  0.6007  0.0000       0.000       1.6956
## 16      0.16  1.1904  0.5947  0.0000       3.584      -1.8925
## 17      0.17 -1.1809  0.5894  0.0000       6.659     -10.8891
## 18      0.18  3.2900  1.1704  0.0000       8.430     -24.0046
## 19      0.19  4.7287 -0.5781  0.0000     -29.804     -18.9276
## 20      0.20  3.3296 -0.3219  0.0000     -54.742     -24.4785
## 21      0.21  3.6450  3.9744  0.5733     -48.407     -21.2290
## 22      0.22  4.4690  3.9452  0.5702     -41.730     -25.4140
## 23      0.23  6.7041  5.0482 -0.1380     -35.634     -25.1286
## 24      0.24  3.6595  5.9822  1.6115     -30.046     -25.9530
## 25      0.25  6.3844  6.3086  4.6152     -24.904     -24.3376
## 26      0.26  7.1571  3.0574  8.1713     -20.159     -15.7845
## 27      0.27  9.1928  2.7280  5.0519     -17.130     -12.0046
## 28      0.28  9.4238  3.0660  4.5969     -12.983      -7.8798
## 29      0.29 11.8721  6.2186  4.3672      -9.122      -4.8722
## 30      0.30 13.2149  8.2236  8.7759      -5.518      -2.0387
## 31      0.31 15.3233 12.5845 13.1498      -2.147           NA
## 32      0.32 16.0408 15.4717 15.3312       3.097           NA
## 33      0.33 17.2692 16.2272 16.3597       6.018           NA
## 34      0.34 18.0387 17.9561 17.4159       8.768           NA
## 35      0.35 19.1748 18.6985 18.2222      11.360           NA
## 36      0.36 19.8907 19.5031 17.4703      13.808           NA
## 37      0.37 20.5680 20.2181 17.5554      16.124           NA
## 38      0.38 22.4962 19.3035 18.9477      18.318           NA
## 39      0.39 24.4459 20.0647 19.7569      20.399           NA
## 40      0.40 23.7712 21.3302 19.7169      22.377           NA
## 41      0.41 27.2132 23.6464 21.0167      24.258           NA
## 42      0.42 27.1522 25.1885 22.2794      26.049           NA
## 43      0.43 27.6603 26.2098 22.2525      27.757           NA
## 44      0.44 32.7234 26.9737 26.4373          NA           NA
## 45      0.45 33.8040 28.1001 30.4370          NA           NA
## 46      0.46 34.2621 33.1338 35.3230          NA           NA
## 47      0.47 34.2819 34.8722 37.6733          NA           NA
## 48      0.48 36.5906 35.4805 37.7420          NA           NA
## 49      0.49 37.7752 37.1864 37.4563          NA           NA
## 50      0.50 37.8265 38.3682 36.7728          NA           NA
## 51      0.51 39.5079 40.6138 37.2120          NA           NA
## 52      0.52 40.1505 42.8352 38.1378          NA           NA
## 53      0.53 41.3402 42.9120 39.5501          NA           NA
## 54      0.54 41.9401 42.6935 41.4538          NA           NA
## 55      0.55 42.6131 43.3246 42.3989          NA           NA
## 56      0.56 44.8627 44.0506 45.1681          NA           NA
## 57      0.57 45.9575 44.0040 45.6338          NA           NA
## 58      0.58 47.5508 43.8842      NA          NA           NA
## 59      0.59 47.5291 43.8000      NA          NA           NA
## 60      0.60 47.9195 44.9683      NA          NA           NA
## 61      0.61 48.4918 47.1552      NA          NA           NA
## 62      0.62 49.9449 47.1170      NA          NA           NA
## 63      0.63 50.7929 47.6290      NA          NA           NA
## 64      0.64 51.8913 47.9487      NA          NA           NA
## 65      0.65 52.5149 49.0850      NA          NA           NA
## 66      0.66      NA 50.6599      NA          NA           NA
## 67      0.67      NA 51.8173      NA          NA           NA
## 68      0.68      NA 53.5047      NA          NA           NA
## 69      0.69      NA 54.0907      NA          NA           NA
## 70      0.70      NA 54.4173      NA          NA           NA
## 71      0.71      NA      NA      NA          NA           NA
## 72      0.72      NA      NA      NA          NA           NA
## 73      0.73      NA      NA      NA          NA           NA
## 74      0.74      NA      NA      NA          NA           NA
## 75      0.75      NA      NA      NA          NA           NA
## 76      0.76      NA      NA      NA          NA           NA
## 77      0.77      NA      NA      NA          NA           NA
## 78      0.78      NA      NA      NA          NA           NA
## 79      0.79      NA      NA      NA          NA           NA
## 80      0.80      NA      NA      NA          NA           NA
## 81      0.81      NA      NA      NA          NA           NA
## 82      0.82      NA      NA      NA          NA           NA
## 83      0.83      NA      NA      NA          NA           NA
## 84      0.84      NA      NA      NA          NA           NA
## 85      0.85      NA      NA      NA          NA           NA
## 86      0.86      NA      NA      NA          NA           NA
## 87      0.87      NA      NA      NA          NA           NA
## 88      0.88      NA      NA      NA          NA           NA
## 89      0.89      NA      NA      NA          NA           NA
## 90      0.90      NA      NA      NA          NA           NA
## 91      0.91      NA      NA      NA          NA           NA
## 92      0.92      NA      NA      NA          NA           NA
## 93      0.93      NA      NA      NA          NA           NA
## 94      0.94      NA      NA      NA          NA           NA
## 95      0.95      NA      NA      NA          NA           NA
## 96      0.96      NA      NA      NA          NA           NA
## 97      0.97      NA      NA      NA          NA           NA
## 98      0.98      NA      NA      NA          NA           NA
## 99      0.99      NA      NA      NA          NA           NA
\end{verbatim}
\begin{alltt}
\hlkwd{stdca}\hlstd{(}\hlkwc{data} \hlstd{= temp.data,} \hlkwc{outcome} \hlstd{=} \hlstr{"DSD"}\hlstd{,} \hlkwc{ttoutcome} \hlstd{=} \hlstr{"Time"}\hlstd{,} \hlkwc{predictors} \hlstd{=} \hlkwd{c}\hlstd{(}\hlstr{"gg.2"}\hlstd{,} \hlstr{"cph.2"}\hlstd{,} \hlstr{"rsf.2"}\hlstd{,} \hlstr{"mskcc.pre.2"}\hlstd{,} \hlstr{"mskcc.post.2"}\hlstd{),} \hlkwc{timepoint} \hlstd{=} \hlnum{365}\hlopt{*}\hlnum{2}\hlstd{,} \hlkwc{probability} \hlstd{=} \hlkwd{rep}\hlstd{(}\hlnum{TRUE}\hlstd{,} \hlnum{5}\hlstd{))}
\end{alltt}
\begin{verbatim}
## [1] "gg.2: No observations with risk greater than 95% that have followup through the timepoint selected, and therefore net benefit not calculable in this range."        
## [2] "cph.2: No observations with risk greater than 95% that have followup through the timepoint selected, and therefore net benefit not calculable in this range."       
## [3] "rsf.2: No observations with risk greater than 87%, and therefore net benefit not calculable in this range."                                                         
## [4] "mskcc.pre.2: No observations with risk greater than 79%, and therefore net benefit not calculable in this range."                                                   
## [5] "mskcc.post.2: No observations with risk greater than 63% that have followup through the timepoint selected, and therefore net benefit not calculable in this range."
\end{verbatim}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-model-selection-dca-2} 

}


\begin{kframe}\begin{verbatim}
## $N
## [1] 198
## 
## $predictors
##      predictor harm.applied probability
## 1         gg.2            0        TRUE
## 2        cph.2            0        TRUE
## 3        rsf.2            0        TRUE
## 4  mskcc.pre.2            0        TRUE
## 5 mskcc.post.2            0        TRUE
## 
## $interventions.avoided.per
## [1] 100
## 
## $net.benefit
##    threshold        all none      gg.2     cph.2      rsf.2 mskcc.pre.2
## 1       0.01   0.588071    0  0.588071  0.588071  5.881e-01    0.588071
## 2       0.02   0.583868    0  0.583868  0.583868  5.839e-01    0.583868
## 3       0.03   0.579578    0  0.579578  0.579578  5.796e-01    0.579578
## 4       0.04   0.575199    0  0.575199  0.575199  5.752e-01    0.575199
## 5       0.05   0.570727    0  0.570727  0.570727  5.707e-01    0.570727
## 6       0.06   0.566160    0  0.566160  0.566160  5.662e-01    0.566160
## 7       0.07   0.561495    0  0.561495  0.561495  5.615e-01    0.561495
## 8       0.08   0.556729    0  0.556729  0.556729  5.567e-01    0.556729
## 9       0.09   0.551858    0  0.551858  0.551858  5.519e-01    0.551858
## 10      0.10   0.546878    0  0.546878  0.546878  5.469e-01    0.546878
## 11      0.11   0.541787    0  0.541787  0.541787  5.418e-01    0.541787
## 12      0.12   0.536580    0  0.536580  0.536580  5.366e-01    0.536580
## 13      0.13   0.531254    0  0.531254  0.531254  5.313e-01    0.531254
## 14      0.14   0.525803    0  0.525803  0.525803  5.258e-01    0.525803
## 15      0.15   0.520224    0  0.520224  0.520224  5.202e-01    0.520224
## 16      0.16   0.514513    0  0.514513  0.514513  5.145e-01    0.514513
## 17      0.17   0.508663    0  0.508663  0.508663  5.087e-01    0.508663
## 18      0.18   0.502672    0  0.502672  0.502672  5.027e-01    0.502672
## 19      0.19   0.496532    0  0.496532  0.496532  4.965e-01    0.496532
## 20      0.20   0.490238    0  0.490238  0.490238  4.902e-01    0.490238
## 21      0.21   0.483786    0  0.483786  0.483786  4.838e-01    0.483786
## 22      0.22   0.477167    0  0.477167  0.477167  4.772e-01    0.477167
## 23      0.23   0.470377    0  0.470377  0.470377  4.704e-01    0.470377
## 24      0.24   0.463409    0  0.463409  0.463409  4.634e-01    0.463409
## 25      0.25   0.456254    0  0.456254  0.456254  4.563e-01    0.456254
## 26      0.26   0.448906    0  0.448906  0.448906  4.489e-01    0.448906
## 27      0.27   0.441357    0  0.441357  0.441357  4.414e-01    0.441357
## 28      0.28   0.433598    0  0.433598  0.433598  4.336e-01    0.433598
## 29      0.29   0.425621    0  0.425621  0.425621  4.256e-01    0.425621
## 30      0.30   0.417415    0  0.417415  0.417415  4.174e-01    0.417415
## 31      0.31   0.408972    0  0.408972  0.408972  4.090e-01    0.408972
## 32      0.32   0.400280    0  0.400280  0.400280  4.003e-01    0.400280
## 33      0.33   0.391329    0  0.391329  0.391329  3.913e-01    0.391329
## 34      0.34   0.382107    0  0.382107  0.382107  3.821e-01    0.382107
## 35      0.35   0.372601    0  0.372601  0.372601  3.726e-01    0.372601
## 36      0.36   0.362798    0  0.366108  0.362798  3.628e-01    0.362798
## 37      0.37   0.352684    0  0.356127  0.352684  3.527e-01    0.359576
## 38      0.38   0.342243    0  0.345823  0.342243  3.422e-01    0.358381
## 39      0.39   0.331460    0  0.335182  0.331460  3.315e-01    0.352422
## 40      0.40   0.320318    0  0.324186  0.320318  3.203e-01    0.346536
## 41      0.41   0.308798    0  0.312817  0.308798  3.088e-01    0.340628
## 42      0.42   0.296880    0  0.301056  0.296880  2.969e-01    0.323984
## 43      0.43   0.284545    0  0.293226  0.288882  2.845e-01    0.261932
## 44      0.44   0.271769    0  0.280785  0.276274  2.718e-01    0.106312
## 45      0.45   0.258528    0  0.281988  0.263207  2.585e-01    0.030762
## 46      0.46   0.244797    0  0.268143  0.249656  2.448e-01   -0.003554
## 47      0.47   0.230548    0  0.255192  0.235594  2.305e-01   -0.003907
## 48      0.48   0.215751    0  0.235564  0.220991  2.158e-01   -0.004274
## 49      0.49   0.200374    0  0.222159  0.200401  2.004e-01   -0.004654
## 50      0.50   0.184381    0  0.208219  0.192280  1.844e-01   -0.005051
## 51      0.51   0.167736    0  0.188607  0.188147  1.677e-01   -0.005463
## 52      0.52   0.150397    0  0.179900  0.191764  1.504e-01   -0.005892
## 53      0.53   0.132321    0  0.143359  0.196648  1.323e-01   -0.006340
## 54      0.54   0.113458    0  0.130547  0.188115  1.135e-01   -0.006807
## 55      0.55   0.093757    0  0.114592  0.178321  1.006e-01   -0.007295
## 56      0.56   0.073161    0  0.119469  0.186532  7.628e-02   -0.007805
## 57      0.57   0.051606    0  0.110358  0.168285  5.685e-02   -0.013390
## 58      0.58   0.029025    0  0.122342  0.173578  4.513e-02   -0.013949
## 59      0.59   0.005343    0  0.108710  0.152219  7.915e-02   -0.014536
## 60      0.60  -0.019523    0  0.120401  0.137464  1.027e-01   -0.015152
## 61      0.61  -0.045665    0  0.104193  0.121952  1.123e-01   -0.015799
## 62      0.62  -0.073183    0  0.126171  0.114893  9.939e-02   -0.016481
## 63      0.63  -0.102187    0  0.110471  0.097397  7.674e-02   -0.017199
## 64      0.64  -0.132804    0  0.088312  0.083173  6.758e-02   -0.017957
## 65      0.65  -0.165170    0  0.080814  0.065348  4.930e-02    0.005051
## 66      0.66  -0.199439    0  0.067742  0.040888  5.184e-02    0.005051
## 67      0.67  -0.235786    0  0.021254  0.060695  2.668e-02    0.005051
## 68      0.68  -0.274404    0 -0.003867  0.060360  5.892e-03    0.005051
## 69      0.69  -0.315514    0 -0.030292  0.013827 -2.189e-02    0.005051
## 70      0.70  -0.359365    0 -0.029749  0.001500 -1.908e-02    0.005051
## 71      0.71  -0.406239    0 -0.043405 -0.014102 -4.298e-02    0.005051
## 72      0.72  -0.456462    0 -0.034443 -0.005057 -6.233e-02    0.005051
## 73      0.73  -0.510405    0 -0.013010  0.028918 -4.626e-02    0.005051
## 74      0.74  -0.568498    0  0.002684  0.054648  2.366e-02    0.005051
## 75      0.75  -0.631237    0 -0.011186  0.039056  4.242e-02    0.005051
## 76      0.76  -0.699206    0  0.021724  0.005281  5.410e-02    0.005051
## 77      0.77  -0.773084    0 -0.001723  0.005708  4.349e-02    0.005051
## 78      0.78  -0.853679    0  0.020819 -0.029554  3.193e-02    0.005051
## 79      0.79  -0.941949    0 -0.013414 -0.013414  1.926e-02          NA
## 80      0.80  -1.039047    0 -0.033238 -0.038041 -2.776e-17          NA
## 81      0.81  -1.146365    0 -0.058344 -0.057387 -2.076e-02          NA
## 82      0.82  -1.265608    0 -0.079374 -0.060394 -2.436e-02          NA
## 83      0.83  -1.398879    0 -0.083258 -0.083258 -4.724e-02          NA
## 84      0.84  -1.548808    0 -0.086287 -0.114478 -6.061e-02          NA
## 85      0.85  -1.718729    0 -0.093795 -0.149204 -1.010e-01          NA
## 86      0.86  -1.912924    0 -0.111267 -0.166404 -1.082e-02          NA
## 87      0.87  -2.136995    0 -0.155206 -0.133136         NA          NA
## 88      0.88  -2.398411    0 -0.156211 -0.195215         NA          NA
## 89      0.89  -2.707358    0 -0.066714 -0.194215         NA          NA
## 90      0.90  -3.078094    0 -0.070520 -0.181257         NA          NA
## 91      0.91  -3.531215    0 -0.129683 -0.245651         NA          NA
## 92      0.92  -4.097617    0 -0.053872 -0.071023         NA          NA
## 93      0.93  -4.825848    0 -0.068543 -0.050885         NA          NA
## 94      0.94  -5.796823    0 -0.028620 -0.025533         NA          NA
## 95      0.95  -7.156187    0        NA        NA         NA          NA
## 96      0.96  -9.195234    0        NA        NA         NA          NA
## 97      0.97 -12.593645    0        NA        NA         NA          NA
## 98      0.98 -19.390468    0        NA        NA         NA          NA
## 99      0.99 -39.780936    0        NA        NA         NA          NA
##    mskcc.post.2
## 1      0.588071
## 2      0.583868
## 3      0.579578
## 4      0.575199
## 5      0.570727
## 6      0.566160
## 7      0.561495
## 8      0.556729
## 9      0.551858
## 10     0.546878
## 11     0.541787
## 12     0.536580
## 13     0.531254
## 14     0.525803
## 15     0.520224
## 16     0.514513
## 17     0.508663
## 18     0.502672
## 19     0.496532
## 20     0.490238
## 21     0.483786
## 22     0.477167
## 23     0.470377
## 24     0.463409
## 25     0.456254
## 26     0.451087
## 27     0.443637
## 28     0.438366
## 29     0.435596
## 30     0.435683
## 31     0.425530
## 32     0.407691
## 33     0.396793
## 34     0.389643
## 35     0.377965
## 36     0.375035
## 37     0.367111
## 38     0.351077
## 39     0.331653
## 40     0.309274
## 41     0.289669
## 42     0.261943
## 43     0.249775
## 44     0.256111
## 45     0.210665
## 46     0.182000
## 47     0.188886
## 48     0.150492
## 49     0.135305
## 50     0.104494
## 51     0.096397
## 52     0.078417
## 53     0.061267
## 54     0.037378
## 55     0.002300
## 56     0.007896
## 57     0.002349
## 58    -0.005400
## 59    -0.007133
## 60     0.002841
## 61     0.009065
## 62     0.002481
## 63           NA
## 64           NA
## 65           NA
## 66           NA
## 67           NA
## 68           NA
## 69           NA
## 70           NA
## 71           NA
## 72           NA
## 73           NA
## 74           NA
## 75           NA
## 76           NA
## 77           NA
## 78           NA
## 79           NA
## 80           NA
## 81           NA
## 82           NA
## 83           NA
## 84           NA
## 85           NA
## 86           NA
## 87           NA
## 88           NA
## 89           NA
## 90           NA
## 91           NA
## 92           NA
## 93           NA
## 94           NA
## 95           NA
## 96           NA
## 97           NA
## 98           NA
## 99           NA
## 
## $interventions.avoided
##    threshold    gg.2     cph.2   rsf.2 mskcc.pre.2 mskcc.post.2
## 1       0.01  0.0000  0.000000  0.0000      0.0000      0.00000
## 2       0.02  0.0000  0.000000  0.0000      0.0000      0.00000
## 3       0.03  0.0000  0.000000  0.0000      0.0000      0.00000
## 4       0.04  0.0000  0.000000  0.0000      0.0000      0.00000
## 5       0.05  0.0000  0.000000  0.0000      0.0000      0.00000
## 6       0.06  0.0000  0.000000  0.0000      0.0000      0.00000
## 7       0.07  0.0000  0.000000  0.0000      0.0000      0.00000
## 8       0.08  0.0000  0.000000  0.0000      0.0000      0.00000
## 9       0.09  0.0000  0.000000  0.0000      0.0000      0.00000
## 10      0.10  0.0000  0.000000  0.0000      0.0000      0.00000
## 11      0.11  0.0000  0.000000  0.0000      0.0000      0.00000
## 12      0.12  0.0000  0.000000  0.0000      0.0000      0.00000
## 13      0.13  0.0000  0.000000  0.0000      0.0000      0.00000
## 14      0.14  0.0000  0.000000  0.0000      0.0000      0.00000
## 15      0.15  0.0000  0.000000  0.0000      0.0000      0.00000
## 16      0.16  0.0000  0.000000  0.0000      0.0000      0.00000
## 17      0.17  0.0000  0.000000  0.0000      0.0000      0.00000
## 18      0.18  0.0000  0.000000  0.0000      0.0000      0.00000
## 19      0.19  0.0000  0.000000  0.0000      0.0000      0.00000
## 20      0.20  0.0000  0.000000  0.0000      0.0000      0.00000
## 21      0.21  0.0000  0.000000  0.0000      0.0000      0.00000
## 22      0.22  0.0000  0.000000  0.0000      0.0000      0.00000
## 23      0.23  0.0000  0.000000  0.0000      0.0000      0.00000
## 24      0.24  0.0000  0.000000  0.0000      0.0000      0.00000
## 25      0.25  0.0000  0.000000  0.0000      0.0000      0.00000
## 26      0.26  0.0000  0.000000  0.0000      0.0000      0.62065
## 27      0.27  0.0000  0.000000  0.0000      0.0000      0.61636
## 28      0.28  0.0000  0.000000  0.0000      0.0000      1.22606
## 29      0.29  0.0000  0.000000  0.0000      0.0000      2.44225
## 30      0.30  0.0000  0.000000  0.0000      0.0000      4.26248
## 31      0.31  0.0000  0.000000  0.0000      0.0000      3.68553
## 32      0.32  0.0000  0.000000  0.0000      0.0000      1.57477
## 33      0.33  0.0000  0.000000  0.0000      0.0000      1.10936
## 34      0.34  0.0000  0.000000  0.0000      0.0000      1.46295
## 35      0.35  0.0000  0.000000  0.0000      0.0000      0.99618
## 36      0.36  0.5885  0.000000  0.0000      0.0000      2.17543
## 37      0.37  0.5863  0.000000  0.0000      1.1735      2.45650
## 38      0.38  0.5841  0.000000  0.0000      2.6330      1.44129
## 39      0.39  0.5821  0.000000  0.0000      3.2787      0.03024
## 40      0.40  0.5802  0.000000  0.0000      3.9327     -1.65649
## 41      0.41  0.5784  0.000000  0.0000      4.5804     -2.75266
## 42      0.42  0.5766  0.000000  0.0000      3.7429     -4.82473
## 43      0.43  1.1507  0.574945  0.0000     -2.9976     -4.60908
## 44      0.44  1.1475  0.573356  0.0000    -21.0582     -1.99279
## 45      0.45  2.8673  0.571839  0.0000    -27.8381     -5.84997
## 46      0.46  2.7405  0.570387  0.0000    -29.1543     -7.37192
## 47      0.47  2.7789  0.568997  0.0000    -26.4386     -4.69812
## 48      0.48  2.1464  0.567664  0.0000    -23.8360     -7.06973
## 49      0.49  2.2675  0.002862  0.0000    -21.3397     -6.77248
## 50      0.50  2.3838  0.789910  0.0000    -18.9432     -7.98875
## 51      0.51  2.0052  1.961045  0.0000    -16.6407     -6.85411
## 52      0.52  2.7233  3.818490  0.0000    -14.4267     -6.64428
## 53      0.53  0.9789  5.704531  0.0000    -12.2963     -6.30094
## 54      0.54  1.4557  6.359711  0.0000    -10.2448     -6.48092
## 55      0.55  1.7047  6.918893  0.5597     -8.2679     -7.48287
## 56      0.56  3.6385  8.907763  0.2450     -6.3616     -5.12797
## 57      0.57  4.4322  8.802098  0.3954     -4.9032     -3.71588
## 58      0.58  6.7574 10.467630  1.1661     -3.1119     -2.49289
## 59      0.59  7.1831 10.206621  5.1292     -1.3814     -0.86701
## 60      0.60  9.3283 10.465803  8.1489      0.2915      1.49095
## 61      0.61  9.5811 10.716488 10.0995      1.9095      3.49913
## 62      0.62 12.2184 11.527194 10.5768      3.4753      4.63744
## 63      0.63 12.4894 11.721641 10.5085      4.9914           NA
## 64      0.64 12.4378 12.148708 11.2714      6.4601           NA
## 65      0.65 13.2452 12.412465 11.5486      9.1657           NA
## 66      0.66 13.7639 12.380502 12.9445     10.5343           NA
## 67      0.67 12.6602 14.602808 12.9275     11.8621           NA
## 68      0.68 12.7312 15.753612 13.1904     13.1508           NA
## 69      0.69 12.8143 14.796466 13.1919     14.4022           NA
## 70      0.70 14.1264 15.465603 14.5838     15.6178           NA
## 71      0.71 14.8200 16.016865 14.8374     16.7992           NA
## 72      0.72 16.4118 17.554640 15.3273     17.9477           NA
## 73      0.73 18.3968 19.947577 17.1668     19.0648           NA
## 74      0.74 20.0685 21.894303 20.8057     20.1517           NA
## 75      0.75 20.6684 22.343120 22.4554     21.2096           NA
## 76      0.76 22.7662 22.246956 23.7885     22.2397           NA
## 77      0.77 23.0407 23.262610 24.3913     23.2430           NA
## 78      0.78 24.6653 23.244537 24.9786     24.2206           NA
## 79      0.79 24.6826 24.682572 25.5511          NA           NA
## 80      0.80 25.1452 25.025144 25.9762          NA           NA
## 81      0.81 25.5215 25.543936 26.4030          NA           NA
## 82      0.82 26.0393 26.455897 27.2469          NA           NA
## 83      0.83 26.9464 26.946449 27.6842          NA           NA
## 84      0.84 27.8576 27.320579 28.3467          NA           NA
## 85      0.85 28.6753 27.697503 28.5480          NA           NA
## 86      0.86 29.3293 28.431716 30.9644          NA           NA
## 87      0.87 29.6129 29.942720      NA          NA           NA
## 88      0.88 30.5755 30.043592      NA          NA           NA
## 89      0.89 32.6372 31.061317      NA          NA           NA
## 90      0.90 33.4175 32.187073      NA          NA           NA
## 91      0.91 33.6415 32.494590      NA          NA           NA
## 92      0.92 35.1630 35.013863      NA          NA           NA
## 93      0.93 35.8077 35.940583      NA          NA           NA
## 94      0.94 36.8183 36.838018      NA          NA           NA
## 95      0.95      NA        NA      NA          NA           NA
## 96      0.96      NA        NA      NA          NA           NA
## 97      0.97      NA        NA      NA          NA           NA
## 98      0.98      NA        NA      NA          NA           NA
## 99      0.99      NA        NA      NA          NA           NA
\end{verbatim}
\begin{alltt}
\hlkwd{stdca}\hlstd{(}\hlkwc{data} \hlstd{= temp.data,} \hlkwc{outcome} \hlstd{=} \hlstr{"DSD"}\hlstd{,} \hlkwc{ttoutcome} \hlstd{=} \hlstr{"Time"}\hlstd{,} \hlkwc{predictors} \hlstd{=} \hlkwd{c}\hlstd{(}\hlstr{"gg.3"}\hlstd{,} \hlstr{"cph.3"}\hlstd{,} \hlstr{"rsf.3"}\hlstd{,} \hlstr{"mskcc.pre.3"}\hlstd{,} \hlstr{"mskcc.post.3"}\hlstd{),} \hlkwc{timepoint} \hlstd{=} \hlnum{365}\hlopt{*}\hlnum{3}\hlstd{,} \hlkwc{probability} \hlstd{=} \hlkwd{rep}\hlstd{(}\hlnum{TRUE}\hlstd{,} \hlnum{5}\hlstd{))}
\end{alltt}
\begin{verbatim}
## [1] "rsf.3: No observations with risk greater than 94% that have followup through the timepoint selected, and therefore net benefit not calculable in this range."       
## [2] "mskcc.pre.3: No observations with risk greater than 91%, and therefore net benefit not calculable in this range."                                                   
## [3] "mskcc.post.3: No observations with risk greater than 78% that have followup through the timepoint selected, and therefore net benefit not calculable in this range."
\end{verbatim}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-model-selection-dca-3} 

}


\begin{kframe}\begin{verbatim}
## $N
## [1] 198
## 
## $predictors
##      predictor harm.applied probability
## 1         gg.3            0        TRUE
## 2        cph.3            0        TRUE
## 3        rsf.3            0        TRUE
## 4  mskcc.pre.3            0        TRUE
## 5 mskcc.post.3            0        TRUE
## 
## $interventions.avoided.per
## [1] 100
## 
## $net.benefit
##    threshold       all none       gg.3     cph.3    rsf.3 mskcc.pre.3
## 1       0.01   0.78021    0  0.7802107  0.780211  0.78021    0.780211
## 2       0.02   0.77797    0  0.7779679  0.777968  0.77797    0.777968
## 3       0.03   0.77568    0  0.7756789  0.775679  0.77568    0.775679
## 4       0.04   0.77334    0  0.7733423  0.773342  0.77334    0.773342
## 5       0.05   0.77096    0  0.7709564  0.770956  0.77096    0.770956
## 6       0.06   0.76852    0  0.7685198  0.768520  0.76852    0.768520
## 7       0.07   0.76603    0  0.7660307  0.766031  0.76603    0.766031
## 8       0.08   0.76349    0  0.7634876  0.763488  0.76349    0.763488
## 9       0.09   0.76089    0  0.7608885  0.760889  0.76089    0.760889
## 10      0.10   0.75823    0  0.7582317  0.758232  0.75823    0.758232
## 11      0.11   0.75552    0  0.7555152  0.755515  0.75552    0.755515
## 12      0.12   0.75274    0  0.7527370  0.752737  0.75274    0.752737
## 13      0.13   0.74989    0  0.7498949  0.749895  0.74989    0.749895
## 14      0.14   0.74699    0  0.7469867  0.746987  0.74699    0.746987
## 15      0.15   0.74401    0  0.7440101  0.744010  0.74401    0.744010
## 16      0.16   0.74096    0  0.7409626  0.740963  0.74096    0.740963
## 17      0.17   0.73784    0  0.7378416  0.737842  0.73784    0.737842
## 18      0.18   0.73464    0  0.7346446  0.734645  0.73464    0.734645
## 19      0.19   0.73137    0  0.7313686  0.731369  0.73137    0.731369
## 20      0.20   0.72801    0  0.7280107  0.728011  0.72801    0.728011
## 21      0.21   0.72457    0  0.7245678  0.724568  0.72457    0.724568
## 22      0.22   0.72104    0  0.7210366  0.721037  0.72104    0.721037
## 23      0.23   0.71741    0  0.7174137  0.717414  0.71741    0.717414
## 24      0.24   0.71370    0  0.7136955  0.713695  0.71370    0.713695
## 25      0.25   0.70988    0  0.7098781  0.709878  0.70988    0.709878
## 26      0.26   0.70596    0  0.7059575  0.705958  0.70596    0.705958
## 27      0.27   0.70193    0  0.7019295  0.701930  0.70193    0.701930
## 28      0.28   0.69779    0  0.6977897  0.697790  0.69779    0.697790
## 29      0.29   0.69353    0  0.6935332  0.693533  0.69353    0.693533
## 30      0.30   0.68916    0  0.6891551  0.689155  0.68916    0.689155
## 31      0.31   0.68465    0  0.6846501  0.684650  0.68465    0.684650
## 32      0.32   0.68001    0  0.6800126  0.680013  0.68001    0.680013
## 33      0.33   0.67524    0  0.6752367  0.675237  0.67524    0.675237
## 34      0.34   0.67032    0  0.6703160  0.670316  0.67032    0.670316
## 35      0.35   0.66524    0  0.6652440  0.665244  0.66524    0.665244
## 36      0.36   0.66001    0  0.6600134  0.660013  0.66001    0.660013
## 37      0.37   0.65462    0  0.6546168  0.654617  0.65462    0.654617
## 38      0.38   0.64905    0  0.6490461  0.649046  0.64905    0.649046
## 39      0.39   0.64329    0  0.6432927  0.643293  0.64329    0.643293
## 40      0.40   0.63735    0  0.6373476  0.637348  0.63735    0.637348
## 41      0.41   0.63120    0  0.6312010  0.631201  0.63120    0.631201
## 42      0.42   0.62484    0  0.6248424  0.624842  0.62484    0.624842
## 43      0.43   0.61826    0  0.6182606  0.618261  0.61826    0.618261
## 44      0.44   0.61144    0  0.6114439  0.611444  0.61144    0.611444
## 45      0.45   0.60438    0  0.6043792  0.604379  0.60438    0.604379
## 46      0.46   0.59705    0  0.5970529  0.597053  0.59705    0.597053
## 47      0.47   0.58945    0  0.5894501  0.589450  0.58945    0.589450
## 48      0.48   0.58155    0  0.5815549  0.581555  0.58155    0.581555
## 49      0.49   0.57335    0  0.5733501  0.573350  0.57335    0.573350
## 50      0.50   0.56482    0  0.5648171  0.564817  0.56482    0.564817
## 51      0.51   0.55594    0  0.5559359  0.555936  0.55594    0.552251
## 52      0.52   0.54668    0  0.5466845  0.546685  0.54668    0.545592
## 53      0.53   0.53704    0  0.5370395  0.537040  0.53704    0.523438
## 54      0.54   0.52698    0  0.5269751  0.526975  0.52698    0.521261
## 55      0.55   0.51646    0  0.5164635  0.516463  0.51646    0.519226
## 56      0.56   0.50547    0  0.5054740  0.505474  0.50547    0.509906
## 57      0.57   0.49397    0  0.4939734  0.493973  0.49397    0.450034
## 58      0.58   0.48193    0  0.4819252  0.481925  0.48193    0.328353
## 59      0.59   0.46929    0  0.4775790  0.469289  0.46929    0.059611
## 60      0.60   0.45602    0  0.4646447  0.456021  0.45602   -0.005051
## 61      0.61   0.44207    0  0.4510472  0.442073  0.44207   -0.010749
## 62      0.62   0.42739    0  0.4367340  0.427391  0.42739   -0.011430
## 63      0.63   0.41192    0  0.4216471  0.411915  0.41192   -0.012149
## 64      0.64   0.39558    0  0.4057220  0.405722  0.39558   -0.012907
## 65      0.65   0.37831    0  0.3888869  0.388800  0.37831   -0.013709
## 66      0.66   0.36003    0  0.3710616  0.371633  0.36003   -0.014557
## 67      0.67   0.34063    0  0.3467246  0.342592  0.34063   -0.015458
## 68      0.68   0.32003    0  0.3266254  0.323153  0.32003   -0.016414
## 69      0.69   0.29809    0  0.3069297  0.302460  0.29809   -0.017432
## 70      0.70   0.27470    0  0.2816345  0.340161  0.27470   -0.018519
## 71      0.71   0.24968    0  0.2584307  0.328239  0.24968   -0.019680
## 72      0.72   0.22289    0  0.2372995  0.305458  0.22289   -0.020924
## 73      0.73   0.19411    0  0.2160304  0.303169  0.19411   -0.027310
## 74      0.74   0.16311    0  0.1787583  0.280893  0.16311   -0.028749
## 75      0.75   0.12963    0  0.1392874  0.253058  0.12407   -0.030303
## 76      0.76   0.09337    0  0.2055040  0.237602  0.15564   -0.031987
## 77      0.77   0.05395    0  0.1971320  0.213238  0.15313   -0.033816
## 78      0.78   0.01095    0  0.1636030  0.186658  0.17634   -0.035813
## 79      0.79  -0.03615    0  0.1338344  0.161335  0.13245   -0.037999
## 80      0.80  -0.08796    0  0.1203056  0.130765  0.12380    0.005051
## 81      0.81  -0.14522    0  0.0878284  0.092755  0.07491    0.005051
## 82      0.82  -0.20884    0  0.0402560  0.051388  0.03049    0.005051
## 83      0.83  -0.27995    0  0.0001404  0.038204 -0.03738    0.005051
## 84      0.84  -0.35995    0 -0.0210826 -0.002653 -0.12190    0.005051
## 85      0.85  -0.45061    0 -0.0116849  0.077522 -0.10751    0.005051
## 86      0.86  -0.55422    0 -0.0040351  0.026376 -0.11323    0.005051
## 87      0.87  -0.67378    0 -0.0404039  0.086652 -0.03828    0.005051
## 88      0.88  -0.81326    0 -0.0012121  0.035482  0.12522    0.005051
## 89      0.89  -0.97810    0 -0.0514181 -0.062913  0.17426    0.005051
## 90      0.90  -1.17591    0  0.0108758  0.010876  0.10756    0.005051
## 91      0.91  -1.41768    0 -0.0104228 -0.010423  0.03487          NA
## 92      0.92  -1.71989    0 -0.0225291 -0.022897  0.06911          NA
## 93      0.93  -2.10845    0 -0.0134055 -0.013406  0.06659          NA
## 94      0.94  -2.62652    0 -0.0944959 -0.003571       NA          NA
## 95      0.95  -3.35183    0 -0.0107976  0.000000       NA          NA
## 96      0.96  -4.43979    0  0.0886918  0.032468       NA          NA
## 97      0.97  -6.25305    0 -0.0133051 -0.096509       NA          NA
## 98      0.98  -9.87957    0 -0.1305361 -0.082251       NA          NA
## 99      0.99 -20.75914    0 -0.4306220 -0.450758       NA          NA
##    mskcc.post.3
## 1      0.780211
## 2      0.777968
## 3      0.775679
## 4      0.773342
## 5      0.770956
## 6      0.768520
## 7      0.766031
## 8      0.763488
## 9      0.760889
## 10     0.758232
## 11     0.755515
## 12     0.752737
## 13     0.749895
## 14     0.746987
## 15     0.744010
## 16     0.740963
## 17     0.737842
## 18     0.734645
## 19     0.731369
## 20     0.728011
## 21     0.724568
## 22     0.721037
## 23     0.717414
## 24     0.713695
## 25     0.709878
## 26     0.705958
## 27     0.701930
## 28     0.697790
## 29     0.693533
## 30     0.689155
## 31     0.684650
## 32     0.680013
## 33     0.675237
## 34     0.670316
## 35     0.665244
## 36     0.660013
## 37     0.658248
## 38     0.652817
## 39     0.651133
## 40     0.649571
## 41     0.651851
## 42     0.655117
## 43     0.648430
## 44     0.627034
## 45     0.590163
## 46     0.575938
## 47     0.570415
## 48     0.561708
## 49     0.561741
## 50     0.550016
## 51     0.534803
## 52     0.519843
## 53     0.478884
## 54     0.454252
## 55     0.442167
## 56     0.413379
## 57     0.374308
## 58     0.343137
## 59     0.330506
## 60     0.280300
## 61     0.274222
## 62     0.228301
## 63     0.151937
## 64     0.158286
## 65     0.141877
## 66     0.121667
## 67     0.098262
## 68     0.074435
## 69     0.050033
## 70     0.007552
## 71     0.006941
## 72    -0.002202
## 73    -0.017770
## 74    -0.026171
## 75    -0.011111
## 76    -0.020202
## 77    -0.009076
## 78           NA
## 79           NA
## 80           NA
## 81           NA
## 82           NA
## 83           NA
## 84           NA
## 85           NA
## 86           NA
## 87           NA
## 88           NA
## 89           NA
## 90           NA
## 91           NA
## 92           NA
## 93           NA
## 94           NA
## 95           NA
## 96           NA
## 97           NA
## 98           NA
## 99           NA
## 
## $interventions.avoided
##    threshold    gg.3    cph.3   rsf.3 mskcc.pre.3 mskcc.post.3
## 1       0.01  0.0000  0.00000  0.0000     0.00000       0.0000
## 2       0.02  0.0000  0.00000  0.0000     0.00000       0.0000
## 3       0.03  0.0000  0.00000  0.0000     0.00000       0.0000
## 4       0.04  0.0000  0.00000  0.0000     0.00000       0.0000
## 5       0.05  0.0000  0.00000  0.0000     0.00000       0.0000
## 6       0.06  0.0000  0.00000  0.0000     0.00000       0.0000
## 7       0.07  0.0000  0.00000  0.0000     0.00000       0.0000
## 8       0.08  0.0000  0.00000  0.0000     0.00000       0.0000
## 9       0.09  0.0000  0.00000  0.0000     0.00000       0.0000
## 10      0.10  0.0000  0.00000  0.0000     0.00000       0.0000
## 11      0.11  0.0000  0.00000  0.0000     0.00000       0.0000
## 12      0.12  0.0000  0.00000  0.0000     0.00000       0.0000
## 13      0.13  0.0000  0.00000  0.0000     0.00000       0.0000
## 14      0.14  0.0000  0.00000  0.0000     0.00000       0.0000
## 15      0.15  0.0000  0.00000  0.0000     0.00000       0.0000
## 16      0.16  0.0000  0.00000  0.0000     0.00000       0.0000
## 17      0.17  0.0000  0.00000  0.0000     0.00000       0.0000
## 18      0.18  0.0000  0.00000  0.0000     0.00000       0.0000
## 19      0.19  0.0000  0.00000  0.0000     0.00000       0.0000
## 20      0.20  0.0000  0.00000  0.0000     0.00000       0.0000
## 21      0.21  0.0000  0.00000  0.0000     0.00000       0.0000
## 22      0.22  0.0000  0.00000  0.0000     0.00000       0.0000
## 23      0.23  0.0000  0.00000  0.0000     0.00000       0.0000
## 24      0.24  0.0000  0.00000  0.0000     0.00000       0.0000
## 25      0.25  0.0000  0.00000  0.0000     0.00000       0.0000
## 26      0.26  0.0000  0.00000  0.0000     0.00000       0.0000
## 27      0.27  0.0000  0.00000  0.0000     0.00000       0.0000
## 28      0.28  0.0000  0.00000  0.0000     0.00000       0.0000
## 29      0.29  0.0000  0.00000  0.0000     0.00000       0.0000
## 30      0.30  0.0000  0.00000  0.0000     0.00000       0.0000
## 31      0.31  0.0000  0.00000  0.0000     0.00000       0.0000
## 32      0.32  0.0000  0.00000  0.0000     0.00000       0.0000
## 33      0.33  0.0000  0.00000  0.0000     0.00000       0.0000
## 34      0.34  0.0000  0.00000  0.0000     0.00000       0.0000
## 35      0.35  0.0000  0.00000  0.0000     0.00000       0.0000
## 36      0.36  0.0000  0.00000  0.0000     0.00000       0.0000
## 37      0.37  0.0000  0.00000  0.0000     0.00000       0.6183
## 38      0.38  0.0000  0.00000  0.0000     0.00000       0.6153
## 39      0.39  0.0000  0.00000  0.0000     0.00000       1.2264
## 40      0.40  0.0000  0.00000  0.0000     0.00000       1.8335
## 41      0.41  0.0000  0.00000  0.0000     0.00000       2.9716
## 42      0.42  0.0000  0.00000  0.0000     0.00000       4.1808
## 43      0.43  0.0000  0.00000  0.0000     0.00000       3.9993
## 44      0.44  0.0000  0.00000  0.0000     0.00000       1.9842
## 45      0.45  0.0000  0.00000  0.0000     0.00000      -1.7375
## 46      0.46  0.0000  0.00000  0.0000     0.00000      -2.4787
## 47      0.47  0.0000  0.00000  0.0000     0.00000      -2.1466
## 48      0.48  0.0000  0.00000  0.0000     0.00000      -2.1501
## 49      0.49  0.0000  0.00000  0.0000     0.00000      -1.2083
## 50      0.50  0.0000  0.00000  0.0000     0.00000      -1.4801
## 51      0.51  0.0000  0.00000  0.0000    -0.35408      -2.0304
## 52      0.52  0.0000  0.00000  0.0000    -0.10088      -2.4777
## 53      0.53  0.0000  0.00000  0.0000    -1.20618      -5.1572
## 54      0.54  0.0000  0.00000  0.0000    -0.48675      -6.1950
## 55      0.55  0.0000  0.00000  0.0000     0.22599      -6.0788
## 56      0.56  0.0000  0.00000  0.0000     0.34822      -7.2360
## 57      0.57  0.0000  0.00000  0.0000    -3.31476      -9.0274
## 58      0.58  0.0000  0.00000  0.0000   -11.12074     -10.0502
## 59      0.59  0.5761  0.00000  0.0000   -28.46915      -9.6442
## 60      0.60  0.5749  0.00000  0.0000   -30.73813     -11.7148
## 61      0.61  0.5737  0.00000  0.0000   -28.95090     -10.7315
## 62      0.62  0.5726  0.00000  0.0000   -26.89548     -12.2023
## 63      0.63  0.5716  0.00000  0.0000   -24.90532     -15.2686
## 64      0.64  0.5705  0.57052  0.0000   -22.97735     -13.3477
## 65      0.65  0.5695  0.56485  0.0000   -21.10870     -12.7310
## 66      0.66  0.5685  0.59796  0.0000   -19.29668     -12.2790
## 67      0.67  0.3001  0.09654  0.0000   -17.53874     -11.9376
## 68      0.68  0.3105  0.14711  0.0000   -15.83251     -11.5573
## 69      0.69  0.3970  0.19622  0.0000   -14.17574     -11.1447
## 70      0.70  0.2974  2.80569  0.0000   -12.56630     -11.4490
## 71      0.71  0.3572  3.20856  0.0000   -11.00220      -9.9149
## 72      0.72  0.5605  3.21108  0.0000    -9.48155      -8.7535
## 73      0.73  0.8109  4.03386  0.0000    -8.18936      -7.8365
## 74      0.74  0.5498  4.13832  0.0000    -6.74099      -6.6504
## 75      0.75  0.3218  4.11414 -0.1853    -5.33124      -4.6915
## 76      0.76  3.5411  4.55472  1.9665    -3.95860      -3.5865
## 77      0.77  4.2769  4.75793  2.9625    -2.62160      -1.8826
## 78      0.78  4.3057  4.95593  4.6648    -1.31889           NA
## 79      0.79  4.5186  5.24959  4.4817    -0.04916           NA
## 80      0.80  5.2066  5.46806  5.2940     2.32519           NA
## 81      0.81  5.4665  5.58207  5.1635     3.52482           NA
## 82      0.82  5.4680  5.71235  5.2537     4.69519           NA
## 83      0.83  5.7368  6.51641  4.9683     5.83735           NA
## 84      0.84  6.4545  6.80559  4.5342     6.95232           NA
## 85      0.85  7.7457  9.31997  6.0546     8.04106           NA
## 86      0.86  8.9566  9.45164  7.1790     9.10448           NA
## 87      0.87  9.4642 11.36278  9.4960    10.14345           NA
## 88      0.88 11.0734 11.57379 12.7975    11.15881           NA
## 89      0.89 11.4534 11.31134 14.2427    12.15135           NA
## 90      0.90 13.1866 13.18656 14.2608    13.12183           NA
## 91      0.91 13.9180 13.91795 14.3659          NA           NA
## 92      0.92 14.7597 14.75649 15.5566          NA           NA
## 93      0.93 15.7691 15.76914 16.3713          NA           NA
## 94      0.94 16.1619 16.74225      NA          NA           NA
## 95      0.95 17.5844 17.64120      NA          NA           NA
## 96      0.96 18.8687 18.63439      NA          NA           NA
## 97      0.97 19.2982 19.04084      NA          NA           NA
## 98      0.98 19.8960 19.99453      NA          NA           NA
## 99      0.99 20.5339 20.51352      NA          NA           NA
\end{verbatim}
\end{kframe}
\end{knitrout}


\subsection{Brier score}
\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{calcIBS} \hlkwb{=} \hlkwa{function}\hlstd{(}\hlkwc{surv}\hlstd{,} \hlkwc{pred}\hlstd{,} \hlkwc{pred_times}\hlstd{,} \hlkwc{max_time}\hlstd{)}
\hlstd{\{}
        \hlkwd{stopifnot}\hlstd{(}\hlkwd{nrow}\hlstd{(surv)} \hlopt{==} \hlkwd{nrow}\hlstd{(pred)} \hlopt{&&} \hlkwd{length}\hlstd{(pred_times)} \hlopt{==} \hlkwd{ncol}\hlstd{(pred))}

        \hlstd{n} \hlkwb{=} \hlkwd{nrow}\hlstd{(surv)}
        \hlstd{marg_survfit} \hlkwb{=} \hlkwd{survfit}\hlstd{(surv} \hlopt{~} \hlnum{1}\hlstd{)}
        \hlstd{marg_censfit} \hlkwb{=} \hlkwd{survfit}\hlstd{(}\hlkwd{Surv}\hlstd{(surv[,}\hlnum{1}\hlstd{],} \hlopt{!}\hlstd{surv[,}\hlnum{2}\hlstd{])} \hlopt{~} \hlnum{1}\hlstd{)}
        \hlstd{marg_surv_func} \hlkwb{=} \hlkwd{approxfun}\hlstd{(marg_survfit}\hlopt{$}\hlstd{time, marg_survfit}\hlopt{$}\hlstd{surv,} \hlkwc{method} \hlstd{=} \hlstr{"constant"}\hlstd{,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlopt{:}\hlnum{1}\hlstd{,} \hlkwc{f} \hlstd{=} \hlnum{0}\hlstd{)}
        \hlstd{marg_cens_func} \hlkwb{=} \hlkwd{approxfun}\hlstd{(marg_censfit}\hlopt{$}\hlstd{time, marg_censfit}\hlopt{$}\hlstd{surv,} \hlkwc{method} \hlstd{=} \hlstr{"constant"}\hlstd{,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlopt{:}\hlnum{1}\hlstd{,} \hlkwc{f} \hlstd{=} \hlnum{0}\hlstd{)}

        \hlstd{pred_funcs} \hlkwb{=} \hlkwd{apply}\hlstd{(pred,} \hlnum{1}\hlstd{,} \hlkwa{function}\hlstd{(}\hlkwc{pat_preds}\hlstd{)} \hlkwd{approxfun}\hlstd{(pred_times, pat_preds,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlkwd{min}\hlstd{(pat_preds),} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{))}

        \hlstd{indiv_patient_bsc} \hlkwb{=} \hlkwa{function}\hlstd{(}\hlkwc{pat_i}\hlstd{,} \hlkwc{tstars}\hlstd{)}
        \hlstd{\{}
                \hlstd{observed_time} \hlkwb{=} \hlstd{surv[pat_i,} \hlnum{1}\hlstd{]}
                \hlstd{observed_event} \hlkwb{=} \hlstd{surv[pat_i,} \hlnum{2}\hlstd{]}
                \hlstd{pred_func} \hlkwb{=} \hlstd{pred_funcs[[pat_i]]}
                \hlstd{category} \hlkwb{=} \hlnum{1}\hlopt{*}\hlstd{(observed_time} \hlopt{<=} \hlstd{tstars} \hlopt{&} \hlstd{observed_event)} \hlopt{+} \hlnum{2}\hlopt{*}\hlstd{(observed_time} \hlopt{>} \hlstd{tstars)} \hlopt{+} \hlnum{3}\hlopt{*}\hlstd{(observed_time} \hlopt{<=} \hlstd{tstars} \hlopt{& !}\hlstd{observed_event)}
                \hlstd{bsc} \hlkwb{=} \hlkwd{rep}\hlstd{(}\hlnum{NA}\hlstd{,} \hlkwd{length}\hlstd{(tstars))}
                \hlstd{bsc[category} \hlopt{==} \hlnum{1}\hlstd{]} \hlkwb{=} \hlkwd{pred_func}\hlstd{(tstars[category} \hlopt{==} \hlnum{1}\hlstd{])}\hlopt{^}\hlnum{2} \hlopt{/} \hlkwd{marg_cens_func}\hlstd{(observed_time)}
                \hlstd{bsc[category} \hlopt{==} \hlnum{2}\hlstd{]} \hlkwb{=} \hlstd{(}\hlnum{1} \hlopt{-} \hlkwd{pred_func}\hlstd{(tstars[category} \hlopt{==} \hlnum{2}\hlstd{]))}\hlopt{^}\hlnum{2} \hlopt{/} \hlkwd{marg_cens_func}\hlstd{(tstars[category} \hlopt{==} \hlnum{2}\hlstd{])}
                \hlstd{bsc[category} \hlopt{==} \hlnum{3}\hlstd{]} \hlkwb{=} \hlnum{0}
                \hlstd{bsc}
        \hlstd{\}}

        \hlstd{bsc_func} \hlkwb{=} \hlkwa{function}\hlstd{(}\hlkwc{tstars}\hlstd{) \{} \hlkwd{rowMeans}\hlstd{(}\hlkwd{sapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlstd{n,} \hlkwa{function}\hlstd{(}\hlkwc{pat_i}\hlstd{)} \hlkwd{indiv_patient_bsc}\hlstd{(pat_i, tstars))) \}}

        \hlstd{weight_func} \hlkwb{=} \hlkwa{function}\hlstd{(}\hlkwc{tstars}\hlstd{) \{ (}\hlnum{1} \hlopt{-} \hlkwd{marg_surv_func}\hlstd{(tstars))} \hlopt{/} \hlstd{(}\hlnum{1} \hlopt{-} \hlkwd{marg_surv_func}\hlstd{(max_time)) \}}

        \hlcom{# Be slack and do trapezoidal int. with a fine grid.  It should be possible }
        \hlcom{# to calulate the int. exactly but I cbfed.}
        \hlstd{int_grid} \hlkwb{=} \hlkwd{seq}\hlstd{(}\hlnum{0}\hlstd{, max_time,} \hlkwc{length.out} \hlstd{=} \hlnum{1e3}\hlstd{)}
        \hlstd{bsc_vals} \hlkwb{=} \hlkwd{bsc_func}\hlstd{(int_grid)}
        \hlstd{weight_vals} \hlkwb{=} \hlkwd{weight_func}\hlstd{(int_grid)}
        \hlstd{int_vals} \hlkwb{=} \hlstd{bsc_vals} \hlopt{*} \hlstd{weight_vals}
        \hlstd{ibsc} \hlkwb{=} \hlstd{(}\hlnum{2}\hlopt{*}\hlkwd{sum}\hlstd{(int_vals)} \hlopt{-} \hlstd{int_vals[}\hlnum{1}\hlstd{]} \hlopt{-} \hlstd{int_vals[}\hlkwd{length}\hlstd{(int_vals)])} \hlopt{*} \hlstd{(}\hlkwd{diff}\hlstd{(}\hlkwd{range}\hlstd{(int_grid)))} \hlopt{/} \hlstd{(}\hlnum{2}\hlopt{*}\hlkwd{length}\hlstd{(int_vals))}

        \hlkwd{return}\hlstd{(}\hlkwd{list}\hlstd{(}\hlkwc{bsc} \hlstd{= bsc_vals,} \hlkwc{weights} \hlstd{= weight_vals,} \hlkwc{eval_times} \hlstd{= int_grid,} \hlkwc{ibsc} \hlstd{= ibsc))}
\hlstd{\}}

\hlstd{calcBSsingle} \hlkwb{=} \hlkwa{function}\hlstd{(}\hlkwc{surv}\hlstd{,} \hlkwc{pred}\hlstd{,} \hlkwc{pred_time}\hlstd{)}
\hlstd{\{}
        \hlstd{n} \hlkwb{=} \hlkwd{nrow}\hlstd{(surv)}
        \hlstd{obs_time} \hlkwb{=} \hlstd{surv[,}\hlnum{1}\hlstd{]}
        \hlstd{obs_event} \hlkwb{=} \hlstd{surv[,}\hlnum{2}\hlstd{]}
        \hlstd{marg_censfit} \hlkwb{=} \hlkwd{survfit}\hlstd{(}\hlkwd{Surv}\hlstd{(obs_time,} \hlopt{!}\hlstd{obs_event)} \hlopt{~} \hlnum{1}\hlstd{)}
        \hlstd{marg_cens_func} \hlkwb{=} \hlkwd{approxfun}\hlstd{(marg_censfit}\hlopt{$}\hlstd{time, marg_censfit}\hlopt{$}\hlstd{surv,} \hlkwc{method} \hlstd{=} \hlstr{"constant"}\hlstd{,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{yright} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlopt{:}\hlnum{1}\hlstd{,} \hlkwc{f} \hlstd{=} \hlnum{0}\hlstd{)}

        \hlstd{brier_val} \hlkwb{=} \hlkwd{rep}\hlstd{(}\hlnum{NA}\hlstd{, n)}
        \hlstd{cat} \hlkwb{=} \hlnum{1}\hlopt{*}\hlkwd{I}\hlstd{(obs_time} \hlopt{<=} \hlstd{pred_time} \hlopt{&} \hlstd{obs_event)} \hlopt{+} \hlnum{2}\hlopt{*}\hlkwd{I}\hlstd{(obs_time} \hlopt{>} \hlstd{pred_time)} \hlopt{+} \hlnum{3}\hlopt{*}\hlkwd{I}\hlstd{(obs_time} \hlopt{<=} \hlstd{pred_time} \hlopt{& !}\hlstd{obs_event)}
        \hlstd{brier_val[cat} \hlopt{==} \hlnum{1}\hlstd{]} \hlkwb{=} \hlstd{(pred[cat} \hlopt{==} \hlnum{1}\hlstd{])}\hlopt{^}\hlnum{2} \hlopt{/} \hlkwd{marg_cens_func}\hlstd{(obs_time[cat} \hlopt{==} \hlnum{1}\hlstd{])}
        \hlstd{brier_val[cat} \hlopt{==} \hlnum{2}\hlstd{]} \hlkwb{=} \hlstd{(}\hlnum{1}\hlopt{-}\hlstd{pred[cat} \hlopt{==} \hlnum{2}\hlstd{])}\hlopt{^}\hlnum{2} \hlopt{/} \hlkwd{marg_cens_func}\hlstd{(pred_time)}
        \hlstd{brier_val[cat} \hlopt{==} \hlnum{3}\hlstd{]} \hlkwb{=} \hlnum{0}

        \hlkwd{mean}\hlstd{(brier_val)}
\hlstd{\}}
\end{alltt}
\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{mskcc_post.12mo.glasgow.brier} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD), mskcc_post.12mo.glasgow,} \hlnum{12}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
\hlstd{mskcc_post.24mo.glasgow.brier} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD), mskcc_post.24mo.glasgow,} \hlnum{24}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
\hlstd{mskcc_post.36mo.glasgow.brier} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD), mskcc_post.36mo.glasgow,} \hlnum{36}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
\hlstd{mskcc_pre.12mo.glasgow.brier} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD), mskcc_pre.12mo.glasgow,} \hlnum{12}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
\hlstd{mskcc_pre.24mo.glasgow.brier} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD), mskcc_pre.24mo.glasgow,} \hlnum{24}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
\hlstd{mskcc_pre.36mo.glasgow.brier} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD), mskcc_pre.36mo.glasgow,} \hlnum{36}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
\hlstd{gg.path.glasgow.brier} \hlkwb{=} \hlkwd{calcIBS}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD),} \hlkwd{t}\hlstd{(}\hlkwd{sapply}\hlstd{(gg.path.glasgow,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) x[,}\hlnum{2}\hlstd{])), gg.path.glasgow[[}\hlnum{1}\hlstd{]][,}\hlnum{1}\hlstd{],} \hlnum{10}\hlopt{*}\hlnum{365.25}\hlstd{)}

\hlstd{km0.path.glasgow.brier} \hlkwb{=} \hlkwd{calcIBS}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD),} \hlkwd{matrix}\hlstd{(fit.km0}\hlopt{$}\hlstd{surv,} \hlkwc{nrow} \hlstd{=} \hlkwd{nrow}\hlstd{(data.glasgow),} \hlkwc{ncol} \hlstd{=} \hlkwd{length}\hlstd{(fit.km0}\hlopt{$}\hlstd{time),} \hlkwc{byrow} \hlstd{=} \hlnum{TRUE}\hlstd{), fit.km0}\hlopt{$}\hlstd{time,} \hlnum{10}\hlopt{*}\hlnum{365.25}\hlstd{)}

\hlstd{temp.cph.pred} \hlkwb{=} \hlkwd{survfit}\hlstd{(fit.cph,} \hlkwc{newdata} \hlstd{= data.glasgow)}
\hlstd{temp.cph.pred.expanded_strata} \hlkwb{=} \hlkwd{rep}\hlstd{(}\hlkwd{names}\hlstd{(temp.cph.pred}\hlopt{$}\hlstd{strata), temp.cph.pred}\hlopt{$}\hlstd{strata)}
\hlstd{temp.cph.pred_funcs} \hlkwb{=} \hlkwd{sapply}\hlstd{(}\hlkwd{rownames}\hlstd{(data.glasgow),} \hlkwa{function}\hlstd{(}\hlkwc{pat_id}\hlstd{) \{}
        \hlkwd{approxfun}\hlstd{(temp.cph.pred}\hlopt{$}\hlstd{time[temp.cph.pred.expanded_strata} \hlopt{==} \hlstd{pat_id], temp.cph.pred}\hlopt{$}\hlstd{surv[temp.cph.pred.expanded_strata} \hlopt{==} \hlstd{pat_id],} \hlkwc{method} \hlstd{=} \hlstr{"constant"}\hlstd{,} \hlkwc{f} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}
\hlstd{\})}
\hlstd{cph.path.glasgow.brier} \hlkwb{=} \hlkwd{calcIBS}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD),}
        \hlkwd{t}\hlstd{(}\hlkwd{sapply}\hlstd{(temp.cph.pred_funcs[}\hlkwd{rownames}\hlstd{(data.glasgow)],} \hlkwa{function}\hlstd{(}\hlkwc{f}\hlstd{)} \hlkwd{f}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{12}\hlstd{,} \hlnum{24}\hlstd{,} \hlnum{36}\hlstd{)}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{))),} \hlkwd{c}\hlstd{(}\hlnum{12}\hlstd{,} \hlnum{24}\hlstd{,} \hlnum{36}\hlstd{)}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{,} \hlnum{10}\hlopt{*}\hlnum{365.25}\hlstd{)}

\hlstd{gg2.path.glasgow.brier} \hlkwb{=} \hlkwd{calcIBS}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD),} \hlkwd{t}\hlstd{(}\hlkwd{sapply}\hlstd{(gg2.path.glasgow,} \hlkwa{function}\hlstd{(}\hlkwc{x}\hlstd{) x[,}\hlnum{2}\hlstd{])), gg2.path.glasgow[[}\hlnum{1}\hlstd{]][,}\hlnum{1}\hlstd{],} \hlnum{10}\hlopt{*}\hlnum{365.25}\hlstd{)}

\hlstd{temp.rsf.pred} \hlkwb{=} \hlkwd{predict}\hlstd{(fit.rsf,} \hlkwc{newdata} \hlstd{= data.glasgow)}
\hlstd{rsf.path.glasgow.brier} \hlkwb{=} \hlkwd{calcIBS}\hlstd{(}\hlkwd{Surv}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time, data.glasgow}\hlopt{$}\hlstd{DSD),} \hlkwd{t}\hlstd{(}\hlkwd{apply}\hlstd{(temp.rsf.pred}\hlopt{$}\hlstd{survival,} \hlnum{1}\hlstd{,} \hlkwa{function}\hlstd{(}\hlkwc{patpreds}\hlstd{)} \hlkwd{approx}\hlstd{(temp.rsf.pred}\hlopt{$}\hlstd{time.interest, patpreds,} \hlkwd{c}\hlstd{(}\hlnum{12}\hlstd{,} \hlnum{24}\hlstd{,} \hlnum{36}\hlstd{)}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}\hlopt{$}\hlstd{y)),} \hlkwd{c}\hlstd{(}\hlnum{12}\hlstd{,} \hlnum{24}\hlstd{,} \hlnum{36}\hlstd{)}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{,} \hlnum{10}\hlopt{*}\hlnum{365.25}\hlstd{)}

\hlkwd{plot}\hlstd{(gg.path.glasgow.brier}\hlopt{$}\hlstd{bsc} \hlopt{~} \hlstd{gg.path.glasgow.brier}\hlopt{$}\hlstd{eval_times,} \hlkwc{col} \hlstd{=} \hlstr{"aquamarine"}\hlstd{,} \hlkwc{type} \hlstd{=} \hlstr{"l"}\hlstd{,} \hlkwc{ylim} \hlstd{=} \hlkwd{c}\hlstd{(}\hlnum{0}\hlstd{,} \hlnum{0.3}\hlstd{),} \hlkwc{xlab} \hlstd{=} \hlstr{"Time from diagnosis"}\hlstd{,} \hlkwc{ylab} \hlstd{=} \hlstr{"Brier score"}\hlstd{)}
\hlkwd{lines}\hlstd{(km0.path.glasgow.brier}\hlopt{$}\hlstd{bsc} \hlopt{~} \hlstd{km0.path.glasgow.brier}\hlopt{$}\hlstd{eval_times,} \hlkwc{col} \hlstd{=} \hlstr{"grey"}\hlstd{)}
\hlkwd{lines}\hlstd{(cph.path.glasgow.brier}\hlopt{$}\hlstd{bsc} \hlopt{~} \hlstd{cph.path.glasgow.brier}\hlopt{$}\hlstd{eval_times,} \hlkwc{col} \hlstd{=} \hlstr{"pink"}\hlstd{)}
\hlkwd{lines}\hlstd{(gg2.path.glasgow.brier}\hlopt{$}\hlstd{bsc} \hlopt{~} \hlstd{gg2.path.glasgow.brier}\hlopt{$}\hlstd{eval_times,} \hlkwc{col} \hlstd{=} \hlstr{"purple"}\hlstd{)}
\hlkwd{lines}\hlstd{(rsf.path.glasgow.brier}\hlopt{$}\hlstd{bsc} \hlopt{~} \hlstd{rsf.path.glasgow.brier}\hlopt{$}\hlstd{eval_times,} \hlkwc{col} \hlstd{=} \hlstr{"green"}\hlstd{)}
\hlkwd{points}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{12}\hlstd{,} \hlnum{24}\hlstd{,} \hlnum{36}\hlstd{)}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{,} \hlkwd{c}\hlstd{(mskcc_post.12mo.glasgow.brier, mskcc_post.24mo.glasgow.brier, mskcc_post.36mo.glasgow.brier),} \hlkwc{col} \hlstd{=} \hlstr{"red"}\hlstd{,} \hlkwc{cex} \hlstd{=} \hlnum{1}\hlstd{)}
\hlkwd{points}\hlstd{(}\hlkwd{c}\hlstd{(}\hlnum{12}\hlstd{,} \hlnum{24}\hlstd{,} \hlnum{36}\hlstd{)}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{,} \hlkwd{c}\hlstd{(mskcc_pre.12mo.glasgow.brier, mskcc_pre.24mo.glasgow.brier, mskcc_pre.36mo.glasgow.brier),} \hlkwc{col} \hlstd{=} \hlstr{"blue"}\hlstd{,} \hlkwc{cex} \hlstd{=} \hlnum{1}\hlstd{)}
\hlkwd{abline}\hlstd{(}\hlkwc{h} \hlstd{=} \hlnum{0.25}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"grey"}\hlstd{,} \hlkwc{lty} \hlstd{=} \hlstr{"dotted"}\hlstd{)}
\hlkwd{legend}\hlstd{(}\hlstr{"topright"}\hlstd{,}
        \hlkwc{legend} \hlstd{=} \hlkwd{c}\hlstd{(}     \hlstr{"GG1 Preop"}\hlstd{,}    \hlstr{"GG2 Preop"}\hlstd{,}    \hlstr{"CP1 Preop"}\hlstd{,}    \hlstr{"RSF Preop"}\hlstd{,}    \hlstr{"KM0"}\hlstd{,}          \hlstr{"MSKCC Postop"}\hlstd{,}         \hlstr{"MSKCC Preop"}\hlstd{),}
        \hlkwc{pch} \hlstd{=} \hlkwd{c}\hlstd{(}        \hlnum{NA}\hlstd{,}                     \hlnum{NA}\hlstd{,}                     \hlnum{NA}\hlstd{,}                     \hlnum{NA}\hlstd{,}                     \hlnum{NA}\hlstd{,}             \hlnum{1}\hlstd{,}                                      \hlnum{1}\hlstd{),}
        \hlkwc{col} \hlstd{=} \hlkwd{c}\hlstd{(}        \hlstr{"aquamarine"}\hlstd{,}   \hlstr{"purple"}\hlstd{,}               \hlstr{"pink"}\hlstd{,}                 \hlstr{"green"}\hlstd{,}                \hlstr{"grey"}\hlstd{,}         \hlstr{"red"}\hlstd{,}                          \hlstr{"blue"}\hlstd{),}
        \hlkwc{lty} \hlstd{=} \hlkwd{c}\hlstd{(}        \hlstr{"solid"}\hlstd{,}                \hlstr{"solid"}\hlstd{,}                \hlstr{"solid"}\hlstd{,}                \hlstr{"solid"}\hlstd{,}                \hlstr{"solid"}\hlstd{,}        \hlnum{NA}\hlstd{,}                             \hlnum{NA}\hlstd{),}
        \hlkwc{inset} \hlstd{=} \hlnum{0.05}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-prob-bs-paths-1} 

}



\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{probs_bs_boot_func} \hlkwb{=} \hlkwa{function}\hlstd{(}\hlkwc{d}\hlstd{,} \hlkwc{i}\hlstd{) \{}
        \hlstd{bs.mskcc.postop.12} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]), mskcc_post.12mo.glasgow[i],} \hlnum{12}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
        \hlstd{bs.mskcc.postop.24} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]), mskcc_post.24mo.glasgow[i],} \hlnum{24}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
        \hlstd{bs.mskcc.postop.36} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]), mskcc_post.36mo.glasgow[i],} \hlnum{36}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
        \hlstd{bs.mskcc.preop.12} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]), mskcc_pre.12mo.glasgow[i],} \hlnum{12}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
        \hlstd{bs.mskcc.preop.24} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]), mskcc_pre.24mo.glasgow[i],} \hlnum{24}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
        \hlstd{bs.mskcc.preop.36} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]), mskcc_pre.36mo.glasgow[i],} \hlnum{36}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}

        \hlstd{bs.gg.vals} \hlkwb{=} \hlkwd{t}\hlstd{(}\hlkwd{sapply}\hlstd{(gg.path.glasgow[i],} \hlkwa{function}\hlstd{(}\hlkwc{path}\hlstd{)} \hlkwd{approx}\hlstd{(path[,}\hlnum{1}\hlstd{], path[,}\hlnum{2}\hlstd{],} \hlkwd{c}\hlstd{(}\hlnum{12}\hlstd{,} \hlnum{24}\hlstd{,} \hlnum{36}\hlstd{)}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}\hlopt{$}\hlstd{y))}
        \hlkwd{rownames}\hlstd{(bs.gg.vals)} \hlkwb{<-} \hlkwa{NULL}
        \hlstd{bs.gg.12} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]), bs.gg.vals[,}\hlnum{1}\hlstd{],} \hlnum{12}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
        \hlstd{bs.gg.24} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]), bs.gg.vals[,}\hlnum{2}\hlstd{],} \hlnum{24}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
        \hlstd{bs.gg.36} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]), bs.gg.vals[,}\hlnum{3}\hlstd{],} \hlnum{36}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}

        \hlstd{cph.pred} \hlkwb{=} \hlkwd{survfit}\hlstd{(fit.cph,} \hlkwc{newdata} \hlstd{= d[i,])}
        \hlstd{cph.pred.expanded_strata} \hlkwb{=} \hlkwd{rep}\hlstd{(}\hlkwd{names}\hlstd{(cph.pred}\hlopt{$}\hlstd{strata), cph.pred}\hlopt{$}\hlstd{strata)}
        \hlstd{cph.pred_funcs} \hlkwb{=} \hlkwd{sapply}\hlstd{(}\hlkwd{rownames}\hlstd{(d)[i],} \hlkwa{function}\hlstd{(}\hlkwc{pat_id}\hlstd{) \{}
                \hlkwd{approxfun}\hlstd{(cph.pred}\hlopt{$}\hlstd{time[cph.pred.expanded_strata} \hlopt{==} \hlstd{pat_id], cph.pred}\hlopt{$}\hlstd{surv[cph.pred.expanded_strata} \hlopt{==} \hlstd{pat_id],} \hlkwc{method} \hlstd{=} \hlstr{"constant"}\hlstd{,} \hlkwc{f} \hlstd{=} \hlnum{0}\hlstd{,} \hlkwc{yleft} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{rule} \hlstd{=} \hlnum{2}\hlstd{)}
        \hlstd{\})}
        \hlstd{bs.cph.12} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]),} \hlkwd{sapply}\hlstd{(}\hlkwd{rownames}\hlstd{(d)[i],} \hlkwa{function}\hlstd{(}\hlkwc{pat_id}\hlstd{) cph.pred_funcs[[pat_id]](}\hlnum{12}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)),} \hlnum{12}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
        \hlstd{bs.cph.24} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]),} \hlkwd{sapply}\hlstd{(}\hlkwd{rownames}\hlstd{(d)[i],} \hlkwa{function}\hlstd{(}\hlkwc{pat_id}\hlstd{) cph.pred_funcs[[pat_id]](}\hlnum{24}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)),} \hlnum{24}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
        \hlstd{bs.cph.36} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]),} \hlkwd{sapply}\hlstd{(}\hlkwd{rownames}\hlstd{(d)[i],} \hlkwa{function}\hlstd{(}\hlkwc{pat_id}\hlstd{) cph.pred_funcs[[pat_id]](}\hlnum{36}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)),} \hlnum{36}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}

        \hlstd{bs.km0.vals} \hlkwb{=} \hlkwd{approx}\hlstd{(fit.km0}\hlopt{$}\hlstd{time, fit.km0}\hlopt{$}\hlstd{surv,} \hlkwd{c}\hlstd{(}\hlnum{12}\hlstd{,} \hlnum{24}\hlstd{,} \hlnum{36}\hlstd{)}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}\hlopt{$}\hlstd{y}
        \hlstd{bs.km0.12} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]),} \hlkwd{rep}\hlstd{(bs.km0.vals[}\hlnum{1}\hlstd{],} \hlkwd{nrow}\hlstd{(d[i,])),} \hlnum{12}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
        \hlstd{bs.km0.24} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]),} \hlkwd{rep}\hlstd{(bs.km0.vals[}\hlnum{2}\hlstd{],} \hlkwd{nrow}\hlstd{(d[i,])),} \hlnum{24}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}
        \hlstd{bs.km0.36} \hlkwb{=} \hlkwd{calcBSsingle}\hlstd{(}\hlkwd{Surv}\hlstd{(d}\hlopt{$}\hlstd{Time[i], d}\hlopt{$}\hlstd{DSD[i]),} \hlkwd{rep}\hlstd{(bs.km0.vals[}\hlnum{3}\hlstd{],} \hlkwd{nrow}\hlstd{(d[i,])),} \hlnum{36}\hlopt{/}\hlnum{12}\hlopt{*}\hlnum{365.25}\hlstd{)}

        \hlstd{result} \hlkwb{=} \hlkwd{c}\hlstd{(}
                \hlstd{bs.cph.12} \hlopt{-} \hlstd{bs.km0.12,                  bs.gg.12} \hlopt{-} \hlstd{bs.km0.12,                   bs.mskcc.postop.12} \hlopt{-} \hlstd{bs.km0.12,                 bs.mskcc.preop.12} \hlopt{-} \hlstd{bs.km0.12,}
                \hlstd{bs.cph.12} \hlopt{-} \hlstd{bs.mskcc.preop.12,  bs.gg.12} \hlopt{-} \hlstd{bs.mskcc.preop.12,   bs.mskcc.postop.12} \hlopt{-} \hlstd{bs.mskcc.preop.12,}
                \hlstd{bs.cph.12} \hlopt{-} \hlstd{bs.mskcc.postop.12, bs.gg.12} \hlopt{-} \hlstd{bs.mskcc.postop.12,}
                \hlstd{bs.cph.12} \hlopt{-} \hlstd{bs.gg.12,}
                \hlstd{bs.cph.24} \hlopt{-} \hlstd{bs.km0.24,                  bs.gg.24} \hlopt{-} \hlstd{bs.km0.24,                   bs.mskcc.postop.24} \hlopt{-} \hlstd{bs.km0.24,                 bs.mskcc.preop.24} \hlopt{-} \hlstd{bs.km0.24,}
                \hlstd{bs.cph.24} \hlopt{-} \hlstd{bs.mskcc.preop.24,  bs.gg.24} \hlopt{-} \hlstd{bs.mskcc.preop.24,   bs.mskcc.postop.24} \hlopt{-} \hlstd{bs.mskcc.preop.24,}
                \hlstd{bs.cph.24} \hlopt{-} \hlstd{bs.mskcc.postop.24, bs.gg.24} \hlopt{-} \hlstd{bs.mskcc.postop.24,}
                \hlstd{bs.cph.24} \hlopt{-} \hlstd{bs.gg.24,}
                \hlstd{bs.cph.36} \hlopt{-} \hlstd{bs.km0.36,                  bs.gg.36} \hlopt{-} \hlstd{bs.km0.36,                   bs.mskcc.postop.36} \hlopt{-} \hlstd{bs.km0.36,                 bs.mskcc.preop.36} \hlopt{-} \hlstd{bs.km0.36,}
                \hlstd{bs.cph.36} \hlopt{-} \hlstd{bs.mskcc.preop.36,  bs.gg.36} \hlopt{-} \hlstd{bs.mskcc.preop.36,   bs.mskcc.postop.36} \hlopt{-} \hlstd{bs.mskcc.preop.36,}
                \hlstd{bs.cph.36} \hlopt{-} \hlstd{bs.mskcc.postop.36, bs.gg.36} \hlopt{-} \hlstd{bs.mskcc.postop.36,}
                \hlstd{bs.cph.36} \hlopt{-} \hlstd{bs.gg.36)}
        \hlkwd{names}\hlstd{(result)} \hlkwb{<-} \hlkwa{NULL}
        \hlstd{result}
\hlstd{\}}

\hlkwd{set.seed}\hlstd{(}\hlnum{20150113}\hlstd{)}
\hlstd{deltaBrier.boot.glasgow} \hlkwb{=} \hlkwd{boot}\hlstd{(data.glasgow, probs_bs_boot_func,} \hlkwc{R} \hlstd{=} \hlnum{500}\hlstd{)}
\hlstd{deltaBrier.boot.glasgow.cis} \hlkwb{=} \hlkwd{t}\hlstd{(}\hlkwd{sapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{ncol}\hlstd{(deltaBrier.boot.glasgow}\hlopt{$}\hlstd{t),} \hlkwa{function}\hlstd{(}\hlkwc{i}\hlstd{)} \hlkwd{boot.ci}\hlstd{(deltaBrier.boot.glasgow,} \hlkwc{index} \hlstd{= i,} \hlkwc{type} \hlstd{=} \hlstr{"bca"}\hlstd{)}\hlopt{$}\hlstd{bca))}
\hlkwd{colnames}\hlstd{(deltaBrier.boot.glasgow.cis)} \hlkwb{=} \hlkwd{c}\hlstd{(}\hlstr{"level"}\hlstd{,} \hlstr{"lowindex"}\hlstd{,} \hlstr{"highindex"}\hlstd{,} \hlstr{"lci"}\hlstd{,} \hlstr{"uci"}\hlstd{)}
\hlkwd{rownames}\hlstd{(deltaBrier.boot.glasgow.cis)} \hlkwb{=} \hlkwd{c}\hlstd{(}
        \hlstr{"12:cph-km0"}\hlstd{,} \hlstr{"12:gg-km0"}\hlstd{,} \hlstr{"12:post-km0"}\hlstd{,} \hlstr{"12:pre-km0"}\hlstd{,} \hlstr{"12:cph-pre"}\hlstd{,} \hlstr{"12:gg-pre"}\hlstd{,} \hlstr{"12:post-pre"}\hlstd{,} \hlstr{"12:cph-post"}\hlstd{,} \hlstr{"12:gg-post"}\hlstd{,} \hlstr{"12:cph-gg"}\hlstd{,}
        \hlstr{"24:cph-km0"}\hlstd{,} \hlstr{"24:gg-km0"}\hlstd{,} \hlstr{"24:post-km0"}\hlstd{,} \hlstr{"24:pre-km0"}\hlstd{,} \hlstr{"24:cph-pre"}\hlstd{,} \hlstr{"24:gg-pre"}\hlstd{,} \hlstr{"24:post-pre"}\hlstd{,} \hlstr{"24:cph-post"}\hlstd{,} \hlstr{"24:gg-post"}\hlstd{,} \hlstr{"24:cph-gg"}\hlstd{,}
        \hlstr{"36:cph-km0"}\hlstd{,} \hlstr{"36:gg-km0"}\hlstd{,} \hlstr{"36:post-km0"}\hlstd{,} \hlstr{"36:pre-km0"}\hlstd{,} \hlstr{"36:cph-pre"}\hlstd{,} \hlstr{"36:gg-pre"}\hlstd{,} \hlstr{"36:post-pre"}\hlstd{,} \hlstr{"36:cph-post"}\hlstd{,} \hlstr{"36:gg-post"}\hlstd{,} \hlstr{"36:cph-gg"}\hlstd{)}
\hlstd{deltaBrier.boot.glasgow}
\end{alltt}
\begin{verbatim}
## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = data.glasgow, statistic = probs_bs_boot_func, R = 500)
## 
## 
## Bootstrap Statistics :
##        original     bias    std. error
## t1*  -0.0130382 -1.278e-03    0.010921
## t2*  -0.0208299 -1.331e-03    0.010856
## t3*   0.0030229 -1.048e-03    0.014649
## t4*   0.0071877 -6.540e-04    0.014936
## t5*  -0.0202259 -6.241e-04    0.020579
## t6*  -0.0280176 -6.772e-04    0.020104
## t7*  -0.0041648 -3.935e-04    0.003150
## t8*  -0.0160610 -2.306e-04    0.020244
## t9*  -0.0238528 -2.837e-04    0.019807
## t10*  0.0077917  5.317e-05    0.002251
## t11* -0.0290212 -3.938e-04    0.010006
## t12* -0.0251333 -4.869e-04    0.010542
## t13*  0.0003272 -2.070e-03    0.020468
## t14*  0.0154723 -1.459e-03    0.020306
## t15* -0.0444935  1.065e-03    0.021024
## t16* -0.0406056  9.717e-04    0.021454
## t17* -0.0151451 -6.114e-04    0.005561
## t18* -0.0293483  1.676e-03    0.021050
## t19* -0.0254605  1.583e-03    0.021577
## t20* -0.0038878  9.305e-05    0.002469
## t21* -0.0163245 -5.644e-04    0.006933
## t22* -0.0116616 -4.838e-04    0.005960
## t23*  0.0228894 -2.116e-03    0.018865
## t24*  0.0363296 -1.423e-03    0.017841
## t25* -0.0526541  8.583e-04    0.016262
## t26* -0.0479912  9.390e-04    0.017138
## t27* -0.0134401 -6.928e-04    0.005662
## t28* -0.0392139  1.551e-03    0.017154
## t29* -0.0345511  1.632e-03    0.018066
## t30* -0.0046628 -8.062e-05    0.002300
\end{verbatim}
\begin{alltt}
\hlstd{deltaBrier.boot.glasgow.cis}
\end{alltt}
\begin{verbatim}
##             level lowindex highindex        lci        uci
## 12:cph-km0   0.95    28.17     496.2 -0.0306390  0.0126239
## 12:gg-km0    0.95    27.07     495.9 -0.0386989  0.0035527
## 12:post-km0  0.95    21.80     494.4 -0.0233188  0.0366841
## 12:pre-km0   0.95    19.02     493.1 -0.0194999  0.0417737
## 12:cph-pre   0.95    11.12     487.0 -0.0659784  0.0196067
## 12:gg-pre    0.95    10.50     486.2 -0.0728125  0.0076840
## 12:post-pre  0.95    16.63     491.5 -0.0106143  0.0016693
## 12:cph-post  0.95    11.34     487.2 -0.0611593  0.0230695
## 12:gg-post   0.95    12.09     488.1 -0.0678988  0.0138256
## 12:cph-gg    0.95     8.50     483.1  0.0031365  0.0116653
## 24:cph-km0   0.95    16.86     491.9 -0.0496742 -0.0066401
## 24:gg-km0    0.95    14.09     489.9 -0.0463578 -0.0036625
## 24:post-km0  0.95    19.05     492.9 -0.0396312  0.0446312
## 24:pre-km0   0.95    16.51     491.6 -0.0237494  0.0585698
## 24:cph-pre   0.95     8.82     483.3 -0.0884392 -0.0059322
## 24:gg-pre    0.95     9.66     484.8 -0.0829245  0.0007140
## 24:post-pre  0.95    27.60     496.0 -0.0242163 -0.0011646
## 24:cph-post  0.95     8.92     483.5 -0.0719628  0.0116053
## 24:gg-post   0.95     9.78     485.0 -0.0682419  0.0166928
## 24:cph-gg    0.95    10.28     485.8 -0.0091586  0.0007611
## 36:cph-km0   0.95    20.08     493.2 -0.0291930 -0.0025001
## 36:gg-km0    0.95    15.48     490.8 -0.0235981  0.0004294
## 36:post-km0  0.95    18.10     492.3 -0.0149899  0.0608984
## 36:pre-km0   0.95    12.30     488.3  0.0007022  0.0701983
## 36:cph-pre   0.95    12.83     488.8 -0.0843222 -0.0196427
## 36:gg-pre    0.95    11.32     487.1 -0.0822648 -0.0128795
## 36:post-pre  0.95    22.31     494.5 -0.0242015 -0.0017397
## 36:cph-post  0.95    11.06     486.7 -0.0714961 -0.0032602
## 36:gg-post   0.95    10.48     485.9 -0.0687059  0.0006778
## 36:cph-gg    0.95    10.73     486.6 -0.0091047 -0.0005594
\end{verbatim}
\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{temp.time} \hlkwb{=} \hlkwd{gsub}\hlstd{(}\hlstr{":.*"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{rownames}\hlstd{(deltaBrier.boot.glasgow.cis))}
\hlstd{temp.methodpos} \hlkwb{=} \hlkwd{gsub}\hlstd{(}\hlstr{".*:"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{gsub}\hlstd{(}\hlstr{"-.*"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{rownames}\hlstd{(deltaBrier.boot.glasgow.cis)))}
\hlstd{temp.methodneg} \hlkwb{=} \hlkwd{gsub}\hlstd{(}\hlstr{".*-"}\hlstd{,} \hlstr{""}\hlstd{,} \hlkwd{rownames}\hlstd{(deltaBrier.boot.glasgow.cis))}
\hlstd{temp.methods} \hlkwb{=} \hlkwd{sort}\hlstd{(}\hlkwd{unique}\hlstd{(}\hlkwd{c}\hlstd{(temp.methodpos, temp.methodneg)))}
\hlkwd{tapply}\hlstd{(}\hlnum{1}\hlopt{:}\hlkwd{length}\hlstd{(temp.time), temp.time,} \hlkwa{function}\hlstd{(}\hlkwc{is}\hlstd{) \{}
        \hlstd{res} \hlkwb{=} \hlkwd{matrix}\hlstd{(}\hlnum{0}\hlstd{,} \hlkwc{nrow} \hlstd{=} \hlkwd{length}\hlstd{(temp.methods),} \hlkwc{ncol} \hlstd{=} \hlkwd{length}\hlstd{(temp.methods))}
        \hlkwd{rownames}\hlstd{(res)} \hlkwb{=} \hlstd{temp.methods}
        \hlkwd{colnames}\hlstd{(res)} \hlkwb{=} \hlstd{temp.methods}
        \hlcom{# Make res signed.  0 => NS.  +1 => row is better than col (BS_row - BS_col < 0).  -1 => row is worse than col (BS_row - BS_col > 0).}
        \hlstd{res[}\hlkwd{cbind}\hlstd{(temp.methodpos[is], temp.methodneg[is])]} \hlkwb{=} \hlstd{(}\hlkwd{sign}\hlstd{(deltaBrier.boot.glasgow.cis[is,} \hlstr{"uci"}\hlstd{])} \hlopt{==} \hlkwd{sign}\hlstd{(deltaBrier.boot.glasgow.cis[is,} \hlstr{"lci"}\hlstd{]))} \hlopt{*} \hlkwd{sign}\hlstd{(}\hlopt{-}\hlstd{deltaBrier.boot.glasgow.cis[is,} \hlstr{"uci"}\hlstd{])}
        \hlstd{res[}\hlkwd{cbind}\hlstd{(temp.methodneg[is], temp.methodpos[is])]} \hlkwb{=} \hlstd{(}\hlkwd{sign}\hlstd{(deltaBrier.boot.glasgow.cis[is,} \hlstr{"uci"}\hlstd{])} \hlopt{==} \hlkwd{sign}\hlstd{(deltaBrier.boot.glasgow.cis[is,} \hlstr{"lci"}\hlstd{]))} \hlopt{*} \hlkwd{sign}\hlstd{(deltaBrier.boot.glasgow.cis[is,} \hlstr{"uci"}\hlstd{])}
        \hlstd{res}
\hlstd{\})}
\end{alltt}
\begin{verbatim}
## $`12`
##      cph gg km0 post pre
## cph    0 -1   0    0   0
## gg     1  0   0    0   0
## km0    0  0   0    0   0
## post   0  0   0    0   0
## pre    0  0   0    0   0
## 
## $`24`
##      cph gg km0 post pre
## cph    0  0   1    0   1
## gg     0  0   1    0   0
## km0   -1 -1   0    0   0
## post   0  0   0    0   1
## pre   -1  0   0   -1   0
## 
## $`36`
##      cph gg km0 post pre
## cph    0  1   1    1   1
## gg    -1  0   0    0   1
## km0   -1  0   0    0   1
## post  -1  0   0    0   1
## pre   -1 -1  -1   -1   0
\end{verbatim}
\end{kframe}
\end{knitrout}


\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlstd{mskcc_pre.cdroc.glasgow} \hlkwb{=} \hlkwd{timeROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{, data.glasgow}\hlopt{$}\hlstd{DSD, mskcc_pre.linpred.glasgow,} \hlkwc{cause} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{times} \hlstd{=} \hlkwd{seq}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{36}\hlstd{,} \hlnum{1}\hlstd{),} \hlkwc{iid} \hlstd{=} \hlnum{TRUE}\hlstd{)}
\hlstd{mskcc_post.cdroc.glasgow} \hlkwb{=} \hlkwd{timeROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{, data.glasgow}\hlopt{$}\hlstd{DSD, mskcc_post.linpred.glasgow,} \hlkwc{cause} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{times} \hlstd{=} \hlkwd{seq}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{36}\hlstd{,} \hlnum{1}\hlstd{),} \hlkwc{iid} \hlstd{=} \hlnum{TRUE}\hlstd{)}
\hlstd{gg.cdroc.glasgow} \hlkwb{=} \hlkwd{timeROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{, data.glasgow}\hlopt{$}\hlstd{DSD, gg.linpred.glasgow,} \hlkwc{cause} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{times} \hlstd{=} \hlkwd{seq}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{36}\hlstd{,} \hlnum{1}\hlstd{),} \hlkwc{iid} \hlstd{=} \hlnum{TRUE}\hlstd{)}
\hlstd{gg2.cdroc.glasgow} \hlkwb{=} \hlkwd{timeROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{, data.glasgow}\hlopt{$}\hlstd{DSD, gg2.linpred.glasgow,} \hlkwc{cause} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{times} \hlstd{=} \hlkwd{seq}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{36}\hlstd{,} \hlnum{1}\hlstd{),} \hlkwc{iid} \hlstd{=} \hlnum{TRUE}\hlstd{)}
\hlstd{cph.cdroc.glasgow} \hlkwb{=} \hlkwd{timeROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{, data.glasgow}\hlopt{$}\hlstd{DSD, cph.linpred.glasgow,} \hlkwc{cause} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{times} \hlstd{=} \hlkwd{seq}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{36}\hlstd{,} \hlnum{1}\hlstd{),} \hlkwc{iid} \hlstd{=} \hlnum{TRUE}\hlstd{)}
\hlstd{rsf.cdroc.glasgow} \hlkwb{=} \hlkwd{timeROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{, data.glasgow}\hlopt{$}\hlstd{DSD, rsf.linpred.glasgow,} \hlkwc{cause} \hlstd{=} \hlnum{1}\hlstd{,} \hlkwc{times} \hlstd{=} \hlkwd{seq}\hlstd{(}\hlnum{1}\hlstd{,} \hlnum{36}\hlstd{,} \hlnum{1}\hlstd{),} \hlkwc{iid} \hlstd{=} \hlnum{TRUE}\hlstd{)}
\hlkwd{plotAUCcurve}\hlstd{(mskcc_pre.cdroc.glasgow,} \hlkwc{conf.int} \hlstd{=} \hlnum{FALSE}\hlstd{,} \hlkwc{add} \hlstd{=} \hlnum{FALSE}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"blue"}\hlstd{)}
\hlkwd{plotAUCcurve}\hlstd{(mskcc_post.cdroc.glasgow,} \hlkwc{conf.int} \hlstd{=} \hlnum{FALSE}\hlstd{,} \hlkwc{add} \hlstd{=} \hlnum{TRUE}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"black"}\hlstd{)}
\hlkwd{plotAUCcurve}\hlstd{(gg.cdroc.glasgow,} \hlkwc{conf.int} \hlstd{=} \hlnum{FALSE}\hlstd{,} \hlkwc{add} \hlstd{=} \hlnum{TRUE}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"aquamarine"}\hlstd{)}
\hlkwd{plotAUCcurve}\hlstd{(gg2.cdroc.glasgow,} \hlkwc{conf.int} \hlstd{=} \hlnum{FALSE}\hlstd{,} \hlkwc{add} \hlstd{=} \hlnum{TRUE}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"purple"}\hlstd{)}
\hlkwd{plotAUCcurve}\hlstd{(cph.cdroc.glasgow,} \hlkwc{conf.int} \hlstd{=} \hlnum{FALSE}\hlstd{,} \hlkwc{add} \hlstd{=} \hlnum{TRUE}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"pink"}\hlstd{)}
\hlkwd{plotAUCcurve}\hlstd{(rsf.cdroc.glasgow,} \hlkwc{conf.int} \hlstd{=} \hlnum{FALSE}\hlstd{,} \hlkwc{add} \hlstd{=} \hlnum{TRUE}\hlstd{,} \hlkwc{col} \hlstd{=} \hlstr{"green"}\hlstd{)}
\hlkwd{legend}\hlstd{(}\hlstr{"topright"}\hlstd{,} \hlkwc{legend} \hlstd{=} \hlkwd{c}\hlstd{(}\hlstr{"Glasgow Preop"}\hlstd{,} \hlstr{"Glasgow Postop"}\hlstd{,} \hlstr{"GG"}\hlstd{,} \hlstr{"GG2"}\hlstd{,} \hlstr{"CPH"}\hlstd{,} \hlstr{"RSF"}\hlstd{),} \hlkwc{col} \hlstd{=} \hlkwd{c}\hlstd{(}\hlstr{"blue"}\hlstd{,} \hlstr{"black"}\hlstd{,} \hlstr{"aquamarine"}\hlstd{,} \hlstr{"purple"}\hlstd{,} \hlstr{"pink"}\hlstd{,} \hlstr{"green"}\hlstd{),} \hlkwc{lty} \hlstd{=} \hlstr{"solid"}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-timeROC-1} 

}



\end{knitrout}

\begin{knitrout}
\definecolor{shadecolor}{rgb}{0.969, 0.969, 0.969}\color{fgcolor}\begin{kframe}
\begin{alltt}
\hlkwd{risksetROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= mskcc_pre.linpred.glasgow,} \hlkwc{predict.time} \hlstd{=} \hlnum{12}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-1} 

}


\begin{kframe}\begin{verbatim}
## $marker
##   [1] -0.09676 -0.08538 -0.07023 -0.07019 -0.06997 -0.06977 -0.06961
##   [8] -0.06958 -0.06955 -0.06950 -0.06947 -0.06928 -0.06917 -0.06916
##  [15] -0.06910 -0.06904 -0.06896 -0.06895 -0.06894 -0.06888 -0.06884
##  [22] -0.06884 -0.06881 -0.06876 -0.06867 -0.06867 -0.06865 -0.06864
##  [29] -0.06860 -0.06860 -0.06859 -0.06859 -0.06856 -0.06856 -0.06855
##  [36] -0.06854 -0.06852 -0.06851 -0.06851 -0.06850 -0.06848 -0.06844
##  [43] -0.06839 -0.06831 -0.06831 -0.06830 -0.06826 -0.06826 -0.06824
##  [50] -0.06823 -0.06823 -0.06823 -0.06823 -0.06823 -0.06822 -0.06821
##  [57] -0.06819 -0.06817 -0.06814 -0.06812 -0.06807 -0.06805 -0.06799
##  [64] -0.06797 -0.06797 -0.06797 -0.06790 -0.06787 -0.06787 -0.06778
##  [71] -0.06775 -0.06772 -0.06755 -0.06752 -0.06752 -0.06750 -0.06748
##  [78] -0.06748 -0.06746 -0.06744 -0.06743 -0.06743 -0.06731 -0.06725
##  [85] -0.06723 -0.06723 -0.06721 -0.06715 -0.06713 -0.06710 -0.06710
##  [92] -0.06709 -0.06704 -0.06704 -0.06703 -0.06703 -0.06703 -0.06703
##  [99] -0.06695 -0.06689 -0.06688 -0.06688 -0.06687 -0.06687 -0.06685
## [106] -0.06680 -0.06675 -0.06670 -0.06669 -0.06662 -0.06658 -0.06512
## [113] -0.06443 -0.06388 -0.06340 -0.06317 -0.06315 -0.06312 -0.06263
## [120] -0.06246 -0.06235 -0.06222 -0.06208 -0.06185
## 
## $TP
##   [1] 1.000000 0.992165 0.984240 0.976194 0.968148 0.960100 0.952051
##   [8] 0.944000 0.935949 0.927898 0.919846 0.911794 0.903741 0.895686
##  [15] 0.887632 0.879577 0.871522 0.863466 0.855409 0.847353 0.839297
##  [22] 0.831240 0.823183 0.815125 0.807068 0.799009 0.790951 0.782893
##  [29] 0.774834 0.766775 0.758716 0.750657 0.742598 0.734539 0.726480
##  [36] 0.718420 0.710361 0.702301 0.694242 0.686182 0.678122 0.670062
##  [43] 0.662002 0.653942 0.645880 0.637819 0.629758 0.621696 0.613634
##  [50] 0.605573 0.597511 0.589449 0.581387 0.573325 0.565263 0.557201
##  [57] 0.549139 0.541077 0.533014 0.524952 0.516889 0.508826 0.500762
##  [64] 0.492698 0.484635 0.476571 0.468507 0.460442 0.452377 0.444312
##  [71] 0.436247 0.428181 0.420115 0.412048 0.403980 0.395912 0.387845
##  [78] 0.379777 0.371709 0.363641 0.355572 0.347504 0.339436 0.331366
##  [85] 0.323296 0.315226 0.307156 0.299086 0.291016 0.282945 0.274874
##  [92] 0.266803 0.258732 0.250660 0.242589 0.234517 0.226446 0.218374
##  [99] 0.210303 0.202230 0.194158 0.186085 0.178012 0.169939 0.161866
## [106] 0.153793 0.145720 0.137646 0.129572 0.121498 0.113423 0.105347
## [113] 0.097260 0.089168 0.081071 0.072970 0.064867 0.056764 0.048661
## [120] 0.040554 0.032445 0.024336 0.016225 0.008114 0.000000 0.000000
## 
## $FP
##   [1] 1.000000 0.991935 0.983871 0.975806 0.967742 0.959677 0.951613
##   [8] 0.943548 0.935484 0.927419 0.919355 0.911290 0.903226 0.895161
##  [15] 0.887097 0.879032 0.870968 0.862903 0.854839 0.846774 0.838710
##  [22] 0.830645 0.822581 0.814516 0.806452 0.798387 0.790323 0.782258
##  [29] 0.774194 0.766129 0.758065 0.750000 0.741935 0.733871 0.725806
##  [36] 0.717742 0.709677 0.701613 0.693548 0.685484 0.677419 0.669355
##  [43] 0.661290 0.653226 0.645161 0.637097 0.629032 0.620968 0.612903
##  [50] 0.604839 0.596774 0.588710 0.580645 0.572581 0.564516 0.556452
##  [57] 0.548387 0.540323 0.532258 0.524194 0.516129 0.508065 0.500000
##  [64] 0.491935 0.483871 0.475806 0.467742 0.459677 0.451613 0.443548
##  [71] 0.435484 0.427419 0.419355 0.411290 0.403226 0.395161 0.387097
##  [78] 0.379032 0.370968 0.362903 0.354839 0.346774 0.338710 0.330645
##  [85] 0.322581 0.314516 0.306452 0.298387 0.290323 0.282258 0.274194
##  [92] 0.266129 0.258065 0.250000 0.241935 0.233871 0.225806 0.217742
##  [99] 0.209677 0.201613 0.193548 0.185484 0.177419 0.169355 0.161290
## [106] 0.153226 0.145161 0.137097 0.129032 0.120968 0.112903 0.104839
## [113] 0.096774 0.088710 0.080645 0.072581 0.064516 0.056452 0.048387
## [120] 0.040323 0.032258 0.024194 0.016129 0.008065 0.000000 0.000000
## 
## $AUC
## [1] 0.5006
\end{verbatim}
\begin{alltt}
\hlkwd{risksetROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= mskcc_post.linpred.glasgow,} \hlkwc{predict.time} \hlstd{=} \hlnum{12}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-2} 

}


\begin{kframe}\begin{verbatim}
## $marker
##   [1] 1.734 1.808 1.847 1.877 1.890 1.899 1.901 1.933 1.945 1.953 1.955
##  [12] 1.980 1.984 1.990 2.001 2.009 2.009 2.012 2.016 2.032 2.033 2.086
##  [23] 2.099 2.113 2.136 2.152 2.165 2.182 2.208 2.210 2.224 2.225 2.227
##  [34] 2.229 2.233 2.240 2.245 2.248 2.252 2.259 2.261 2.286 2.295 2.320
##  [45] 2.324 2.331 2.335 2.337 2.341 2.341 2.342 2.347 2.348 2.355 2.379
##  [56] 2.379 2.382 2.384 2.388 2.403 2.404 2.415 2.425 2.426 2.427 2.437
##  [67] 2.451 2.464 2.471 2.474 2.477 2.481 2.485 2.491 2.493 2.495 2.496
##  [78] 2.499 2.515 2.515 2.515 2.521 2.524 2.524 2.527 2.527 2.529 2.531
##  [89] 2.533 2.538 2.541 2.545 2.548 2.548 2.555 2.558 2.564 2.567 2.572
## [100] 2.572 2.604 2.650 2.656 2.656 2.669 2.679 2.685 2.710 2.711 2.714
## [111] 2.717 2.718 2.721 2.726 2.742 2.766 2.779 2.806 2.850 2.860 2.883
## [122] 2.884 2.895 2.938
## 
## $TP
##   [1] 1.00000 0.99594 0.99156 0.98701 0.98232 0.97757 0.97278 0.96798
##   [9] 0.96302 0.95801 0.95295 0.94788 0.94269 0.93747 0.93222 0.92691
##  [17] 0.92156 0.91621 0.91085 0.90546 0.89999 0.89451 0.88873 0.88288
##  [25] 0.87695 0.87087 0.86471 0.85845 0.85209 0.84557 0.83903 0.83240
##  [33] 0.82576 0.81911 0.81244 0.80575 0.79901 0.79224 0.78544 0.77862
##  [41] 0.77175 0.76487 0.75782 0.75070 0.74340 0.73607 0.72869 0.72127
##  [49] 0.71385 0.70640 0.69894 0.69148 0.68398 0.67648 0.66892 0.66118
##  [57] 0.65343 0.64566 0.63788 0.63007 0.62214 0.61419 0.60616 0.59806
##  [65] 0.58994 0.58181 0.57361 0.56529 0.55686 0.54837 0.53986 0.53132
##  [73] 0.52275 0.51413 0.50547 0.49679 0.48810 0.47939 0.47066 0.46179
##  [81] 0.45292 0.44405 0.43513 0.42618 0.41723 0.40825 0.39927 0.39027
##  [89] 0.38126 0.37223 0.36315 0.35404 0.34490 0.33573 0.32657 0.31734
##  [97] 0.30808 0.29875 0.28940 0.28001 0.27062 0.26092 0.25077 0.24056
## [105] 0.23035 0.22000 0.20955 0.19903 0.18825 0.17745 0.16663 0.15577
## [113] 0.14490 0.13400 0.12305 0.11191 0.10051 0.08895 0.07709 0.06469
## [121] 0.05217 0.03935 0.02651 0.01354 0.00000 0.00000
## 
## $FP
##   [1] 1.000000 0.991935 0.983871 0.975806 0.967742 0.959677 0.951613
##   [8] 0.943548 0.935484 0.927419 0.919355 0.911290 0.903226 0.895161
##  [15] 0.887097 0.879032 0.870968 0.862903 0.854839 0.846774 0.838710
##  [22] 0.830645 0.822581 0.814516 0.806452 0.798387 0.790323 0.782258
##  [29] 0.774194 0.766129 0.758065 0.750000 0.741935 0.733871 0.725806
##  [36] 0.717742 0.709677 0.701613 0.693548 0.685484 0.677419 0.669355
##  [43] 0.661290 0.653226 0.645161 0.637097 0.629032 0.620968 0.612903
##  [50] 0.604839 0.596774 0.588710 0.580645 0.572581 0.564516 0.556452
##  [57] 0.548387 0.540323 0.532258 0.524194 0.516129 0.508065 0.500000
##  [64] 0.491935 0.483871 0.475806 0.467742 0.459677 0.451613 0.443548
##  [71] 0.435484 0.427419 0.419355 0.411290 0.403226 0.395161 0.387097
##  [78] 0.379032 0.370968 0.362903 0.354839 0.346774 0.338710 0.330645
##  [85] 0.322581 0.314516 0.306452 0.298387 0.290323 0.282258 0.274194
##  [92] 0.266129 0.258065 0.250000 0.241935 0.233871 0.225806 0.217742
##  [99] 0.209677 0.201613 0.193548 0.185484 0.177419 0.169355 0.161290
## [106] 0.153226 0.145161 0.137097 0.129032 0.120968 0.112903 0.104839
## [113] 0.096774 0.088710 0.080645 0.072581 0.064516 0.056452 0.048387
## [120] 0.040323 0.032258 0.024194 0.016129 0.008065 0.000000 0.000000
## 
## $AUC
## [1] 0.5743
\end{verbatim}
\begin{alltt}
\hlkwd{risksetROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= gg.linpred.glasgow,} \hlkwc{predict.time} \hlstd{=} \hlnum{12}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-3} 

}


\begin{kframe}\begin{verbatim}
## $marker
##   [1] -0.467684 -0.371761 -0.346182 -0.346182 -0.346182 -0.339787 -0.339787
##   [8] -0.307812 -0.307812 -0.307812 -0.307812 -0.307812 -0.307812 -0.307812
##  [15] -0.275838 -0.275838 -0.263048 -0.243864 -0.243864 -0.243864 -0.243864
##  [22] -0.211889 -0.206711 -0.147941 -0.142762 -0.142762 -0.110788 -0.097998
##  [29] -0.095923 -0.095923 -0.083133 -0.078814 -0.078814 -0.078814 -0.078814
##  [36] -0.072419 -0.063949 -0.063949 -0.046839 -0.046839 -0.046839 -0.046839
##  [43] -0.046839 -0.040444 -0.034049 -0.031974 -0.031974 -0.031974 -0.031974
##  [50] -0.025580 -0.014865 -0.014865 -0.014865 -0.012790  0.000000  0.000000
##  [57]  0.000000  0.000000  0.006395  0.031974  0.031974  0.031974  0.031974
##  [64]  0.049084  0.049084  0.081058  0.081058  0.140687  0.153779  0.158957
##  [71]  0.184235  0.184235  0.190630  0.197024  0.197024  0.197024  0.203721
##  [78]  0.222604  0.222906  0.222906  0.228999  0.228999  0.228999  0.228999
##  [85]  0.248184  0.254880  0.254880  0.260973  0.260973  0.260973  0.260973
##  [92]  0.260973  0.260973  0.260973  0.269745  0.286855  0.286855  0.286855
##  [99]  0.286855  0.288930  0.292948  0.318829  0.324922  0.324922  0.324922
## [106]  0.350803  0.388871  0.429617  0.452820  0.466770  0.466770  0.492349
## [113]  0.524324  0.530718  0.530718  0.530718  0.530718  0.549903  0.562693
## [120]  0.562693  0.594667  0.594667  0.594667  0.594667
## 
## $TP
##   [1] 1.00000 0.99552 0.99060 0.98554 0.98049 0.97543 0.97035 0.96526
##   [9] 0.96001 0.95476 0.94950 0.94425 0.93900 0.93375 0.92849 0.92307
##  [17] 0.91765 0.91216 0.90656 0.90096 0.89536 0.88976 0.88398 0.87817
##  [25] 0.87201 0.86581 0.85962 0.85322 0.84674 0.84025 0.83376 0.82718
##  [33] 0.82058 0.81398 0.80737 0.80077 0.79412 0.78742 0.78072 0.77390
##  [41] 0.76708 0.76026 0.75344 0.74662 0.73976 0.73286 0.72594 0.71902
##  [49] 0.71209 0.70517 0.69821 0.69117 0.68413 0.67709 0.67004 0.66289
##  [57] 0.65574 0.64860 0.64145 0.63426 0.62689 0.61951 0.61213 0.60475
##  [65] 0.59725 0.58974 0.58199 0.57425 0.56602 0.55769 0.54931 0.54072
##  [73] 0.53213 0.52348 0.51478 0.50608 0.49738 0.48862 0.47969 0.47076
##  [81] 0.46183 0.45285 0.44387 0.43488 0.42590 0.41674 0.40752 0.39830
##  [89] 0.38902 0.37975 0.37047 0.36120 0.35192 0.34264 0.33337 0.32401
##  [97] 0.31449 0.30497 0.29545 0.28593 0.27639 0.26682 0.25699 0.24710
## [105] 0.23721 0.22732 0.21718 0.20663 0.19565 0.18442 0.17302 0.16162
## [113] 0.14993 0.13786 0.12572 0.11357 0.10142 0.08927 0.07689 0.06434
## [121] 0.05180 0.03885 0.02590 0.01295 0.00000 0.00000
## 
## $FP
##   [1] 1.000000 0.991935 0.983871 0.975806 0.967742 0.959677 0.951613
##   [8] 0.943548 0.935484 0.927419 0.919355 0.911290 0.903226 0.895161
##  [15] 0.887097 0.879032 0.870968 0.862903 0.854839 0.846774 0.838710
##  [22] 0.830645 0.822581 0.814516 0.806452 0.798387 0.790323 0.782258
##  [29] 0.774194 0.766129 0.758065 0.750000 0.741935 0.733871 0.725806
##  [36] 0.717742 0.709677 0.701613 0.693548 0.685484 0.677419 0.669355
##  [43] 0.661290 0.653226 0.645161 0.637097 0.629032 0.620968 0.612903
##  [50] 0.604839 0.596774 0.588710 0.580645 0.572581 0.564516 0.556452
##  [57] 0.548387 0.540323 0.532258 0.524194 0.516129 0.508065 0.500000
##  [64] 0.491935 0.483871 0.475806 0.467742 0.459677 0.451613 0.443548
##  [71] 0.435484 0.427419 0.419355 0.411290 0.403226 0.395161 0.387097
##  [78] 0.379032 0.370968 0.362903 0.354839 0.346774 0.338710 0.330645
##  [85] 0.322581 0.314516 0.306452 0.298387 0.290323 0.282258 0.274194
##  [92] 0.266129 0.258065 0.250000 0.241935 0.233871 0.225806 0.217742
##  [99] 0.209677 0.201613 0.193548 0.185484 0.177419 0.169355 0.161290
## [106] 0.153226 0.145161 0.137097 0.129032 0.120968 0.112903 0.104839
## [113] 0.096774 0.088710 0.080645 0.072581 0.064516 0.056452 0.048387
## [120] 0.040323 0.032258 0.024194 0.016129 0.008065 0.000000 0.000000
## 
## $AUC
## [1] 0.5762
\end{verbatim}
\begin{alltt}
\hlkwd{risksetROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= gg2.linpred.glasgow,} \hlkwc{predict.time} \hlstd{=} \hlnum{12}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-4} 

}


\begin{kframe}\begin{verbatim}
## $marker
##   [1] -0.450187 -0.365769 -0.343257 -0.343257 -0.343257 -0.337630 -0.337630
##   [8] -0.309490 -0.309490 -0.309490 -0.309490 -0.309490 -0.309490 -0.309490
##  [15] -0.292441 -0.281351 -0.281351 -0.270095 -0.253212 -0.253212 -0.253212
##  [22] -0.253212 -0.236163 -0.236163 -0.225072 -0.208024 -0.196768 -0.179884
##  [29] -0.179884 -0.179884 -0.179884 -0.174256 -0.168794 -0.151745 -0.151745
##  [36] -0.151745 -0.151745 -0.151745 -0.146117 -0.140489 -0.123606 -0.123606
##  [43] -0.123606 -0.084418 -0.084418 -0.073162 -0.067327 -0.067327 -0.056279
##  [50] -0.056279 -0.039188 -0.039188 -0.028139 -0.028139 -0.028139 -0.028139
##  [57] -0.022511 -0.011256  0.000000  0.000000  0.000000  0.000000  0.005628
##  [64]  0.018497  0.028139  0.028139  0.028139  0.028139  0.057892  0.074776
##  [71]  0.074776  0.085866  0.090211  0.090211  0.095839  0.101467  0.101467
##  [78]  0.101467  0.102915  0.102915  0.123813  0.123978  0.129606  0.129606
##  [85]  0.129606  0.129606  0.131055  0.131055  0.131055  0.131055  0.146490
##  [92]  0.157745  0.157745  0.157745  0.157745  0.157745  0.157745  0.157745
##  [99]  0.159194  0.185885  0.187333  0.214024  0.214024  0.214024  0.226521
## [106]  0.243405  0.270302  0.326581  0.327988  0.327988  0.350499  0.367217
## [113]  0.378638  0.384266  0.384266  0.384266  0.384266  0.401150  0.412406
## [120]  0.412406  0.440545  0.440545  0.440545  0.440545
## 
## $TP
##   [1] 1.00000 0.99504 0.98963 0.98411 0.97858 0.97306 0.96750 0.96194
##   [9] 0.95623 0.95051 0.94480 0.93908 0.93337 0.92765 0.92194 0.91612
##  [17] 0.91025 0.90437 0.89842 0.89238 0.88633 0.88029 0.87424 0.86809
##  [25] 0.86194 0.85572 0.84940 0.84300 0.83649 0.82999 0.82348 0.81698
##  [33] 0.81043 0.80385 0.79716 0.79047 0.78378 0.77709 0.77040 0.76367
##  [41] 0.75690 0.75002 0.74313 0.73625 0.72909 0.72194 0.71470 0.70742
##  [49] 0.70014 0.69277 0.68541 0.67792 0.67044 0.66286 0.65529 0.64772
##  [57] 0.64015 0.63253 0.62483 0.61704 0.60926 0.60147 0.59368 0.58585
##  [65] 0.57791 0.56990 0.56189 0.55388 0.54587 0.53762 0.52923 0.52083
##  [73] 0.51235 0.50382 0.49530 0.48673 0.47811 0.46949 0.46087 0.45224
##  [81] 0.44361 0.43479 0.42597 0.41711 0.40824 0.39938 0.39051 0.38163
##  [89] 0.37275 0.36388 0.35500 0.34598 0.33686 0.32774 0.31862 0.30950
##  [97] 0.30039 0.29127 0.28215 0.27302 0.26364 0.25424 0.24460 0.23495
## [105] 0.22530 0.21554 0.20560 0.19540 0.18460 0.17379 0.16298 0.15192
## [113] 0.14068 0.12930 0.11787 0.10643 0.09499 0.08356 0.07192 0.06016
## [121] 0.04840 0.03630 0.02420 0.01210 0.00000 0.00000
## 
## $FP
##   [1] 1.000000 0.991935 0.983871 0.975806 0.967742 0.959677 0.951613
##   [8] 0.943548 0.935484 0.927419 0.919355 0.911290 0.903226 0.895161
##  [15] 0.887097 0.879032 0.870968 0.862903 0.854839 0.846774 0.838710
##  [22] 0.830645 0.822581 0.814516 0.806452 0.798387 0.790323 0.782258
##  [29] 0.774194 0.766129 0.758065 0.750000 0.741935 0.733871 0.725806
##  [36] 0.717742 0.709677 0.701613 0.693548 0.685484 0.677419 0.669355
##  [43] 0.661290 0.653226 0.645161 0.637097 0.629032 0.620968 0.612903
##  [50] 0.604839 0.596774 0.588710 0.580645 0.572581 0.564516 0.556452
##  [57] 0.548387 0.540323 0.532258 0.524194 0.516129 0.508065 0.500000
##  [64] 0.491935 0.483871 0.475806 0.467742 0.459677 0.451613 0.443548
##  [71] 0.435484 0.427419 0.419355 0.411290 0.403226 0.395161 0.387097
##  [78] 0.379032 0.370968 0.362903 0.354839 0.346774 0.338710 0.330645
##  [85] 0.322581 0.314516 0.306452 0.298387 0.290323 0.282258 0.274194
##  [92] 0.266129 0.258065 0.250000 0.241935 0.233871 0.225806 0.217742
##  [99] 0.209677 0.201613 0.193548 0.185484 0.177419 0.169355 0.161290
## [106] 0.153226 0.145161 0.137097 0.129032 0.120968 0.112903 0.104839
## [113] 0.096774 0.088710 0.080645 0.072581 0.064516 0.056452 0.048387
## [120] 0.040323 0.032258 0.024194 0.016129 0.008065 0.000000 0.000000
## 
## $AUC
## [1] 0.5645
\end{verbatim}
\begin{alltt}
\hlkwd{risksetROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= cph.linpred.glasgow,} \hlkwc{predict.time} \hlstd{=} \hlnum{12}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-5} 

}


\begin{kframe}\begin{verbatim}
## $marker
##   [1] -0.34542 -0.20725 -0.20725 -0.17962 -0.13817 -0.13817 -0.13817
##   [8] -0.08290 -0.08290 -0.08290 -0.06908 -0.06908 -0.06908 -0.06908
##  [15] -0.06908 -0.06908 -0.05527 -0.02763  0.00000  0.00000  0.00000
##  [22]  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000
##  [29]  0.00000  0.01382  0.06908  0.06908  0.06908  0.06908  0.06908
##  [36]  0.06908  0.09672  0.13540  0.13817  0.13817  0.13817  0.13817
##  [43]  0.20725  0.27357  0.27357  0.30397  0.31502  0.31502  0.32883
##  [50]  0.34265  0.34265  0.34265  0.34265  0.34542  0.37028  0.39792
##  [57]  0.41173  0.41173  0.41173  0.41173  0.41173  0.41173  0.41173
##  [64]  0.41173  0.42555  0.45318  0.48082  0.48082  0.48082  0.48082
##  [71]  0.48082  0.48082  0.48082  0.48082  0.48082  0.48082  0.48082
##  [78]  0.48082  0.49463  0.50845  0.54990  0.54990  0.54990  0.54990
##  [85]  0.56413  0.60558  0.61898  0.61898  0.61898  0.68807  0.68807
##  [92]  0.75715  0.75715  0.75715  0.89532  0.90678  0.90678  0.90678
##  [99]  0.90955  0.96205  0.97863  1.00350  1.03113  1.04495  1.04495
## [106]  1.04495  1.04495  1.04495  1.04495  1.08640  1.11403  1.11403
## [113]  1.11403  1.11403  1.18311  1.18311  1.18311  1.18311  1.18311
## [120]  1.18311  1.18311  1.18311  1.25220  1.32128
## 
## $TP
##   [1] 1.00000 0.99669 0.99289 0.98908 0.98518 0.98110 0.97703 0.97295
##   [9] 0.96865 0.96434 0.96004 0.95567 0.95130 0.94694 0.94257 0.93821
##  [17] 0.93384 0.92942 0.92487 0.92019 0.91551 0.91083 0.90615 0.90148
##  [25] 0.89680 0.89212 0.88744 0.88277 0.87809 0.87341 0.86867 0.86365
##  [33] 0.85864 0.85363 0.84862 0.84361 0.83859 0.83344 0.82808 0.82271
##  [41] 0.81734 0.81197 0.80660 0.80085 0.79470 0.78855 0.78221 0.77580
##  [49] 0.76939 0.76289 0.75630 0.74971 0.74312 0.73653 0.72992 0.72315
##  [57] 0.71618 0.70912 0.70206 0.69500 0.68794 0.68088 0.67382 0.66676
##  [65] 0.65970 0.65254 0.64518 0.63761 0.63005 0.62248 0.61492 0.60735
##  [73] 0.59978 0.59222 0.58465 0.57709 0.56952 0.56195 0.55439 0.54672
##  [81] 0.53894 0.53083 0.52273 0.51462 0.50651 0.49829 0.48972 0.48103
##  [89] 0.47234 0.46366 0.45435 0.44504 0.43507 0.42509 0.41512 0.40367
##  [97] 0.39208 0.38050 0.36892 0.35730 0.34506 0.33261 0.31985 0.30673
## [105] 0.29343 0.28013 0.26683 0.25353 0.24023 0.22693 0.21307 0.19882
## [113] 0.18457 0.17031 0.15606 0.14079 0.12552 0.11025 0.09498 0.07971
## [121] 0.06444 0.04917 0.03390 0.01753 0.00000 0.00000
## 
## $FP
##   [1] 1.000000 0.991935 0.983871 0.975806 0.967742 0.959677 0.951613
##   [8] 0.943548 0.935484 0.927419 0.919355 0.911290 0.903226 0.895161
##  [15] 0.887097 0.879032 0.870968 0.862903 0.854839 0.846774 0.838710
##  [22] 0.830645 0.822581 0.814516 0.806452 0.798387 0.790323 0.782258
##  [29] 0.774194 0.766129 0.758065 0.750000 0.741935 0.733871 0.725806
##  [36] 0.717742 0.709677 0.701613 0.693548 0.685484 0.677419 0.669355
##  [43] 0.661290 0.653226 0.645161 0.637097 0.629032 0.620968 0.612903
##  [50] 0.604839 0.596774 0.588710 0.580645 0.572581 0.564516 0.556452
##  [57] 0.548387 0.540323 0.532258 0.524194 0.516129 0.508065 0.500000
##  [64] 0.491935 0.483871 0.475806 0.467742 0.459677 0.451613 0.443548
##  [71] 0.435484 0.427419 0.419355 0.411290 0.403226 0.395161 0.387097
##  [78] 0.379032 0.370968 0.362903 0.354839 0.346774 0.338710 0.330645
##  [85] 0.322581 0.314516 0.306452 0.298387 0.290323 0.282258 0.274194
##  [92] 0.266129 0.258065 0.250000 0.241935 0.233871 0.225806 0.217742
##  [99] 0.209677 0.201613 0.193548 0.185484 0.177419 0.169355 0.161290
## [106] 0.153226 0.145161 0.137097 0.129032 0.120968 0.112903 0.104839
## [113] 0.096774 0.088710 0.080645 0.072581 0.064516 0.056452 0.048387
## [120] 0.040323 0.032258 0.024194 0.016129 0.008065 0.000000 0.000000
## 
## $AUC
## [1] 0.6232
\end{verbatim}
\begin{alltt}
\hlkwd{risksetROC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= rsf.linpred.glasgow,} \hlkwc{predict.time} \hlstd{=} \hlnum{12}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-6} 

}


\begin{kframe}\begin{verbatim}
## $marker
##   [1] -2.213 -2.199 -2.180 -2.154 -2.098 -2.090 -2.081 -2.066 -2.023 -2.018
##  [11] -2.011 -2.008 -2.005 -1.995 -1.988 -1.942 -1.941 -1.937 -1.934 -1.933
##  [21] -1.933 -1.933 -1.933 -1.906 -1.888 -1.884 -1.870 -1.868 -1.864 -1.864
##  [31] -1.864 -1.864 -1.864 -1.864 -1.864 -1.862 -1.862 -1.862 -1.862 -1.839
##  [41] -1.836 -1.831 -1.830 -1.826 -1.753 -1.670 -1.666 -1.643 -1.629 -1.613
##  [51] -1.613 -1.613 -1.613 -1.605 -1.605 -1.603 -1.602 -1.599 -1.599 -1.597
##  [61] -1.597 -1.593 -1.592 -1.591 -1.590 -1.588 -1.571 -1.563 -1.560 -1.556
##  [71] -1.555 -1.551 -1.547 -1.546 -1.543 -1.541 -1.541 -1.537 -1.533 -1.532
##  [81] -1.499 -1.499 -1.499 -1.499 -1.499 -1.497 -1.497 -1.496 -1.495 -1.465
##  [91] -1.435 -1.418 -1.357 -1.342 -1.340 -1.340 -1.339 -1.338 -1.338 -1.338
## [101] -1.327 -1.310 -1.307 -1.264 -1.260 -1.259 -1.258 -1.243 -1.220 -1.177
## [111] -1.176 -1.176 -1.102 -1.100 -1.098 -1.097 -1.078 -1.078 -1.074 -1.071
## [121] -1.058 -1.056 -1.054 -1.023
## 
## $TP
##   [1] 1.00000 0.99580 0.99153 0.98719 0.98273 0.97802 0.97326 0.96847
##   [9] 0.96360 0.95851 0.95341 0.94826 0.94310 0.93793 0.93270 0.92743
##  [17] 0.92192 0.91640 0.91086 0.90531 0.89975 0.89419 0.88863 0.88307
##  [25] 0.87735 0.87154 0.86569 0.85977 0.85384 0.84788 0.84193 0.83597
##  [33] 0.83001 0.82405 0.81810 0.81214 0.80617 0.80020 0.79423 0.78826
##  [41] 0.78215 0.77602 0.76986 0.76370 0.75751 0.75085 0.74362 0.73635
##  [49] 0.72892 0.72138 0.71373 0.70607 0.69841 0.69075 0.68303 0.67531
##  [57] 0.66758 0.65983 0.65206 0.64430 0.63652 0.62874 0.62092 0.61310
##  [65] 0.60528 0.59744 0.58959 0.58160 0.57356 0.56548 0.55737 0.54926
##  [73] 0.54111 0.53293 0.52474 0.51653 0.50831 0.50008 0.49181 0.48352
##  [81] 0.47521 0.46663 0.45805 0.44946 0.44088 0.43229 0.42369 0.41509
##  [89] 0.40649 0.39787 0.38898 0.37983 0.37052 0.36063 0.35059 0.34053
##  [97] 0.33046 0.32039 0.31031 0.30023 0.29015 0.27995 0.26958 0.25918
## [105] 0.24832 0.23741 0.22650 0.21558 0.20449 0.19314 0.18130 0.16945
## [113] 0.15759 0.14482 0.13203 0.11921 0.10638 0.09330 0.08022 0.06708
## [121] 0.05392 0.04058 0.02722 0.01382 0.00000 0.00000
## 
## $FP
##   [1] 1.000000 0.991935 0.983871 0.975806 0.967742 0.959677 0.951613
##   [8] 0.943548 0.935484 0.927419 0.919355 0.911290 0.903226 0.895161
##  [15] 0.887097 0.879032 0.870968 0.862903 0.854839 0.846774 0.838710
##  [22] 0.830645 0.822581 0.814516 0.806452 0.798387 0.790323 0.782258
##  [29] 0.774194 0.766129 0.758065 0.750000 0.741935 0.733871 0.725806
##  [36] 0.717742 0.709677 0.701613 0.693548 0.685484 0.677419 0.669355
##  [43] 0.661290 0.653226 0.645161 0.637097 0.629032 0.620968 0.612903
##  [50] 0.604839 0.596774 0.588710 0.580645 0.572581 0.564516 0.556452
##  [57] 0.548387 0.540323 0.532258 0.524194 0.516129 0.508065 0.500000
##  [64] 0.491935 0.483871 0.475806 0.467742 0.459677 0.451613 0.443548
##  [71] 0.435484 0.427419 0.419355 0.411290 0.403226 0.395161 0.387097
##  [78] 0.379032 0.370968 0.362903 0.354839 0.346774 0.338710 0.330645
##  [85] 0.322581 0.314516 0.306452 0.298387 0.290323 0.282258 0.274194
##  [92] 0.266129 0.258065 0.250000 0.241935 0.233871 0.225806 0.217742
##  [99] 0.209677 0.201613 0.193548 0.185484 0.177419 0.169355 0.161290
## [106] 0.153226 0.145161 0.137097 0.129032 0.120968 0.112903 0.104839
## [113] 0.096774 0.088710 0.080645 0.072581 0.064516 0.056452 0.048387
## [120] 0.040323 0.032258 0.024194 0.016129 0.008065 0.000000 0.000000
## 
## $AUC
## [1] 0.586
\end{verbatim}
\begin{alltt}
\hlkwd{risksetAUC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= mskcc_pre.linpred.glasgow,} \hlkwc{tmax} \hlstd{=} \hlnum{36}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-7} 

}


\begin{kframe}\begin{verbatim}
## $utimes
##   [1]   0.80   1.63   2.50   3.00   3.40   3.73   3.83   3.90   4.47   4.57
##  [11]   4.67   4.73   4.83   4.87   5.00   5.30   5.77   5.83   5.87   6.00
##  [21]   6.10   6.27   6.30   6.67   6.93   7.00   7.10   7.66   7.67   7.73
##  [31]   8.00   8.17   8.33   8.43   8.47   8.77   8.80   9.00   9.03   9.30
##  [41]   9.40   9.83  10.13  10.27  10.40  10.50  11.07  11.30  11.33  11.50
##  [51]  11.60  11.90  12.33  12.47  12.97  13.00  13.03  13.10  13.30  13.43
##  [61]  13.50  13.57  13.70  13.93  14.00  14.80  15.37  15.40  15.57  16.00
##  [71]  16.17  16.33  16.47  16.77  16.95  17.00  17.07  17.57  17.83  18.03
##  [81]  18.17  18.40  18.50  18.57  18.93  19.10  19.50  19.63  19.80  20.00
##  [91]  20.07  20.43  20.67  20.90  21.53  21.80  22.00  22.60  23.07  23.10
## [101]  23.17  24.00  24.37  24.70  25.00  25.67  25.83  26.33  26.40  26.50
## [111]  26.60  26.70  27.53  28.13  28.33  28.53  29.03  29.10  29.27  29.60
## [121]  29.67  30.07  30.97  31.00  31.53  32.00  33.00  33.10  33.40  33.47
## [131]  34.37  35.10  35.97  36.23  36.30  36.67  37.00  38.00  39.60  41.23
## [141]  43.07  45.37  46.67  47.43  47.73  48.00  49.00  51.00  54.90  59.00
## [151]  63.13  65.00  67.00  70.00  77.00  85.00  85.80  90.33  93.00  94.77
## [161] 116.00
## 
## $St
##   [1] 0.99476 0.98930 0.98383 0.97834 0.97284 0.96734 0.96185 0.95086
##   [9] 0.93986 0.93437 0.92887 0.92337 0.91788 0.90689 0.89589 0.89040
##  [17] 0.88490 0.87940 0.87391 0.86841 0.86291 0.85742 0.85192 0.84643
##  [25] 0.84093 0.83543 0.82994 0.82444 0.81894 0.81345 0.80246 0.79696
##  [33] 0.79146 0.78597 0.78047 0.77497 0.76948 0.76398 0.75845 0.75291
##  [41] 0.74737 0.74184 0.73630 0.73077 0.72523 0.71969 0.71416 0.70862
##  [49] 0.70308 0.69755 0.69201 0.68648 0.68094 0.67540 0.66987 0.66433
##  [57] 0.65880 0.65326 0.64772 0.64219 0.63665 0.63112 0.62558 0.62004
##  [65] 0.61451 0.60892 0.60333 0.59775 0.59216 0.58658 0.58099 0.57540
##  [73] 0.56982 0.56423 0.55864 0.55306 0.54747 0.54188 0.53630 0.53071
##  [81] 0.52512 0.51954 0.51395 0.50837 0.50278 0.49719 0.49161 0.48602
##  [89] 0.48043 0.46926 0.46367 0.45809 0.45250 0.44691 0.44133 0.43574
##  [97] 0.43016 0.42457 0.41898 0.41340 0.40781 0.39664 0.39105 0.38546
## [105] 0.37429 0.36870 0.36312 0.35753 0.35195 0.34636 0.34077 0.33519
## [113] 0.32960 0.32401 0.31843 0.31284 0.30725 0.30167 0.29608 0.29049
## [121] 0.28491 0.27932 0.27374 0.26815 0.26256 0.25698 0.25139 0.24580
## [129] 0.24022 0.23463 0.22904 0.22332 0.21759 0.21187 0.20614 0.20041
## [137] 0.19469 0.18289 0.17679 0.17048 0.16416 0.15760 0.15103 0.14446
## [145] 0.13790 0.13133 0.12442 0.11751 0.10967 0.10184 0.09401 0.08617
## [153] 0.07834 0.07050 0.06169 0.05141 0.04113 0.03085 0.02056 0.01028
## [161] 0.00000
## 
## $AUC
##   [1] 0.4989 0.5018 0.5007 0.4988 0.4998 0.5010 0.4988 0.4968 0.4984 0.4989
##  [11] 0.5023 0.4989 0.5000 0.5035 0.4984 0.4978 0.5021 0.5003 0.4981 0.4998
##  [21] 0.5003 0.4976 0.5006 0.4977 0.5014 0.5022 0.4994 0.5014 0.5030 0.4995
##  [31] 0.5041 0.5014 0.5013 0.5028 0.5001 0.5008 0.4985 0.4997 0.5009 0.4975
##  [41] 0.4997 0.4981 0.5004 0.4986 0.5012 0.5020 0.4969 0.4983 0.4993 0.5005
##  [51] 0.4980 0.4970 0.5000 0.4969 0.5020 0.4979 0.5014 0.4972 0.5006 0.4986
##  [61] 0.4986 0.4990 0.5009 0.5036 0.5006 0.5039 0.4983 0.4976 0.4965 0.4982
##  [71] 0.5001 0.5017 0.5012 0.5039 0.4965 0.4993 0.4994 0.5034 0.4995 0.5002
##  [81] 0.5013 0.5050 0.5021 0.4999 0.4990 0.5013 0.4980 0.4956 0.4959 0.5007
##  [91] 0.4955 0.5002 0.4966 0.4984 0.5020 0.5026 0.4970 0.5066 0.4956 0.4959
## [101] 0.5044 0.5087 0.5064 0.4963 0.4999 0.5062 0.4963 0.4960 0.4972 0.4960
## [111] 0.5002 0.4997 0.5052 0.4962 0.5086 0.5018 0.4949 0.4941 0.4986 0.5034
## [121] 0.5034 0.5088 0.4983 0.4958 0.5012 0.5074 0.5017 0.4949 0.4933 0.5127
## [131] 0.4955 0.4911 0.4956 0.5107 0.5063 0.4927 0.4910 0.4962 0.4960 0.4900
## [141] 0.4942 0.4897 0.4932 0.5232 0.5198 0.4847 0.5216 0.4930 0.5204 0.4821
## [151] 0.4758 0.5357 0.4924 0.4517 0.4380 0.4171 0.4504 0.6255 0.5000 0.7500
## [161] 0.0000
## 
## $Cindex
## [1] 0.5
\end{verbatim}
\begin{alltt}
\hlkwd{risksetAUC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= mskcc_post.linpred.glasgow,} \hlkwc{tmax} \hlstd{=} \hlnum{36}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-8} 

}


\begin{kframe}\begin{verbatim}
## $utimes
##   [1]   0.80   1.63   2.50   3.00   3.40   3.73   3.83   3.90   4.47   4.57
##  [11]   4.67   4.73   4.83   4.87   5.00   5.30   5.77   5.83   5.87   6.00
##  [21]   6.10   6.27   6.30   6.67   6.93   7.00   7.10   7.66   7.67   7.73
##  [31]   8.00   8.17   8.33   8.43   8.47   8.77   8.80   9.00   9.03   9.30
##  [41]   9.40   9.83  10.13  10.27  10.40  10.50  11.07  11.30  11.33  11.50
##  [51]  11.60  11.90  12.33  12.47  12.97  13.00  13.03  13.10  13.30  13.43
##  [61]  13.50  13.57  13.70  13.93  14.00  14.80  15.37  15.40  15.57  16.00
##  [71]  16.17  16.33  16.47  16.77  16.95  17.00  17.07  17.57  17.83  18.03
##  [81]  18.17  18.40  18.50  18.57  18.93  19.10  19.50  19.63  19.80  20.00
##  [91]  20.07  20.43  20.67  20.90  21.53  21.80  22.00  22.60  23.07  23.10
## [101]  23.17  24.00  24.37  24.70  25.00  25.67  25.83  26.33  26.40  26.50
## [111]  26.60  26.70  27.53  28.13  28.33  28.53  29.03  29.10  29.27  29.60
## [121]  29.67  30.07  30.97  31.00  31.53  32.00  33.00  33.10  33.40  33.47
## [131]  34.37  35.10  35.97  36.23  36.30  36.67  37.00  38.00  39.60  41.23
## [141]  43.07  45.37  46.67  47.43  47.73  48.00  49.00  51.00  54.90  59.00
## [151]  63.13  65.00  67.00  70.00  77.00  85.00  85.80  90.33  93.00  94.77
## [161] 116.00
## 
## $St
##   [1] 0.99476 0.98930 0.98383 0.97834 0.97284 0.96734 0.96185 0.95086
##   [9] 0.93986 0.93437 0.92887 0.92337 0.91788 0.90689 0.89589 0.89040
##  [17] 0.88490 0.87940 0.87391 0.86841 0.86291 0.85742 0.85192 0.84643
##  [25] 0.84093 0.83543 0.82994 0.82444 0.81894 0.81345 0.80246 0.79696
##  [33] 0.79146 0.78597 0.78047 0.77497 0.76948 0.76398 0.75845 0.75291
##  [41] 0.74737 0.74184 0.73630 0.73077 0.72523 0.71969 0.71416 0.70862
##  [49] 0.70308 0.69755 0.69201 0.68648 0.68094 0.67540 0.66987 0.66433
##  [57] 0.65880 0.65326 0.64772 0.64219 0.63665 0.63112 0.62558 0.62004
##  [65] 0.61451 0.60892 0.60333 0.59775 0.59216 0.58658 0.58099 0.57540
##  [73] 0.56982 0.56423 0.55864 0.55306 0.54747 0.54188 0.53630 0.53071
##  [81] 0.52512 0.51954 0.51395 0.50837 0.50278 0.49719 0.49161 0.48602
##  [89] 0.48043 0.46926 0.46367 0.45809 0.45250 0.44691 0.44133 0.43574
##  [97] 0.43016 0.42457 0.41898 0.41340 0.40781 0.39664 0.39105 0.38546
## [105] 0.37429 0.36870 0.36312 0.35753 0.35195 0.34636 0.34077 0.33519
## [113] 0.32960 0.32401 0.31843 0.31284 0.30725 0.30167 0.29608 0.29049
## [121] 0.28491 0.27932 0.27374 0.26815 0.26256 0.25698 0.25139 0.24580
## [129] 0.24022 0.23463 0.22904 0.22332 0.21759 0.21187 0.20614 0.20041
## [137] 0.19469 0.18289 0.17679 0.17048 0.16416 0.15760 0.15103 0.14446
## [145] 0.13790 0.13133 0.12442 0.11751 0.10967 0.10184 0.09401 0.08617
## [153] 0.07834 0.07050 0.06169 0.05141 0.04113 0.03085 0.02056 0.01028
## [161] 0.00000
## 
## $AUC
##   [1] 0.5723 0.5744 0.5766 0.5742 0.5699 0.5704 0.5729 0.5707 0.5694 0.5733
##  [11] 0.5701 0.5733 0.5732 0.5744 0.5792 0.5744 0.5699 0.5743 0.5718 0.5682
##  [21] 0.5726 0.5689 0.5701 0.5723 0.5692 0.5729 0.5689 0.5730 0.5732 0.5717
##  [31] 0.5680 0.5713 0.5724 0.5706 0.5709 0.5707 0.5726 0.5726 0.5719 0.5719
##  [41] 0.5776 0.5747 0.5700 0.5706 0.5736 0.5747 0.5754 0.5739 0.5752 0.5716
##  [51] 0.5735 0.5767 0.5744 0.5721 0.5778 0.5758 0.5791 0.5773 0.5717 0.5771
##  [61] 0.5716 0.5725 0.5753 0.5743 0.5760 0.5752 0.5759 0.5777 0.5774 0.5792
##  [71] 0.5811 0.5742 0.5734 0.5804 0.5796 0.5738 0.5759 0.5763 0.5778 0.5798
##  [81] 0.5771 0.5750 0.5825 0.5758 0.5784 0.5838 0.5812 0.5826 0.5830 0.5847
##  [91] 0.5817 0.5823 0.5862 0.5847 0.5791 0.5751 0.5844 0.5786 0.5805 0.5848
## [101] 0.5798 0.5749 0.5867 0.5802 0.5853 0.5819 0.5897 0.5834 0.5842 0.5865
## [111] 0.5923 0.5794 0.5826 0.5847 0.5876 0.5876 0.5839 0.5905 0.5831 0.5889
## [121] 0.5892 0.5848 0.5874 0.5882 0.5957 0.5881 0.5946 0.5966 0.6026 0.5892
## [131] 0.5956 0.6062 0.5856 0.5876 0.5931 0.5861 0.6086 0.6097 0.5945 0.5881
## [141] 0.6132 0.5807 0.5967 0.5913 0.5844 0.6111 0.5856 0.6234 0.6160 0.6236
## [151] 0.6229 0.5656 0.6111 0.6573 0.5917 0.5836 0.5309 0.4725 0.7439 0.2936
## [161] 0.0000
## 
## $Cindex
## [1] 0.576
\end{verbatim}
\begin{alltt}
\hlkwd{risksetAUC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= gg.linpred.glasgow,} \hlkwc{tmax} \hlstd{=} \hlnum{36}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-9} 

}


\begin{kframe}\begin{verbatim}
## $utimes
##   [1]   0.80   1.63   2.50   3.00   3.40   3.73   3.83   3.90   4.47   4.57
##  [11]   4.67   4.73   4.83   4.87   5.00   5.30   5.77   5.83   5.87   6.00
##  [21]   6.10   6.27   6.30   6.67   6.93   7.00   7.10   7.66   7.67   7.73
##  [31]   8.00   8.17   8.33   8.43   8.47   8.77   8.80   9.00   9.03   9.30
##  [41]   9.40   9.83  10.13  10.27  10.40  10.50  11.07  11.30  11.33  11.50
##  [51]  11.60  11.90  12.33  12.47  12.97  13.00  13.03  13.10  13.30  13.43
##  [61]  13.50  13.57  13.70  13.93  14.00  14.80  15.37  15.40  15.57  16.00
##  [71]  16.17  16.33  16.47  16.77  16.95  17.00  17.07  17.57  17.83  18.03
##  [81]  18.17  18.40  18.50  18.57  18.93  19.10  19.50  19.63  19.80  20.00
##  [91]  20.07  20.43  20.67  20.90  21.53  21.80  22.00  22.60  23.07  23.10
## [101]  23.17  24.00  24.37  24.70  25.00  25.67  25.83  26.33  26.40  26.50
## [111]  26.60  26.70  27.53  28.13  28.33  28.53  29.03  29.10  29.27  29.60
## [121]  29.67  30.07  30.97  31.00  31.53  32.00  33.00  33.10  33.40  33.47
## [131]  34.37  35.10  35.97  36.23  36.30  36.67  37.00  38.00  39.60  41.23
## [141]  43.07  45.37  46.67  47.43  47.73  48.00  49.00  51.00  54.90  59.00
## [151]  63.13  65.00  67.00  70.00  77.00  85.00  85.80  90.33  93.00  94.77
## [161] 116.00
## 
## $St
##   [1] 0.99476 0.98930 0.98383 0.97834 0.97284 0.96734 0.96185 0.95086
##   [9] 0.93986 0.93437 0.92887 0.92337 0.91788 0.90689 0.89589 0.89040
##  [17] 0.88490 0.87940 0.87391 0.86841 0.86291 0.85742 0.85192 0.84643
##  [25] 0.84093 0.83543 0.82994 0.82444 0.81894 0.81345 0.80246 0.79696
##  [33] 0.79146 0.78597 0.78047 0.77497 0.76948 0.76398 0.75845 0.75291
##  [41] 0.74737 0.74184 0.73630 0.73077 0.72523 0.71969 0.71416 0.70862
##  [49] 0.70308 0.69755 0.69201 0.68648 0.68094 0.67540 0.66987 0.66433
##  [57] 0.65880 0.65326 0.64772 0.64219 0.63665 0.63112 0.62558 0.62004
##  [65] 0.61451 0.60892 0.60333 0.59775 0.59216 0.58658 0.58099 0.57540
##  [73] 0.56982 0.56423 0.55864 0.55306 0.54747 0.54188 0.53630 0.53071
##  [81] 0.52512 0.51954 0.51395 0.50837 0.50278 0.49719 0.49161 0.48602
##  [89] 0.48043 0.46926 0.46367 0.45809 0.45250 0.44691 0.44133 0.43574
##  [97] 0.43016 0.42457 0.41898 0.41340 0.40781 0.39664 0.39105 0.38546
## [105] 0.37429 0.36870 0.36312 0.35753 0.35195 0.34636 0.34077 0.33519
## [113] 0.32960 0.32401 0.31843 0.31284 0.30725 0.30167 0.29608 0.29049
## [121] 0.28491 0.27932 0.27374 0.26815 0.26256 0.25698 0.25139 0.24580
## [129] 0.24022 0.23463 0.22904 0.22332 0.21759 0.21187 0.20614 0.20041
## [137] 0.19469 0.18289 0.17679 0.17048 0.16416 0.15760 0.15103 0.14446
## [145] 0.13790 0.13133 0.12442 0.11751 0.10967 0.10184 0.09401 0.08617
## [153] 0.07834 0.07050 0.06169 0.05141 0.04113 0.03085 0.02056 0.01028
## [161] 0.00000
## 
## $AUC
##   [1] 0.5807 0.5826 0.5803 0.5803 0.5791 0.5797 0.5773 0.5785 0.5788 0.5788
##  [11] 0.5816 0.5807 0.5806 0.5822 0.5823 0.5769 0.5824 0.5764 0.5798 0.5784
##  [21] 0.5777 0.5771 0.5807 0.5770 0.5816 0.5819 0.5766 0.5821 0.5808 0.5787
##  [31] 0.5838 0.5782 0.5791 0.5795 0.5777 0.5754 0.5743 0.5740 0.5756 0.5757
##  [41] 0.5747 0.5733 0.5737 0.5756 0.5756 0.5762 0.5743 0.5795 0.5792 0.5793
##  [51] 0.5733 0.5759 0.5744 0.5742 0.5808 0.5740 0.5798 0.5767 0.5735 0.5799
##  [61] 0.5748 0.5760 0.5796 0.5755 0.5737 0.5786 0.5737 0.5726 0.5725 0.5754
##  [71] 0.5789 0.5765 0.5784 0.5787 0.5732 0.5775 0.5759 0.5805 0.5802 0.5805
##  [81] 0.5813 0.5784 0.5830 0.5793 0.5739 0.5839 0.5721 0.5765 0.5812 0.5737
##  [91] 0.5728 0.5824 0.5769 0.5723 0.5752 0.5792 0.5717 0.5815 0.5701 0.5709
## [101] 0.5778 0.5879 0.5769 0.5667 0.5814 0.5728 0.5664 0.5689 0.5672 0.5659
## [111] 0.5773 0.5725 0.5717 0.5653 0.5801 0.5788 0.5625 0.5665 0.5715 0.5642
## [121] 0.5689 0.5706 0.5733 0.5669 0.5778 0.5839 0.5751 0.5607 0.5604 0.5787
## [131] 0.5555 0.5641 0.5719 0.5614 0.5639 0.5589 0.5577 0.5726 0.5561 0.5706
## [141] 0.5517 0.5854 0.5587 0.5572 0.5532 0.5497 0.5889 0.5654 0.5585 0.5384
## [151] 0.5967 0.5881 0.5616 0.5224 0.4994 0.5021 0.4551 0.4934 0.7081 0.7596
## [161] 0.0000
## 
## $Cindex
## [1] 0.5773
\end{verbatim}
\begin{alltt}
\hlkwd{risksetAUC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= gg2.linpred.glasgow,} \hlkwc{tmax} \hlstd{=} \hlnum{36}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-10} 

}


\begin{kframe}\begin{verbatim}
## $utimes
##   [1]   0.80   1.63   2.50   3.00   3.40   3.73   3.83   3.90   4.47   4.57
##  [11]   4.67   4.73   4.83   4.87   5.00   5.30   5.77   5.83   5.87   6.00
##  [21]   6.10   6.27   6.30   6.67   6.93   7.00   7.10   7.66   7.67   7.73
##  [31]   8.00   8.17   8.33   8.43   8.47   8.77   8.80   9.00   9.03   9.30
##  [41]   9.40   9.83  10.13  10.27  10.40  10.50  11.07  11.30  11.33  11.50
##  [51]  11.60  11.90  12.33  12.47  12.97  13.00  13.03  13.10  13.30  13.43
##  [61]  13.50  13.57  13.70  13.93  14.00  14.80  15.37  15.40  15.57  16.00
##  [71]  16.17  16.33  16.47  16.77  16.95  17.00  17.07  17.57  17.83  18.03
##  [81]  18.17  18.40  18.50  18.57  18.93  19.10  19.50  19.63  19.80  20.00
##  [91]  20.07  20.43  20.67  20.90  21.53  21.80  22.00  22.60  23.07  23.10
## [101]  23.17  24.00  24.37  24.70  25.00  25.67  25.83  26.33  26.40  26.50
## [111]  26.60  26.70  27.53  28.13  28.33  28.53  29.03  29.10  29.27  29.60
## [121]  29.67  30.07  30.97  31.00  31.53  32.00  33.00  33.10  33.40  33.47
## [131]  34.37  35.10  35.97  36.23  36.30  36.67  37.00  38.00  39.60  41.23
## [141]  43.07  45.37  46.67  47.43  47.73  48.00  49.00  51.00  54.90  59.00
## [151]  63.13  65.00  67.00  70.00  77.00  85.00  85.80  90.33  93.00  94.77
## [161] 116.00
## 
## $St
##   [1] 0.99476 0.98930 0.98383 0.97834 0.97284 0.96734 0.96185 0.95086
##   [9] 0.93986 0.93437 0.92887 0.92337 0.91788 0.90689 0.89589 0.89040
##  [17] 0.88490 0.87940 0.87391 0.86841 0.86291 0.85742 0.85192 0.84643
##  [25] 0.84093 0.83543 0.82994 0.82444 0.81894 0.81345 0.80246 0.79696
##  [33] 0.79146 0.78597 0.78047 0.77497 0.76948 0.76398 0.75845 0.75291
##  [41] 0.74737 0.74184 0.73630 0.73077 0.72523 0.71969 0.71416 0.70862
##  [49] 0.70308 0.69755 0.69201 0.68648 0.68094 0.67540 0.66987 0.66433
##  [57] 0.65880 0.65326 0.64772 0.64219 0.63665 0.63112 0.62558 0.62004
##  [65] 0.61451 0.60892 0.60333 0.59775 0.59216 0.58658 0.58099 0.57540
##  [73] 0.56982 0.56423 0.55864 0.55306 0.54747 0.54188 0.53630 0.53071
##  [81] 0.52512 0.51954 0.51395 0.50837 0.50278 0.49719 0.49161 0.48602
##  [89] 0.48043 0.46926 0.46367 0.45809 0.45250 0.44691 0.44133 0.43574
##  [97] 0.43016 0.42457 0.41898 0.41340 0.40781 0.39664 0.39105 0.38546
## [105] 0.37429 0.36870 0.36312 0.35753 0.35195 0.34636 0.34077 0.33519
## [113] 0.32960 0.32401 0.31843 0.31284 0.30725 0.30167 0.29608 0.29049
## [121] 0.28491 0.27932 0.27374 0.26815 0.26256 0.25698 0.25139 0.24580
## [129] 0.24022 0.23463 0.22904 0.22332 0.21759 0.21187 0.20614 0.20041
## [137] 0.19469 0.18289 0.17679 0.17048 0.16416 0.15760 0.15103 0.14446
## [145] 0.13790 0.13133 0.12442 0.11751 0.10967 0.10184 0.09401 0.08617
## [153] 0.07834 0.07050 0.06169 0.05141 0.04113 0.03085 0.02056 0.01028
## [161] 0.00000
## 
## $AUC
##   [1] 0.5685 0.5702 0.5679 0.5680 0.5666 0.5671 0.5650 0.5661 0.5665 0.5667
##  [11] 0.5694 0.5685 0.5683 0.5704 0.5701 0.5648 0.5704 0.5646 0.5678 0.5664
##  [21] 0.5654 0.5657 0.5686 0.5651 0.5697 0.5700 0.5647 0.5701 0.5690 0.5668
##  [31] 0.5719 0.5667 0.5675 0.5679 0.5663 0.5644 0.5620 0.5620 0.5657 0.5638
##  [41] 0.5636 0.5618 0.5621 0.5632 0.5644 0.5637 0.5626 0.5676 0.5670 0.5676
##  [51] 0.5614 0.5634 0.5625 0.5632 0.5690 0.5621 0.5680 0.5645 0.5616 0.5681
##  [61] 0.5621 0.5637 0.5678 0.5640 0.5617 0.5667 0.5617 0.5605 0.5606 0.5639
##  [71] 0.5669 0.5648 0.5669 0.5672 0.5610 0.5650 0.5643 0.5684 0.5674 0.5677
##  [81] 0.5693 0.5674 0.5708 0.5676 0.5620 0.5720 0.5604 0.5647 0.5696 0.5626
##  [91] 0.5613 0.5709 0.5651 0.5608 0.5644 0.5686 0.5602 0.5699 0.5589 0.5594
## [101] 0.5669 0.5769 0.5643 0.5553 0.5693 0.5627 0.5552 0.5574 0.5566 0.5548
## [111] 0.5661 0.5583 0.5616 0.5544 0.5695 0.5685 0.5525 0.5540 0.5617 0.5558
## [121] 0.5595 0.5612 0.5634 0.5587 0.5674 0.5732 0.5654 0.5513 0.5513 0.5693
## [131] 0.5464 0.5519 0.5607 0.5520 0.5570 0.5516 0.5491 0.5668 0.5466 0.5533
## [141] 0.5429 0.5764 0.5440 0.5500 0.5459 0.5409 0.5783 0.5370 0.5470 0.5256
## [151] 0.5821 0.5759 0.5498 0.5086 0.4861 0.4878 0.4420 0.4879 0.7018 0.7584
## [161] 0.0000
## 
## $Cindex
## [1] 0.5656
\end{verbatim}
\begin{alltt}
\hlkwd{risksetAUC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= cph.linpred.glasgow,} \hlkwc{tmax} \hlstd{=} \hlnum{36}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-11} 

}


\begin{kframe}\begin{verbatim}
## $utimes
##   [1]   0.80   1.63   2.50   3.00   3.40   3.73   3.83   3.90   4.47   4.57
##  [11]   4.67   4.73   4.83   4.87   5.00   5.30   5.77   5.83   5.87   6.00
##  [21]   6.10   6.27   6.30   6.67   6.93   7.00   7.10   7.66   7.67   7.73
##  [31]   8.00   8.17   8.33   8.43   8.47   8.77   8.80   9.00   9.03   9.30
##  [41]   9.40   9.83  10.13  10.27  10.40  10.50  11.07  11.30  11.33  11.50
##  [51]  11.60  11.90  12.33  12.47  12.97  13.00  13.03  13.10  13.30  13.43
##  [61]  13.50  13.57  13.70  13.93  14.00  14.80  15.37  15.40  15.57  16.00
##  [71]  16.17  16.33  16.47  16.77  16.95  17.00  17.07  17.57  17.83  18.03
##  [81]  18.17  18.40  18.50  18.57  18.93  19.10  19.50  19.63  19.80  20.00
##  [91]  20.07  20.43  20.67  20.90  21.53  21.80  22.00  22.60  23.07  23.10
## [101]  23.17  24.00  24.37  24.70  25.00  25.67  25.83  26.33  26.40  26.50
## [111]  26.60  26.70  27.53  28.13  28.33  28.53  29.03  29.10  29.27  29.60
## [121]  29.67  30.07  30.97  31.00  31.53  32.00  33.00  33.10  33.40  33.47
## [131]  34.37  35.10  35.97  36.23  36.30  36.67  37.00  38.00  39.60  41.23
## [141]  43.07  45.37  46.67  47.43  47.73  48.00  49.00  51.00  54.90  59.00
## [151]  63.13  65.00  67.00  70.00  77.00  85.00  85.80  90.33  93.00  94.77
## [161] 116.00
## 
## $St
##   [1] 0.99476 0.98930 0.98383 0.97834 0.97284 0.96734 0.96185 0.95086
##   [9] 0.93986 0.93437 0.92887 0.92337 0.91788 0.90689 0.89589 0.89040
##  [17] 0.88490 0.87940 0.87391 0.86841 0.86291 0.85742 0.85192 0.84643
##  [25] 0.84093 0.83543 0.82994 0.82444 0.81894 0.81345 0.80246 0.79696
##  [33] 0.79146 0.78597 0.78047 0.77497 0.76948 0.76398 0.75845 0.75291
##  [41] 0.74737 0.74184 0.73630 0.73077 0.72523 0.71969 0.71416 0.70862
##  [49] 0.70308 0.69755 0.69201 0.68648 0.68094 0.67540 0.66987 0.66433
##  [57] 0.65880 0.65326 0.64772 0.64219 0.63665 0.63112 0.62558 0.62004
##  [65] 0.61451 0.60892 0.60333 0.59775 0.59216 0.58658 0.58099 0.57540
##  [73] 0.56982 0.56423 0.55864 0.55306 0.54747 0.54188 0.53630 0.53071
##  [81] 0.52512 0.51954 0.51395 0.50837 0.50278 0.49719 0.49161 0.48602
##  [89] 0.48043 0.46926 0.46367 0.45809 0.45250 0.44691 0.44133 0.43574
##  [97] 0.43016 0.42457 0.41898 0.41340 0.40781 0.39664 0.39105 0.38546
## [105] 0.37429 0.36870 0.36312 0.35753 0.35195 0.34636 0.34077 0.33519
## [113] 0.32960 0.32401 0.31843 0.31284 0.30725 0.30167 0.29608 0.29049
## [121] 0.28491 0.27932 0.27374 0.26815 0.26256 0.25698 0.25139 0.24580
## [129] 0.24022 0.23463 0.22904 0.22332 0.21759 0.21187 0.20614 0.20041
## [137] 0.19469 0.18289 0.17679 0.17048 0.16416 0.15760 0.15103 0.14446
## [145] 0.13790 0.13133 0.12442 0.11751 0.10967 0.10184 0.09401 0.08617
## [153] 0.07834 0.07050 0.06169 0.05141 0.04113 0.03085 0.02056 0.01028
## [161] 0.00000
## 
## $AUC
##   [1] 0.6364 0.6374 0.6358 0.6348 0.6322 0.6326 0.6292 0.6321 0.6324 0.6302
##  [11] 0.6310 0.6332 0.6319 0.6290 0.6321 0.6256 0.6308 0.6255 0.6304 0.6275
##  [21] 0.6268 0.6247 0.6302 0.6241 0.6276 0.6284 0.6250 0.6298 0.6277 0.6281
##  [31] 0.6294 0.6236 0.6255 0.6270 0.6241 0.6216 0.6233 0.6234 0.6225 0.6251
##  [41] 0.6210 0.6214 0.6223 0.6247 0.6219 0.6252 0.6228 0.6260 0.6294 0.6243
##  [51] 0.6206 0.6245 0.6229 0.6206 0.6270 0.6225 0.6258 0.6263 0.6214 0.6260
##  [61] 0.6237 0.6251 0.6249 0.6206 0.6230 0.6230 0.6221 0.6206 0.6213 0.6262
##  [71] 0.6245 0.6226 0.6246 0.6251 0.6226 0.6290 0.6219 0.6263 0.6305 0.6294
##  [81] 0.6247 0.6220 0.6274 0.6233 0.6213 0.6303 0.6198 0.6261 0.6261 0.6204
##  [91] 0.6230 0.6302 0.6277 0.6221 0.6192 0.6245 0.6210 0.6277 0.6202 0.6223
## [101] 0.6244 0.6355 0.6289 0.6152 0.6295 0.6147 0.6126 0.6194 0.6166 0.6150
## [111] 0.6283 0.6195 0.6110 0.6091 0.6231 0.6215 0.6095 0.6148 0.6108 0.6050
## [121] 0.6066 0.6078 0.6108 0.6056 0.6142 0.6253 0.6105 0.6061 0.6074 0.6204
## [131] 0.6008 0.6168 0.6239 0.6136 0.5999 0.6096 0.6064 0.6061 0.6068 0.6287
## [141] 0.6039 0.6359 0.6261 0.6045 0.6015 0.6116 0.6403 0.6405 0.6143 0.6478
## [151] 0.6759 0.6226 0.5906 0.5641 0.5829 0.5572 0.5140 0.5359 0.7544 0.7707
## [161] 0.0000
## 
## $Cindex
## [1] 0.6255
\end{verbatim}
\begin{alltt}
\hlkwd{risksetAUC}\hlstd{(data.glasgow}\hlopt{$}\hlstd{Time}\hlopt{/}\hlnum{365.25}\hlopt{*}\hlnum{12}\hlstd{,} \hlkwc{status} \hlstd{= data.glasgow}\hlopt{$}\hlstd{DSD,} \hlkwc{marker} \hlstd{= rsf.linpred.glasgow,} \hlkwc{tmax} \hlstd{=} \hlnum{36}\hlstd{)}
\end{alltt}
\end{kframe}

{\centering \includegraphics[width=\maxwidth]{figure/05-risksetROC-12} 

}


\begin{kframe}\begin{verbatim}
## $utimes
##   [1]   0.80   1.63   2.50   3.00   3.40   3.73   3.83   3.90   4.47   4.57
##  [11]   4.67   4.73   4.83   4.87   5.00   5.30   5.77   5.83   5.87   6.00
##  [21]   6.10   6.27   6.30   6.67   6.93   7.00   7.10   7.66   7.67   7.73
##  [31]   8.00   8.17   8.33   8.43   8.47   8.77   8.80   9.00   9.03   9.30
##  [41]   9.40   9.83  10.13  10.27  10.40  10.50  11.07  11.30  11.33  11.50
##  [51]  11.60  11.90  12.33  12.47  12.97  13.00  13.03  13.10  13.30  13.43
##  [61]  13.50  13.57  13.70  13.93  14.00  14.80  15.37  15.40  15.57  16.00
##  [71]  16.17  16.33  16.47  16.77  16.95  17.00  17.07  17.57  17.83  18.03
##  [81]  18.17  18.40  18.50  18.57  18.93  19.10  19.50  19.63  19.80  20.00
##  [91]  20.07  20.43  20.67  20.90  21.53  21.80  22.00  22.60  23.07  23.10
## [101]  23.17  24.00  24.37  24.70  25.00  25.67  25.83  26.33  26.40  26.50
## [111]  26.60  26.70  27.53  28.13  28.33  28.53  29.03  29.10  29.27  29.60
## [121]  29.67  30.07  30.97  31.00  31.53  32.00  33.00  33.10  33.40  33.47
## [131]  34.37  35.10  35.97  36.23  36.30  36.67  37.00  38.00  39.60  41.23
## [141]  43.07  45.37  46.67  47.43  47.73  48.00  49.00  51.00  54.90  59.00
## [151]  63.13  65.00  67.00  70.00  77.00  85.00  85.80  90.33  93.00  94.77
## [161] 116.00
## 
## $St
##   [1] 0.99476 0.98930 0.98383 0.97834 0.97284 0.96734 0.96185 0.95086
##   [9] 0.93986 0.93437 0.92887 0.92337 0.91788 0.90689 0.89589 0.89040
##  [17] 0.88490 0.87940 0.87391 0.86841 0.86291 0.85742 0.85192 0.84643
##  [25] 0.84093 0.83543 0.82994 0.82444 0.81894 0.81345 0.80246 0.79696
##  [33] 0.79146 0.78597 0.78047 0.77497 0.76948 0.76398 0.75845 0.75291
##  [41] 0.74737 0.74184 0.73630 0.73077 0.72523 0.71969 0.71416 0.70862
##  [49] 0.70308 0.69755 0.69201 0.68648 0.68094 0.67540 0.66987 0.66433
##  [57] 0.65880 0.65326 0.64772 0.64219 0.63665 0.63112 0.62558 0.62004
##  [65] 0.61451 0.60892 0.60333 0.59775 0.59216 0.58658 0.58099 0.57540
##  [73] 0.56982 0.56423 0.55864 0.55306 0.54747 0.54188 0.53630 0.53071
##  [81] 0.52512 0.51954 0.51395 0.50837 0.50278 0.49719 0.49161 0.48602
##  [89] 0.48043 0.46926 0.46367 0.45809 0.45250 0.44691 0.44133 0.43574
##  [97] 0.43016 0.42457 0.41898 0.41340 0.40781 0.39664 0.39105 0.38546
## [105] 0.37429 0.36870 0.36312 0.35753 0.35195 0.34636 0.34077 0.33519
## [113] 0.32960 0.32401 0.31843 0.31284 0.30725 0.30167 0.29608 0.29049
## [121] 0.28491 0.27932 0.27374 0.26815 0.26256 0.25698 0.25139 0.24580
## [129] 0.24022 0.23463 0.22904 0.22332 0.21759 0.21187 0.20614 0.20041
## [137] 0.19469 0.18289 0.17679 0.17048 0.16416 0.15760 0.15103 0.14446
## [145] 0.13790 0.13133 0.12442 0.11751 0.10967 0.10184 0.09401 0.08617
## [153] 0.07834 0.07050 0.06169 0.05141 0.04113 0.03085 0.02056 0.01028
## [161] 0.00000
## 
## $AUC
##   [1] 0.5888 0.5910 0.5905 0.5903 0.5902 0.5906 0.5889 0.5892 0.5892 0.5903
##  [11] 0.5922 0.5908 0.5910 0.5933 0.5908 0.5880 0.5919 0.5867 0.5903 0.5880
##  [21] 0.5882 0.5867 0.5908 0.5874 0.5925 0.5911 0.5869 0.5907 0.5906 0.5898
##  [31] 0.5940 0.5868 0.5902 0.5885 0.5889 0.5848 0.5839 0.5839 0.5819 0.5862
##  [41] 0.5826 0.5822 0.5842 0.5838 0.5819 0.5852 0.5838 0.5859 0.5885 0.5858
##  [51] 0.5834 0.5847 0.5857 0.5830 0.5893 0.5839 0.5901 0.5865 0.5842 0.5890
##  [61] 0.5831 0.5869 0.5895 0.5836 0.5833 0.5860 0.5836 0.5818 0.5823 0.5845
##  [71] 0.5848 0.5858 0.5874 0.5876 0.5845 0.5892 0.5828 0.5884 0.5900 0.5902
##  [81] 0.5884 0.5823 0.5918 0.5857 0.5813 0.5903 0.5811 0.5871 0.5895 0.5812
##  [91] 0.5828 0.5893 0.5870 0.5825 0.5814 0.5876 0.5808 0.5907 0.5792 0.5826
## [101] 0.5857 0.5947 0.5875 0.5778 0.5910 0.5795 0.5779 0.5814 0.5785 0.5787
## [111] 0.5891 0.5841 0.5775 0.5773 0.5921 0.5893 0.5777 0.5762 0.5809 0.5708
## [121] 0.5718 0.5695 0.5784 0.5694 0.5823 0.5887 0.5824 0.5698 0.5700 0.5865
## [131] 0.5662 0.5744 0.5864 0.5752 0.5689 0.5701 0.5698 0.5768 0.5696 0.5791
## [141] 0.5669 0.6008 0.5801 0.5720 0.5605 0.5714 0.5994 0.5872 0.5707 0.5831
## [151] 0.6195 0.6060 0.5646 0.5421 0.5649 0.5109 0.4808 0.5086 0.7247 0.7581
## [161] 0.0000
## 
## $Cindex
## [1] 0.5867
\end{verbatim}
\end{kframe}
\end{knitrout}

\end{document}
